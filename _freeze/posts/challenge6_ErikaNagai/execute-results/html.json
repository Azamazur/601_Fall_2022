{
  "hash": "95bee703783a7e2ea8004ceb2465dd56",
  "result": {
    "markdown": "---\ntitle: \"Challenge 6 Instructions\"\nauthor: \"Erika Nggai\"\ndescription: \"Visualizing Time and Relationships\"\ndate: \"10/23/2022\"\nformat:\n  html:\n    toc: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_6\n  - bechdel_test\n  - movies\n  - Female_Representation\n  - Erika_Nagai\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(rjson)\nlibrary(jsonlite)\nlibrary(summarytools)\nlibrary(ggridges)\nlibrary(grid)\n\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Challenge Overview\n\nToday's challenge is to:\n\n1)  read in a data set, and describe the data set using both words and any supporting information (e.g., tables, etc)\n2)  tidy data (as needed, including sanity checks)\n3)  mutate variables as needed (including sanity checks)\n4)  create at least one graph including time (evolution)\n   - try to make them \"publication\" ready (optional)\n   - Explain why you choose the specific graph type\n5)  Create at least one graph depicting part-whole or flow relationships\n   - try to make them \"publication\" ready (optional)\n   - Explain why you choose the specific graph type\n\n\n\nThis week, I chosed to analyze data about female representation in movies, specifically focusing on Bechdel test.\nAccording to \"Merriam-Webster\", Bechdel test is \"a set of criteria used as a test to evaluate a work of fiction (such as a film) on the basis of its inclusion and representation of female characters\" (<https://www.merriam-webster.com/dictionary/Bechdel%20Test>)\n\n\nIt usually includes \n1)  At least two women are featured\n2)  These women talk to each other\n3)  They discuss something other than a man\n\nI used two datasets.\n\n1)  `imdb_df`: The reviews information taken from IMDb (Internet Movie Database) <https://www.imdb.com/interfaces/>\n2)  `bechdel_df`: <https://bechdeltest.com/api/v1/doc>\n\n\n### Read in data\n\n**`bechdel_df`**\n\nThis data is extracted from `bechdeltest` API, so I used `jsonlite`'s `read_json` function.\nThe values in `imdbid` are missing \"tt\" in the beginning and don't match with the original imdb id so I made a new column `new_imdbid`that concatnate \"tt\" and the value of `imdbid`\n\n\n::: {.cell}\n\n```{.r .cell-code}\njson_file <- \"http://bechdeltest.com/api/v1/getAllMovies\"\nbechdel_df <- read_json(path = json_file, simplifyVector = TRUE)\nbechdel_df$titleId <- paste(\"tt\",bechdel_df$imdbid, sep = \"\")\n\nhead(bechdel_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  rating   imdbid                      title    id year    titleId\n1      3  1794796  inazuma eleven: the movie 10556 1010  tt1794796\n2      0  3155794           Passage de Venus  9602 1874  tt3155794\n3      0 14495706          La Rosace Magique  9804 1877 tt14495706\n4      0  2221420 Sallie Gardner at a Gallop  9603 1878  tt2221420\n5      0 12592084          Le singe musicien  9806 1878 tt12592084\n6      0  7816420    Athlete Swinging a Pick  9816 1881  tt7816420\n```\n:::\n:::\n\n\n**`imdb_rating`**\n\nI downloaded the tsv file compressed in a gz file from this website. <https://www.imdb.com/interfaces/>\nFirst, I decompressed the gz file by `R.usills::gunzip` function, and then read in the tsv file.\n\nI do NOT read in the original tsv file in this R Quarto because it is huge and it may cause issues.\nHowever, if you want to see what I did to read in the tsv file, you can refer to the below coding.\n\n::: {.cell}\n\n```{.r .cell-code}\n#R.utils::gunzip(\"_data/title.ratings.tsv.gz\")\n#imdb_rating <- read.delim(file = \"_data/title.ratings.tsv\", sep = \"\\t\")\n\n#colnames(imdb_rating)[1] <- \"titleId\"\n```\n:::\n\n\nThen I joined `bechdel_df` and `imdb_rating` using `titleId` and named the new dataset as `bechdel_imdb`\nAgain, you can see the below code to see how I joined two datasets.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#bechdel_imdb <- left_join(bechdel_df, imdb_df, by=\"titleId\" )\n#bechdel_imdb <- left_join(bechdel_df, imdb_rating, by=\"titleId\")\n\n#bechdel_imdb\n\n#write.csv(bechdel_imdb, \"~/DACSS/601/601_Fall_2022/posts/_data/bechdel_imdb.csv\",row.names = FALSE)\n\nbechdel_imdb <- read_csv(\"~/DACSS/601/601_Fall_2022/posts/_data/bechdel_imdb.csv\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError: '~/DACSS/601/601_Fall_2022/posts/_data/bechdel_imdb.csv' does not exist.\n```\n:::\n\n```{.r .cell-code}\nbechdel_imdb\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'bechdel_imdb' not found\n```\n:::\n:::\n\n\n### Describe the dataset\n\nAs mentioned, `bechdel_imdb` dataset is made of two different data, (1) Reviews on movies from IMDb (2) Rating of Bechdel test of movies.\nThis data set contains 9630 rows (each represents a movie) and 8 columns.\nColumns contain the following information: \n* year: a year when movie was released\n* id: Bechdeltest.com unique id\n* rating: Bechdel test rating (0 means no two women, 1 = no talking between women, 2 = talking about a man, 3 means it passes the test)\n* title: Title of movies\n* imdbid: IMDb unique id \n* titleId: IMDb unique id with \"tt\" in the beginning (this column was added to join two datasets)\n* average rating: weighted average of all the individual user ratings from IMDb\n* numVotes: number of votes the title has received\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(summarytools::dfSummary(bechdel_imdb),\n      varnumbers = FALSE,\n      plain.ascii  = FALSE,\n      style        = \"grid\",\n      graph.magnif = 0.80,\n      valid.col    = FALSE,\n      method = 'render',\n      table.classes = 'table-condensed')\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summarytools::dfSummary(bechdel_imdb): object 'bechdel_imdb' not found\n```\n:::\n:::\n\n\n## Tidy data\n\nFirst of all, this dataset has unnecessary columns so I removed them.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbechdel_imdb <- bechdel_imdb %>% select(-c(id, imdbid))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., -c(id, imdbid)): object 'bechdel_imdb' not found\n```\n:::\n\n```{.r .cell-code}\ncolnames(bechdel_imdb)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(x): object 'bechdel_imdb' not found\n```\n:::\n:::\n\n\nAlso I changed the name of columns to make them easier to understand\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(bechdel_imdb) <- c(\"bechdel_rating\", \"title\", \"year\", \"titleId\", \"review_rating\", \"numberVote\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in colnames(bechdel_imdb) <- c(\"bechdel_rating\", \"title\", \"year\", : object 'bechdel_imdb' not found\n```\n:::\n\n```{.r .cell-code}\nbechdel_imdb\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'bechdel_imdb' not found\n```\n:::\n:::\n\n\nAfter cleaning the data, the data contains the following information:\n *  year: a year when movie was released\n *  id: Bechdeltest.com unique id\n *  rating: Bechdel test rating (0 means no two women, 1 = no talking between women, 2 = talking about a man, 3 means it passes the test)\n *  title: Title of movies\n *  imdbid: IMDb unique id \n *  titleId: IMDb unique id with \"tt\" in the beginning (this column was added to join two datasets)Ha\n *  average rating: weighted average of all the individual user ratings from IMDb\n *  numVotes: number of votes the title has received\n\n\n## Visualization \n\nBefore analyzing the data, please note that not all movies have the Bechdel test available on http://bechdeltest.com.\nI'm able to analyze only the movies that have the Bechdel test rating available and the number of these movies is as follows.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvis <- bechdel_imdb %>%\n  group_by(year) %>%\n  summarize(\n    Total_number_of_movie = n()\n  )\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in group_by(., year): object 'bechdel_imdb' not found\n```\n:::\n\n```{.r .cell-code}\nggplot(vis, aes(x=year, y=Total_number_of_movie)) + \n  geom_line() +\n  labs(title = \"The number of movies that have Bechdel test rating available\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(vis, aes(x = year, y = Total_number_of_movie)): object 'vis' not found\n```\n:::\n:::\n\n\n\n**1: Has female representation in movies improved over time?** \n\nIt seems like the number of movies that pass the Bechdel test is increasing however we cannot see if it's true because the total number of movies is also increasing.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvis1 <- bechdel_imdb %>% group_by(year, bechdel_rating) %>%\n  summarize(count = n())\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in group_by(., year, bechdel_rating): object 'bechdel_imdb' not found\n```\n:::\n\n```{.r .cell-code}\nvis1$bechdel_rating <-as.factor(vis1$bechdel_rating)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.factor(x): object 'vis1' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(vis1, aes(x = year, y = count, fill = bechdel_rating))+\n  geom_area()+\n  labs(title=\"Number of movies by Bechdel test rating\", y = \"Number of movies\", x = \"Year\") +\n  scale_fill_discrete(name = \"Bechdel Test Rating\", labels = c(\"0: No two women\", \"1: No women talking each other\", \"2: Talking about a man\", \"3: Passes the test\"))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(vis1, aes(x = year, y = count, fill = bechdel_rating)): object 'vis1' not found\n```\n:::\n:::\n\n\nI created the graph of proportion of Bechdel Rating instead of number.\nThis graph shows that the % of movies that pass the Bechdel test is constantly increasing since around 1970.\nCurrently, over 70% of the released movies passes the Bechdel test.\nEven though most movies feature more than one female, however around 25% of movies still do NOT show two females talking each other.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(vis1, aes(x = year, y = count, fill = bechdel_rating))+\n  geom_area(position = \"fill\")+\n  labs(title=\"% of movies by Bechdel test rating\", y = \"Number of movies\", x = \"Year\") +\n  scale_y_continuous(labels = scales::percent)+\n  scale_fill_discrete(name = \"Bechdel Test Rating\", labels = c(\"0: No two women\", \"1: No women talking each other\", \"2: Talking about a man\", \"3: Passes the test\")) +\n  annotate(\"segment\", x =1970, xend = 2000, y = 0.35, yend = 0.50, colour = \"black\", arrow = arrow())\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(vis1, aes(x = year, y = count, fill = bechdel_rating)): object 'vis1' not found\n```\n:::\n:::\n\nSince there is only a small number of rated movies before 1950, the percentage graph does not appear smooth.\nI decided to focus on the movies released in 1950 or after.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(vis1 %>% filter(year >= 1950), aes(x = year, y = count, fill = bechdel_rating))+\n  geom_area(position = \"fill\")+\n  labs(title=\"% of movies by Bechdel test rating\", y = \"Number of movies\", x = \"Year\") +\n  scale_y_continuous(labels = scales::percent)+\n  scale_fill_discrete(name = \"Bechdel Test Rating\", labels = c(\"0: No two women\", \"1: No women talking each other\", \"2: Talking about a man\", \"3: Passes the test\"))+\n  annotate(\"segment\", x =1970, xend = 2000, y = 0.35, yend = 0.50, colour = \"black\", arrow = arrow())\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in filter(., year >= 1950): object 'vis1' not found\n```\n:::\n:::\n\n\n\n**2: Are movies in which women are represented more popular?**\n\nIf people value female representation in movies, the movies that have a better rating of Bechdel test will score higher on the reviews.\nHowever, the below graph doesn't show such trend clearly.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(bechdel_imdb %>% filter(year >= 1950), aes(x=year, y=review_rating)) + \n  geom_point(aes(colour=factor(bechdel_rating))) +\n  xlab(\"Year\") +\n  ylab(\"IBDm Review Score\") +\n  scale_color_discrete(name = \"Bechdel Test Rating\", labels = c(\"0: No two women\", \"1: No women talking each other\", \"2: Talking about a man\", \"3: Passes the test\"))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in filter(., year >= 1950): object 'bechdel_imdb' not found\n```\n:::\n:::\n\nI created a facet graph to see the trend more clearly, however, it seems that the rating of Bechdel test doesn't affect the review rating.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(bechdel_imdb %>% filter(year >= 1950), aes(x=year, y=review_rating)) + \n  geom_point() +\n  xlab(\"Year\") +\n  labs(title = \"IMDb review rating by bechdel test rating\")+\n  ylab(\"IBDm Review Score\") +\n  scale_color_discrete(name = \"Bechdel Test Rating\", labels = c(\"0: No two women\", \"1: No women talking each other\", \"2: Talking about a man\", \"3: Passes the test\")) +\n  \n  \n  facet_wrap(vars(factor(bechdel_rating)))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in filter(., year >= 1950): object 'bechdel_imdb' not found\n```\n:::\n:::\n\n# Violin plot or line of average \n\n\nFor further study, I would like to find out:\n1)  The trend of the number of proportion of the movies that pass Bechdel Test in different regions (Europe, Asia, Middle East, etc)\n2)  Whether or not a movie passes the Bechdel Test affects the movie's success (audience and expert reviews, revenue)?\n",
    "supporting": [
      "challenge6_ErikaNagai_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}