{
  "hash": "5a10fa499ff34eba0564d708bd093a10",
  "result": {
    "markdown": "---\ntitle: \"Global Military Spending - An Analysis\"\ndescription: \"WIP Final Project\"\nauthor: \"Julian Castoro\"\ndate: \"2022-12-10\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\neditor: \n  markdown: \n    wrap: 72\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n#output: distill::distill_article\n#| label: setup\n#| warning: false\n#| message: false\n\nlibrary(tidyverse)\nlibrary(lubridate)\n\nlibrary(ggplot2)\nlibrary(gganimate)\n\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(purrr)\nlibrary(lubridate)\n\nlibrary(leaflet)\n\n\noptions(digits = 3,decimals=2)\noptions(scipen = 999)\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n# Introduction\n\n\n![Global Government spending(current USD), Size correlates with Share of GDP](GovSpend_VS_RawUSD.gif)\n\n## Data choice overview\n\nI initially chose this data set because recent events abroad have\ncertainly escalated a global fear of war and I wanted to see how the\ntides of military spending ebbed and flowed over the course of recent\nhistory. The more I cleaned the data and played around with\nvisualizations, the more questions I had. I am excited to see what sort\nof trends come from analyzing this data set.\n\nI plan to show how different countries and regions value military\nspending and how that value changes over the course of time. Ideally I\nwill be able to explain patterns in what I see with global or locally\nimportant historic events. How did the US spending change after 9/11 or\nmore recently did we see anyone bolstering their defenses before news\nbroke of the Russian invasion of Ukraine? How did spending change\nglobally after the first and then second world war? While I am not a\nstatistical expert and will not be able to refute a causation vs\ncorrelation argument, visualizations of these events and the\ncorresponding spending patterns will still be interesting and hopefully\nprovoking of conversation.\n\n## Data\n\n### Description\n\nBelow is a list of the available sheets in the SIPRI military spending\ndata export. A few of the tabs are the same base information altered to\nreflect a specific currency or ratio. I am choosing to use the \"Current\nUSD\" as my source of raw spending numbers as I believe it to be the\neasiest to understand and relate to. I will also be using \"share of GDP\"\nas well as \"Share of Govt. spending\" to provide context around a nations\nspending compared to their population they intend on defending as well\nas compared to overall spending.\n\n\"Gross domestic product (GDP) is the total monetary or market value of\nall the finished goods and services produced within a country's borders\nin a specific time period.\" - Investopedia\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsheets <- excel_sheets(\"_data/SIPRI-Milex-data-1949-2021.xlsx\")\nsheets\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Front page\"                     \"Regional totals\"               \n [3] \"Local currency financial years\" \"Local currency calendar years\" \n [5] \"Constant (2020) USD\"            \"Current USD\"                   \n [7] \"Share of GDP\"                   \"Per capita\"                    \n [9] \"Share of Govt. spending\"        \"Footnotes\"                     \n```\n:::\n:::\n\n\n### Source\n\nThe Military spending information I am analyzing comes from **SIPRI**,\nthe **S**tockholm **I**nternational **P**eace **R**esearch\n**I**nstitute. SIPRI was established in 1966 for the purpose of\n\"research into conflict, armaments, arms control and disarmament\". The\norganization is funded by the Swedish government however it regularly\nworks internationally with research centers around the globe. SIPRI\ncollected this particular data set from the official reports of each of\nthe included governments in the form of official publications such as\npublic budgets.\n\nHere is a peek at what the raw information looks like.\n\n\n::: {.cell R.options='0'}\n\n```{.r .cell-code}\nrawrawData_ShareOfGovSpend <- read_excel(\"_data/SIPRI-Milex-data-1949-2021.xlsx\",sheet=sheets[9])\n#knitr::kable(head(rawrawData_ShareOfGovSpend,10),\"simple\")\nhead(rawrawData_ShareOfGovSpend,10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 37\n   Military …¹ ...2  ...3  ...4  ...5  ...6  ...7  ...8  ...9  ...10 ...11 ...12\n   <chr>       <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr>\n 1 \"Countries… <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 2 \"Figures a… <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 3 \"Data for … <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 4 \"Figures i… <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 5 \"\\\". .\\\" =… <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 6  <NA>       <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 7 \"Country\"   Notes Repo… 1988  1989  1990  1991  1992  1993  1994  1995  1996 \n 8  <NA>       <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n 9 \"Africa\"    <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n10 \"North Afr… <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n# … with 25 more variables: ...13 <chr>, ...14 <chr>, ...15 <chr>, ...16 <chr>,\n#   ...17 <chr>, ...18 <chr>, ...19 <chr>, ...20 <chr>, ...21 <chr>,\n#   ...22 <chr>, ...23 <chr>, ...24 <chr>, ...25 <chr>, ...26 <chr>,\n#   ...27 <chr>, ...28 <chr>, ...29 <chr>, ...30 <chr>, ...31 <chr>,\n#   ...32 <chr>, ...33 <chr>, ...34 <chr>, ...35 <chr>, ...36 <chr>,\n#   ...37 <chr>, and abbreviated variable name\n#   ¹​`Military expenditure by country as percentage of government spending, 1949-2021         © SIPRI 2021`\n```\n:::\n:::\n\n\n# Input and Cleaning\n\n## Reading in raw information\n\nThe data provided by the Stockholm International Peace Research\nInstitute(SIPRI) was separated into multiple tabs in one excel .xlsx\nfile.\n\nIn order to begin working I imported the tabs I planned to utilize,\nskipping over some of the notes and title rows at the start of each tab.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrawData_CurrentUSD <- read_excel(\"_data/SIPRI-Milex-data-1949-2021.xlsx\",sheet=sheets[6],skip=5)\nrawData_ShareOfGDP <- read_excel(\"_data/SIPRI-Milex-data-1949-2021.xlsx\",sheet=sheets[7],skip=5)\nrawData_ShareOfGovSpend <- read_excel(\"_data/SIPRI-Milex-data-1949-2021.xlsx\",sheet=sheets[9],skip=7)\n```\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 75\n  Country   Notes `1949` `1950` `1951` `1952` `1953` `1954` `1955` `1956` `1957`\n  <chr>     <chr> <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 <NA>      <NA>  <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n2 Africa    <NA>  <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n3 North Af… <NA>  <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n4 Algeria   §4    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n5 Libya     ‡§¶16 xxx    xxx    ...    ...    ...    ...    ...    ...    ...   \n6 Morocco   §17   xxx    xxx    xxx    xxx    xxx    xxx    xxx    23.71… 35.40…\n# … with 64 more variables: `1958` <chr>, `1959` <chr>, `1960` <chr>,\n#   `1961` <chr>, `1962` <chr>, `1963` <chr>, `1964` <chr>, `1965` <chr>,\n#   `1966` <chr>, `1967` <chr>, `1968` <chr>, `1969` <chr>, `1970` <chr>,\n#   `1971` <chr>, `1972` <chr>, `1973` <chr>, `1974` <chr>, `1975` <chr>,\n#   `1976` <chr>, `1977` <chr>, `1978` <chr>, `1979` <chr>, `1980` <chr>,\n#   `1981` <chr>, `1982` <chr>, `1983` <chr>, `1984` <chr>, `1985` <chr>,\n#   `1986` <chr>, `1987` <chr>, `1988` <chr>, `1989` <chr>, `1990` <chr>, …\n```\n:::\n:::\n\n\nNext I delete the first row of NA as well as the Notes column for each\ntibble.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrawData_CurrentUSD <- rawData_CurrentUSD[-1,]  %>%\n  select(-Notes)\nrawData_ShareOfGDP <- rawData_ShareOfGDP[-1,] %>%\n  select(-Notes)\nrawData_ShareOfGovSpend <- rawData_ShareOfGovSpend[-1,] %>%\n  select(-2:-3)\n```\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 74\n  Country  `1949` `1950` `1951` `1952` `1953` `1954` `1955` `1956` `1957` `1958`\n  <chr>    <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 Africa   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n2 North A… <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n3 Algeria  xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n4 Libya    xxx    xxx    ...    ...    ...    ...    ...    ...    ...    ...   \n5 Morocco  xxx    xxx    xxx    xxx    xxx    xxx    xxx    23.71… 35.40… 41.69…\n6 Tunisia  xxx    xxx    xxx    xxx    xxx    xxx    xxx    3.714… 6.411… 9.523…\n# … with 63 more variables: `1959` <chr>, `1960` <chr>, `1961` <chr>,\n#   `1962` <chr>, `1963` <chr>, `1964` <chr>, `1965` <chr>, `1966` <chr>,\n#   `1967` <chr>, `1968` <chr>, `1969` <chr>, `1970` <chr>, `1971` <chr>,\n#   `1972` <chr>, `1973` <chr>, `1974` <chr>, `1975` <chr>, `1976` <chr>,\n#   `1977` <chr>, `1978` <chr>, `1979` <chr>, `1980` <chr>, `1981` <chr>,\n#   `1982` <chr>, `1983` <chr>, `1984` <chr>, `1985` <chr>, `1986` <chr>,\n#   `1987` <chr>, `1988` <chr>, `1989` <chr>, `1990` <chr>, `1991` <chr>, …\n```\n:::\n:::\n\n\n## Tidying Data\n\nBefore pivoting my data I wanted to add a column for region. I chose to\ndo this with an algorithm as an exercise in iteration however it would\nhave been more practical to just hard code this column.\n\nThe list of countries where there are NA's for every year:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nRegions <- rawData_CurrentUSD %>%\n  filter(is.na(`1949`))%>%\n  select(Country)\n\nRegions\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 18 × 1\n   Country                          \n   <chr>                            \n 1 Africa                           \n 2 North Africa                     \n 3 sub-Saharan Africa               \n 4 Americas                         \n 5 Central America and the Caribbean\n 6 North America                    \n 7 South America                    \n 8 Asia & Oceania                   \n 9 Oceania                          \n10 South Asia                       \n11 East Asia                        \n12 South East Asia                  \n13 Central Asia                     \n14 Europe                           \n15 Central Europe                   \n16 Eastern Europe                   \n17 Western Europe                   \n18 Middle East                      \n```\n:::\n:::\n\n\nYou will notice that some of these are continents and sub-continents, I\nwanted to break these into a `Region` field. The pattern I saw and chose\nto exploit was the fact that the overarching category would always be\nfollowed with a more specific category such as the **Africa** followed\nby **North Africa** values (see earlier print outs to see raw\ninformation).\n\nI then added an empty vector into the tibble and populated it according\nto the Country column using the pattern described above.\n\nOnce I had left flags in the region column dictating where each region\nwas starting I could use `fill(Region)` in order to populate the rest of\nthe column.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemptyRegionCol <- as.numeric(vector(mode = \"character\",length = length(rawData_CurrentUSD$`1949`)))## doing as numeric here as a hacky way to fill this with NA's, any better way?\n\n#adding col to tibble to be populated later\nmutated_CurrentUSD <- rawData_CurrentUSD %>%\n  mutate(Region =emptyRegionCol,.before=2)\n\n# replacing the empty char in region with actual region if 2 NAs appear in a row\n  #iterates along the indices of the Country vector\nfor(i in seq_along(mutated_CurrentUSD$Country) ){\n   #if 2 nas in a row then do something\n  if(is.na(mutated_CurrentUSD$`1949`[i]) && is.na(mutated_CurrentUSD$`1949`[i+1]) ){\n    mutated_CurrentUSD$Region[i+1] <- mutated_CurrentUSD$Country[i+1] #this works because when referencing an index outside of the vector R will return NA - Great to know.\n  }\n  #if the row is a region\n  if(is.na(mutated_CurrentUSD$`1949`[i]) ){\n     mutated_CurrentUSD$Region[i+1] <- mutated_CurrentUSD$Country[i]\n  }\n}\n\nmutated_CurrentUSD <- mutated_CurrentUSD %>%\n  fill(Region)\n\nhead(mutated_CurrentUSD)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 75\n  Country  Region `1949` `1950` `1951` `1952` `1953` `1954` `1955` `1956` `1957`\n  <chr>    <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 Africa   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n2 North A… Africa <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n3 Algeria  North… xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n4 Libya    North… xxx    xxx    ...    ...    ...    ...    ...    ...    ...   \n5 Morocco  North… xxx    xxx    xxx    xxx    xxx    xxx    xxx    23.71… 35.40…\n6 Tunisia  North… xxx    xxx    xxx    xxx    xxx    xxx    xxx    3.714… 6.411…\n# … with 64 more variables: `1958` <chr>, `1959` <chr>, `1960` <chr>,\n#   `1961` <chr>, `1962` <chr>, `1963` <chr>, `1964` <chr>, `1965` <chr>,\n#   `1966` <chr>, `1967` <chr>, `1968` <chr>, `1969` <chr>, `1970` <chr>,\n#   `1971` <chr>, `1972` <chr>, `1973` <chr>, `1974` <chr>, `1975` <chr>,\n#   `1976` <chr>, `1977` <chr>, `1978` <chr>, `1979` <chr>, `1980` <chr>,\n#   `1981` <chr>, `1982` <chr>, `1983` <chr>, `1984` <chr>, `1985` <chr>,\n#   `1986` <chr>, `1987` <chr>, `1988` <chr>, `1989` <chr>, `1990` <chr>, …\n```\n:::\n:::\n\n\nNow that I had my proof of concept for cleaning one of the sheets, in a\nformat I wanted, it was time to clean the other sheets as well. I could\nhave taken the above code and modified it to work for each of the\nother tabs individually however I took the opportunity to practice with\nfunctions and created the below function to clean any of the tabs once\nthey were loaded in and lightly pre-processed.\n\n## Clean and format function\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## creating a function to clean the other sheets\n##Input: a partially cleaned tibble, must have been read in and had excess rows trimmed\n##output: tibble with regions correctly labeled and umbrella region categories i.e Africa above south Africa removed\n##Note: All sub categories contained the main category name in them, will use regex to create groupings in the future.\nCleanData <- function(inSheet){\n  emptyRegionCol <- as.numeric(vector(mode = \"character\",length = nrow(select(inSheet,2))))\n\n  #adding col to tibble to be populated later\n  output <- inSheet %>%\n    mutate(Region = emptyRegionCol,.before=2)\n\n\n  # replacing the empty char in region with actual region if 2 NAs appear in a row\n    #iterates along the indices of the Country vector\n  for(i in seq_along(output$Country)){\n  \n    if(is.na(output[[i,3]]) && is.na(output[[(i+1),3]]))\n      output$Region[i+1] <- output$Country[i+1]\n    \n    if(is.na(output[[i,3]]))\n       output$Region[i+1] <- output$Country[i]\n  }\n  \n  output <- output %>%\n    fill(Region)\n  \n  \n  # removing header rows\n  output <- output %>%\n    filter(!is.na(output[[3]]))\n}\n```\n:::\n\n\nBelow I call the function on each of the tibbles loaded in earlier. For\nthe sake of space I will only show one tab being cleaned.\n\nBefore:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 35\n  Country  `1988` `1989` `1990` `1991` `1992` `1993` `1994` `1995` `1996` `1997`\n  <chr>    <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 Africa   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n2 North A… <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n3 Algeria  ...    ...    5.682… 4.356… 7.450… 7.634… 0.101… 9.989… 0.109… 0.119…\n4 Libya    ...    ...    ...    ...    ...    ...    ...    ...    ...    0.116…\n5 Morocco  ...    ...    0.145… 0.158… 0.151… 0.158… 0.162… 0.160… 0.176… 0.177…\n6 Tunisia  ...    ...    ...    6.326… 6.329… 6.191… 6.401… 6.258… 6.674… 6.709…\n# … with 24 more variables: `1998` <chr>, `1999` <chr>, `2000` <chr>,\n#   `2001` <chr>, `2002` <chr>, `2003` <chr>, `2004` <chr>, `2005` <chr>,\n#   `2006` <chr>, `2007` <chr>, `2008` <chr>, `2009` <chr>, `2010` <chr>,\n#   `2011` <chr>, `2012` <chr>, `2013` <chr>, `2014` <chr>, `2015` <chr>,\n#   `2016` <chr>, `2017` <chr>, `2018` <chr>, `2019` <chr>, `2020` <chr>,\n#   `2021` <chr>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nCleaned_currentUSD <- CleanData(rawData_CurrentUSD)\nCleaned_ShareOfGovSpend <- CleanData(rawData_ShareOfGovSpend)\nCleaned_ShareOfGDP <- CleanData(rawData_ShareOfGDP)\n```\n:::\n\n\nAfter:\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 75\n  Country Region  `1949` `1950` `1951` `1952` `1953` `1954` `1955` `1956` `1957`\n  <chr>   <chr>   <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 Algeria North … xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n2 Libya   North … xxx    xxx    ...    ...    ...    ...    ...    ...    ...   \n3 Morocco North … xxx    xxx    xxx    xxx    xxx    xxx    xxx    1.180… 1.759…\n4 Tunisia North … xxx    xxx    xxx    xxx    xxx    xxx    xxx    ...    ...   \n5 Angola  sub-Sa… xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n6 Benin   sub-Sa… xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n# … with 64 more variables: `1958` <chr>, `1959` <chr>, `1960` <chr>,\n#   `1961` <chr>, `1962` <chr>, `1963` <chr>, `1964` <chr>, `1965` <chr>,\n#   `1966` <chr>, `1967` <chr>, `1968` <chr>, `1969` <chr>, `1970` <chr>,\n#   `1971` <chr>, `1972` <chr>, `1973` <chr>, `1974` <chr>, `1975` <chr>,\n#   `1976` <chr>, `1977` <chr>, `1978` <chr>, `1979` <chr>, `1980` <chr>,\n#   `1981` <chr>, `1982` <chr>, `1983` <chr>, `1984` <chr>, `1985` <chr>,\n#   `1986` <chr>, `1987` <chr>, `1988` <chr>, `1989` <chr>, `1990` <chr>, …\n```\n:::\n:::\n\n\n## Pivoting and Restructuring\n\n### Pivot and Notation Changes\n\nNext I pivot the years, it should be noted that both the pivoting and\nConverting of notation could be handled by the clean function above, i\nkept the steps separate so that I could show the progression of the\ndataframe.\n\nI must also handle the xxx and ... notations. From the information page\nof my data set I can see that the notation is described as follows:\n\n| Raw Notation | Meaning                                                                                 |\n|------------------------------------|------------------------------------|\n| ...          | Data unavailable                                                                        |\n| xxx          | Country did not exist or was not independent during all or part of the year in question |\n\nFor now I think I will just keep both as NA but will save this form of\nthe information for future use.\n\nAfter pivot and notation changes:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCleaned_currentUSD <- Cleaned_currentUSD %>%\n  pivot_longer(cols=3:ncol(Cleaned_currentUSD),names_to = \"Year\",values_drop_na = FALSE)%>%\n    na_if(\"...\") %>%\n      na_if(\"xxx\")\n  \nCleaned_ShareOfGovSpend <- Cleaned_ShareOfGovSpend %>%\n  pivot_longer(cols=3:ncol(Cleaned_ShareOfGovSpend),names_to = \"Year\",values_drop_na = FALSE)%>%\n    na_if(\"...\") %>%\n      na_if(\"xxx\")\n\nCleaned_ShareOfGDP <- Cleaned_ShareOfGDP %>%\n  pivot_longer(cols=3:ncol(Cleaned_ShareOfGDP),names_to = \"Year\",values_drop_na = FALSE)%>%\n    na_if(\"...\") %>%\n      na_if(\"xxx\")\n\n\ndf1<-head(Cleaned_currentUSD)\ndf2<-head(Cleaned_ShareOfGovSpend)\ndf3<-head(Cleaned_ShareOfGDP)\n\n\n#df1\n#df2\n# share of GDP\ndf3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  Country Region       Year  value\n  <chr>   <chr>        <chr> <chr>\n1 Algeria North Africa 1949  <NA> \n2 Algeria North Africa 1950  <NA> \n3 Algeria North Africa 1951  <NA> \n4 Algeria North Africa 1952  <NA> \n5 Algeria North Africa 1953  <NA> \n6 Algeria North Africa 1954  <NA> \n```\n:::\n\n```{.r .cell-code}\n# testing knitr... needs to be a bit better\n# knitr::kable(\n#   list(df1,df2,df3),\n#   caption = \"test\",\n#   booktabs = TRUE,valign='t'\n# )\n```\n:::\n\n\n### Converting Column Types\n\nFinally I will convert the column types to their correct representation.\n\nBefore:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  Country Region       Year  value\n  <chr>   <chr>        <chr> <chr>\n1 Algeria North Africa 1949  <NA> \n2 Algeria North Africa 1950  <NA> \n3 Algeria North Africa 1951  <NA> \n4 Algeria North Africa 1952  <NA> \n5 Algeria North Africa 1953  <NA> \n6 Algeria North Africa 1954  <NA> \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Year to Number\nCleaned_currentUSD$Year<-as.integer(Cleaned_currentUSD$Year)\nCleaned_ShareOfGovSpend$Year<-as.integer(Cleaned_ShareOfGovSpend$Year)\nCleaned_ShareOfGDP$Year<-as.integer(Cleaned_ShareOfGDP$Year)\n\n# value to double\nCleaned_currentUSD$value <- as.numeric(Cleaned_currentUSD$value)\nCleaned_ShareOfGovSpend$value<- as.numeric(Cleaned_ShareOfGovSpend$value)\nCleaned_ShareOfGDP$value<- as.numeric(Cleaned_ShareOfGDP$value)\n```\n:::\n\n\nAfter:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  Country Region        Year value\n  <chr>   <chr>        <int> <dbl>\n1 Algeria North Africa  1949    NA\n2 Algeria North Africa  1950    NA\n3 Algeria North Africa  1951    NA\n4 Algeria North Africa  1952    NA\n5 Algeria North Africa  1953    NA\n6 Algeria North Africa  1954    NA\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#view(Cleaned_ShareOfGovSpend)=\nCleaned_currentUSD <- Cleaned_currentUSD %>%\n  rename(MilitarySpend_currentUSD=value)\n\nCleaned_ShareOfGovSpend <- Cleaned_ShareOfGovSpend%>%\n  rename(MilitarySpend_ShareofGovSpend=value)\n\nCleaned_ShareOfGDP <- Cleaned_ShareOfGDP%>%\n  rename(MilitarySpend_ShareofGDP=value)\n\n#head(Cleaned_currentUSD)\n#head(Cleaned_ShareOfGovSpend)\nhead(Cleaned_ShareOfGDP)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  Country Region        Year MilitarySpend_ShareofGDP\n  <chr>   <chr>        <int>                    <dbl>\n1 Algeria North Africa  1949                       NA\n2 Algeria North Africa  1950                       NA\n3 Algeria North Africa  1951                       NA\n4 Algeria North Africa  1952                       NA\n5 Algeria North Africa  1953                       NA\n6 Algeria North Africa  1954                       NA\n```\n:::\n:::\n\n\n### Joining of the Different Tabs\n\nI think we will want to do a full join as we dont want to lose any\ninformation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#nrow(Cleaned_currentUSD)\n#nrow(Cleaned_ShareOfGovSpend)\n#nrow(Cleaned_ShareOfGDP)\n\nMilitarySpend<- full_join(Cleaned_currentUSD,Cleaned_ShareOfGovSpend,by=c(\"Country\",\"Year\",\"Region\"))\n\nMilitarySpend <- full_join(MilitarySpend,Cleaned_ShareOfGDP,by=c(\"Country\",\"Year\",\"Region\"))\n\n\n\nhead(MilitarySpend)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 6\n  Country Region        Year MilitarySpend_currentUSD MilitarySpend_Sh…¹ Milit…²\n  <chr>   <chr>        <int>                    <dbl>              <dbl>   <dbl>\n1 Algeria North Africa  1949                       NA                 NA      NA\n2 Algeria North Africa  1950                       NA                 NA      NA\n3 Algeria North Africa  1951                       NA                 NA      NA\n4 Algeria North Africa  1952                       NA                 NA      NA\n5 Algeria North Africa  1953                       NA                 NA      NA\n6 Algeria North Africa  1954                       NA                 NA      NA\n# … with abbreviated variable names ¹​MilitarySpend_ShareofGovSpend,\n#   ²​MilitarySpend_ShareofGDP\n```\n:::\n\n```{.r .cell-code}\n#nrow(MilitarySpend)\n```\n:::\n\n\n# Descriptive stats\n\n## Pivoting\n\nMean, Median and Standard Deviation for each of the tabs.\n\nFirst I wanted to get an idea of what my data looks like for each of the\ncountries individually. In order to see this I grouped on country name\nand the types of data we have.\n\nIn order to get that done I need to pivot my data again.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombinedData <-MilitarySpend %>%\n  pivot_longer(c(MilitarySpend_currentUSD,MilitarySpend_ShareofGovSpend,MilitarySpend_ShareofGDP),names_to = \"viewOfSpend\",values_to = \"Spend\")\nhead(combinedData)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n  Country Region        Year viewOfSpend                   Spend\n  <chr>   <chr>        <int> <chr>                         <dbl>\n1 Algeria North Africa  1949 MilitarySpend_currentUSD         NA\n2 Algeria North Africa  1949 MilitarySpend_ShareofGovSpend    NA\n3 Algeria North Africa  1949 MilitarySpend_ShareofGDP         NA\n4 Algeria North Africa  1950 MilitarySpend_currentUSD         NA\n5 Algeria North Africa  1950 MilitarySpend_ShareofGovSpend    NA\n6 Algeria North Africa  1950 MilitarySpend_ShareofGDP         NA\n```\n:::\n\n```{.r .cell-code}\n#view(combinedData)\ncombinedData<-na.omit(combinedData)\n```\n:::\n\n\nBelow is a graph depicting the completeness of the information available\nto us.\n\nTotal number of countries analyzed:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombinedData%>%\n  distinct(Country)%>%\n  count()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n      n\n  <int>\n1   173\n```\n:::\n:::\n\n\nNumber of countries by region:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombinedData%>%\n  group_by(Region)%>%\n  summarise(numberCountries = n_distinct(Country))%>%\n  arrange(desc(numberCountries))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 14 × 2\n   Region                            numberCountries\n   <chr>                                       <int>\n 1 sub-Saharan Africa                             47\n 2 Central Europe                                 20\n 3 Western Europe                                 20\n 4 Middle East                                    16\n 5 Central America and the Caribbean              13\n 6 South America                                  11\n 7 South East Asia                                11\n 8 Eastern Europe                                  8\n 9 East Asia                                       6\n10 South Asia                                      6\n11 Central Asia                                    5\n12 North Africa                                    4\n13 Oceania                                         4\n14 North America                                   2\n```\n:::\n:::\n\n\n## Statistics by region\nNow that I have all of my data in a malleable state I will do some initial statistics on each tab of the initial dataset to give asome insight to what patterns or outliers may exist.\n\n\n### MilitarySpend_currentUSD\n\nI will be using the current USD data for my analysis of major world events so I will not dive deeper at this point.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_USD<-combinedData%>%\n  group_by(Region,viewOfSpend)%>%\n  summarize(mean = mean(Spend, na.rm=TRUE,sigfig=1),\n            std = sd(Spend, na.rm=TRUE),\n            min = min(Spend, na.rm=TRUE),\n            max = max(Spend, na.rm=TRUE))%>%\n  arrange(desc(mean))%>%\n  filter(viewOfSpend==\"MilitarySpend_currentUSD\")\n\nbyRegionStats_USD\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 14 × 6\n# Groups:   Region [14]\n   Region                            viewOfSpend       mean    std    min    max\n   <chr>                             <chr>            <dbl>  <dbl>  <dbl>  <dbl>\n 1 North America                     MilitarySpend_… 1.49e5 2.23e5 426.   8.01e5\n 2 East Asia                         MilitarySpend_… 2.04e4 4.21e4   0    2.93e5\n 3 Eastern Europe                    MilitarySpend_… 1.09e4 3.52e4   0    2.46e5\n 4 Western Europe                    MilitarySpend_… 7.14e3 1.28e4   0    7.34e4\n 5 Middle East                       MilitarySpend_… 4.91e3 9.59e3   0    8.72e4\n 6 South Asia                        MilitarySpend_… 4.46e3 1.17e4   2.48 7.66e4\n 7 Oceania                           MilitarySpend_… 2.83e3 6.29e3   0    3.18e4\n 8 South America                     MilitarySpend_… 2.02e3 4.57e3   0    3.69e4\n 9 South East Asia                   MilitarySpend_… 1.94e3 3.16e3   0    3.30e4\n10 North Africa                      MilitarySpend_… 1.36e3 2.21e3   3.71 1.04e4\n11 Central Europe                    MilitarySpend_… 1.14e3 2.20e3   0    1.74e4\n12 Central Asia                      MilitarySpend_… 3.36e2 5.92e2   0    2.55e3\n13 Central America and the Caribbean MilitarySpend_… 2.86e2 9.54e2   0    8.68e3\n14 sub-Saharan Africa                MilitarySpend_… 2.58e2 6.35e2   0    6.85e3\n```\n:::\n:::\n\n\n### MilitarySpend_ShareOfGDP\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_GDP<-combinedData%>%\n  group_by(Region,viewOfSpend)%>%\n  summarize(mean = mean(Spend, na.rm=TRUE,sigfig=1),\n            std = sd(Spend, na.rm=TRUE),\n            min = min(Spend, na.rm=TRUE),\n            max = max(Spend, na.rm=TRUE))%>%\n  arrange(desc(mean))%>%\n  filter(viewOfSpend==\"MilitarySpend_ShareofGDP\")\n\nbyRegionStats_GDP\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 14 × 6\n# Groups:   Region [14]\n   Region                            viewOfSpend     mean     std     min    max\n   <chr>                             <chr>          <dbl>   <dbl>   <dbl>  <dbl>\n 1 Middle East                       MilitarySpen… 0.0774 0.0672  1.12e-2 1.17  \n 2 North America                     MilitarySpen… 0.0422 0.0285  9.90e-3 0.139 \n 3 North Africa                      MilitarySpen… 0.0297 0.0158  9.47e-3 0.155 \n 4 South East Asia                   MilitarySpen… 0.0273 0.0159  1.90e-3 0.0868\n 5 East Asia                         MilitarySpen… 0.0261 0.0190  6.30e-3 0.0833\n 6 South Asia                        MilitarySpen… 0.0258 0.0169  2.45e-3 0.0699\n 7 Eastern Europe                    MilitarySpen… 0.0253 0.0151  2.63e-3 0.0916\n 8 South America                     MilitarySpen… 0.0237 0.0127  1.51e-3 0.0888\n 9 Western Europe                    MilitarySpen… 0.0232 0.0146  2.65e-3 0.110 \n10 sub-Saharan Africa                MilitarySpen… 0.0223 0.0261  1.72e-7 0.344 \n11 Central Europe                    MilitarySpen… 0.0200 0.0132  1.63e-4 0.111 \n12 Oceania                           MilitarySpen… 0.0175 0.00862 1.88e-3 0.0518\n13 Central Asia                      MilitarySpen… 0.0130 0.00599 3.66e-6 0.0396\n14 Central America and the Caribbean MilitarySpen… 0.0118 0.00923 6.15e-4 0.0659\n```\n:::\n:::\n\n\nAfter sorting by mean share of GDP spend I see that the middle east has the highest by quite a large margin. This is odd because usally the US(North America), has the highest military spending. A max of 1.17 for GDP is also stageringly high when compared to the other regions. This prompts further investigation. A violin plot below gives a visualization of this distribution.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_GDP\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 14 × 6\n# Groups:   Region [14]\n   Region                            viewOfSpend     mean     std     min    max\n   <chr>                             <chr>          <dbl>   <dbl>   <dbl>  <dbl>\n 1 Middle East                       MilitarySpen… 0.0774 0.0672  1.12e-2 1.17  \n 2 North America                     MilitarySpen… 0.0422 0.0285  9.90e-3 0.139 \n 3 North Africa                      MilitarySpen… 0.0297 0.0158  9.47e-3 0.155 \n 4 South East Asia                   MilitarySpen… 0.0273 0.0159  1.90e-3 0.0868\n 5 East Asia                         MilitarySpen… 0.0261 0.0190  6.30e-3 0.0833\n 6 South Asia                        MilitarySpen… 0.0258 0.0169  2.45e-3 0.0699\n 7 Eastern Europe                    MilitarySpen… 0.0253 0.0151  2.63e-3 0.0916\n 8 South America                     MilitarySpen… 0.0237 0.0127  1.51e-3 0.0888\n 9 Western Europe                    MilitarySpen… 0.0232 0.0146  2.65e-3 0.110 \n10 sub-Saharan Africa                MilitarySpen… 0.0223 0.0261  1.72e-7 0.344 \n11 Central Europe                    MilitarySpen… 0.0200 0.0132  1.63e-4 0.111 \n12 Oceania                           MilitarySpen… 0.0175 0.00862 1.88e-3 0.0518\n13 Central Asia                      MilitarySpen… 0.0130 0.00599 3.66e-6 0.0396\n14 Central America and the Caribbean MilitarySpen… 0.0118 0.00923 6.15e-4 0.0659\n```\n:::\n\n```{.r .cell-code}\nbyRegionStats_GDP<-combinedData%>%\n  group_by(Region,viewOfSpend,Year)%>%\n  filter(viewOfSpend==\"MilitarySpend_ShareofGDP\")\n\n\nbyRegionStats_GDP$Region<-as.factor(byRegionStats_GDP$Region)\n\nviolin_gdp<- na.omit(byRegionStats_GDP)%>%\n  ggplot(aes(x=Region,y=Spend))+\n  geom_violin()+\n  theme(axis.text.x=element_text(angle=60,hjust=1))\n\nviolin_gdp\n```\n\n::: {.cell-output-display}\n![](Final-Project-_-JulianCastoro_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# removing NAs here because I cant plot them, I dont want to replace them with other values because it is still of interest when countries do not display thier data.\n```\n:::\n\n\nUpon investigation of the underlying data I see that Kuwait in 1991 is the culprit of the high military spending as percent of GDP number.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_GDP%>%\n  filter(Region==\"Middle East\")%>%\n  arrange(desc(Spend))%>%\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n# Groups:   Region, viewOfSpend, Year [6]\n  Country Region       Year viewOfSpend              Spend\n  <chr>   <fct>       <int> <chr>                    <dbl>\n1 Kuwait  Middle East  1991 MilitarySpend_ShareofGDP 1.17 \n2 Kuwait  Middle East  1990 MilitarySpend_ShareofGDP 0.485\n3 Kuwait  Middle East  1992 MilitarySpend_ShareofGDP 0.318\n4 Israel  Middle East  1975 MilitarySpend_ShareofGDP 0.305\n5 Israel  Middle East  1976 MilitarySpend_ShareofGDP 0.292\n6 Israel  Middle East  1973 MilitarySpend_ShareofGDP 0.279\n```\n:::\n:::\n\n\nI initially thought this was a typo since there were two 1s in a row and\nit was such an insanely high spend. A share of GDP of 1.173 means Kuwait\nspent 117.3% of their GDP in that year. Upon further investigation, this\nis actually true and it was driven by the Persian Gulf War(aka Gulf\nWar). The Gulf War was a conflict triggered by Iraqs invasion of Kuwait\nin 1990. This invasion was the first major international crisis since\nthe Cold War and will certainly be a topic I add to the final analysis.\n\nhttps://www.britannica.com/event/Persian-Gulf-War\n\nLoosely I will plot Iraq, US and Kuwait spend from 1985-1995 to explore\nthis time period.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombinedData%>%\n  filter(Year >= 1985 & Year<= 1995)%>%\n  filter(Country %in% c(\"United States of America\",\"Iraq\",\"Kuwait\"))%>%\n    ggplot(mapping=aes(y = Spend, x = Year))+  \n    geom_point(aes(color = Country, alpha=0.9),na.rm = FALSE)+\n    facet_wrap(vars(`viewOfSpend`),scales = \"free_y\")\n```\n\n::: {.cell-output-display}\n![](Final-Project-_-JulianCastoro_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\nA new discovery! Iraq chose not to report their spending during the Gulf\nwar. This is most likely due to the fact that SIPRI data collection is funded by the Swedish government who have pretty close ties to the United States. Sweden was one of the first countries to recognize US independence in 1783. Below I highlight reported Iraqi military spending overlaid with markings for the start and end of their reported data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombinedData%>%\n  filter(Country %in% c(\"Iraq\"))%>%\n  filter(Year>1960&is.na(Spend))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 0 × 5\n# … with 5 variables: Country <chr>, Region <chr>, Year <int>,\n#   viewOfSpend <chr>, Spend <dbl>\n```\n:::\n\n```{.r .cell-code}\nstartOfNoData<- 1982\nendofNoData<- 2003\n\niraqMissingDataPLOT<-combinedData%>%\n  filter(Country %in% c(\"Iraq\"))%>%\n    ggplot(mapping=aes( x = Spend,y = Year))+\n    geom_point()+\n    facet_wrap(vars(`viewOfSpend`),scales = \"free_x\")+\n    scale_y_continuous(labels=seq(1949,2020,5),breaks =seq(1949,2020,5))\n\niraqMissingDataPLOT+\ngeom_hline(yintercept = 1982,color=\"red\")+\ngeom_hline(yintercept = 2003,color=\"red\")+\ngeom_hline(yintercept = 1985,color=\"blue\")+\ngeom_hline(yintercept = 1995,color=\"blue\")+\nannotate(\"text\",x=0,y=1982,label=\"1982\",hjust=-0.1,vjust=-0.1,color=\"red\")+\nannotate(\"text\",x=0,y=2003,label=\"2003\",hjust=-0.1,vjust=1.1,color=\"red\")+\nannotate(\"text\",x=0,y=1985,label=\"Start of Gulf war\",hjust=-0.1,vjust=-0.1,color=\"blue\")+\nannotate(\"text\",x=0,y=1995,label=\"End of Gulf war\",hjust=-0.1,vjust=-0.1,color=\"blue\")\n```\n\n::: {.cell-output-display}\n![](Final-Project-_-JulianCastoro_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n### MilitarySpend_ShareofGovSpend\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_GovSpend<-combinedData%>%\n  group_by(Region,viewOfSpend)%>%\n  summarize(mean = mean(Spend, na.rm=TRUE,sigfig=1),\n            std = sd(Spend, na.rm=TRUE),\n            min = min(Spend, na.rm=TRUE),\n            max = max(Spend, na.rm=TRUE))%>%\n  arrange(desc(mean))%>%\n  filter(viewOfSpend==\"MilitarySpend_ShareofGovSpend\")\n\nbyRegionStats_GovSpend\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 14 × 6\n# Groups:   Region [14]\n   Region                            viewOfSpend      mean    std     min    max\n   <chr>                             <chr>           <dbl>  <dbl>   <dbl>  <dbl>\n 1 Middle East                       MilitarySpend… 0.161  0.0757 1.83e-2 0.575 \n 2 South Asia                        MilitarySpend… 0.122  0.0511 3.65e-2 0.274 \n 3 Eastern Europe                    MilitarySpend… 0.115  0.0887 7.71e-3 0.350 \n 4 sub-Saharan Africa                MilitarySpend… 0.103  0.260  3.90e-3 5.82  \n 5 South East Asia                   MilitarySpend… 0.0984 0.0749 7.83e-3 0.392 \n 6 North Africa                      MilitarySpend… 0.0973 0.0369 2.81e-2 0.178 \n 7 East Asia                         MilitarySpend… 0.0837 0.0503 1.73e-2 0.225 \n 8 South America                     MilitarySpend… 0.0728 0.0392 1.73e-2 0.348 \n 9 North America                     MilitarySpend… 0.0600 0.0386 2.51e-2 0.124 \n10 Central Asia                      MilitarySpend… 0.0518 0.0269 1.36e-2 0.158 \n11 Oceania                           MilitarySpend… 0.0441 0.0155 1.54e-2 0.0879\n12 Central Europe                    MilitarySpend… 0.0439 0.0283 6.72e-4 0.290 \n13 Central America and the Caribbean MilitarySpend… 0.0354 0.0218 2.20e-3 0.214 \n14 Western Europe                    MilitarySpend… 0.0348 0.0189 8.58e-3 0.164 \n```\n:::\n:::\n\nThe share of Gov spend shows an insanely high max of sub-Saharan African spending as well as the Middle East.The Middle east spending has been explained above however below I will investigate the sub-sahara African spending.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nviolin_ShareOfSpend<- na.omit(byRegionStats_GovSpend)%>%\n  ggplot(aes(x=Region,y=Spend))+\n  geom_violin()+\n  theme(axis.text.x=element_text(angle=60,hjust=1))\n\nviolin_gdp\n```\n\n::: {.cell-output-display}\n![](Final-Project-_-JulianCastoro_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n\nZooming into Zimbabwe's Violin plot we can see that they often have an exteremly high military spending when compared to overall spending. As suggested by [5], Zimbabwe's military spending is highly influenced by internal political turbulence more so than economic factors. It should also be mentioned that their military spending is often determined by SIPRI from estimation and not necessarily accurate, for this reason I wont be looking further into the anomaly.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombinedData%>%\n  filter(viewOfSpend==\"MilitarySpend_ShareofGovSpend\")%>%\n  filter(Region == \"sub-Saharan Africa\")%>%\n  filter(Country==\"Zimbabwe\")%>%\n  ggplot(aes(x=Country,y=Spend))+\n  geom_violin()+\n  theme(axis.text.x=element_text(angle=60,hjust=1))\n```\n\n::: {.cell-output-display}\n![](Final-Project-_-JulianCastoro_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\nNow that some introductory statistics have been done to explain the data at first glance, we focus in on the heavy hitters in the military spending space and look into how recent global events have affected their spending habits.\n\n\nTop 6 mean spenders\n\n::: {.cell}\n\n```{.r .cell-code}\ntop6_mean <- byRegionStats %>%\n  head()%>%\n  pull(Region)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in head(.): object 'byRegionStats' not found\n```\n:::\n\n```{.r .cell-code}\ntop6_mean\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'top6_mean' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(forcats)\n\nstatsViz2<- byRegionStats%>%\n  mutate(test = fct_reorder(Region,desc(mean)))%>%\n  ggplot(mapping=aes(y = test, x = mean))+  \n  geom_point(aes(color = Region, alpha=0.9, size=max)) +\n  guides(alpha=\"none\",color=\"none\") +\n  labs(title = \"Certain Regions on average spend more than others\" ,caption = \"Data from SPIRI Military Expediture Database\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in mutate(., test = fct_reorder(Region, desc(mean))): object 'byRegionStats' not found\n```\n:::\n\n```{.r .cell-code}\nstatsViz2\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'statsViz2' not found\n```\n:::\n:::\n\n\nFrom this we can see the top 6 spenders reside in a cluster of there own\nwhen you look at their mean and max spend.\n\n## Faceted by Region, show mean spend of each country\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_year<-combinedData%>%\n  group_by(Region,viewOfSpend,Year)%>%\n  summarize(mean = mean(Spend, na.rm=TRUE))%>%\n  filter(viewOfSpend == 'MilitarySpend_currentUSD')%>%\n  arrange(desc(mean))\n\nbyRegionStats_year\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 924 × 4\n# Groups:   Region, viewOfSpend [14]\n   Region        viewOfSpend               Year    mean\n   <chr>         <chr>                    <int>   <dbl>\n 1 North America MilitarySpend_currentUSD  2021 413561.\n 2 North America MilitarySpend_currentUSD  2020 400839.\n 3 North America MilitarySpend_currentUSD  2011 386841.\n 4 North America MilitarySpend_currentUSD  2010 378660.\n 5 North America MilitarySpend_currentUSD  2019 378369.\n 6 North America MilitarySpend_currentUSD  2012 372829.\n 7 North America MilitarySpend_currentUSD  2009 362427.\n 8 North America MilitarySpend_currentUSD  2018 352610.\n 9 North America MilitarySpend_currentUSD  2013 348872.\n10 North America MilitarySpend_currentUSD  2008 338049.\n# … with 914 more rows\n```\n:::\n\n```{.r .cell-code}\nbyRegionplot<- byRegionStats_year%>%\n  ggplot(mapping=aes(x = Year, y = mean))+  \n  geom_point(aes(color = Region, alpha=0.9,)) +\n  theme_light() +\n  guides(alpha=\"none\") +\n  labs(title = \"East asia and NA dominate raw spend\" ,caption = \"Data from SPIRI Military Expediture Database\")\n  \n\nbyRegionplot\n```\n\n::: {.cell-output-display}\n![](Final-Project-_-JulianCastoro_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n\n## To be a little less noisy, showing the top 6 spenders over time\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_year_top6<-combinedData%>%\n  group_by(Region,viewOfSpend,Year)%>%\n  summarize(mean = mean(Spend, na.rm=TRUE))%>%\n  filter(viewOfSpend == 'MilitarySpend_currentUSD')%>%\n  filter(Region == top6_mean)%>%\n  arrange(desc(mean))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\n! Problem while computing `..1 = Region == top6_mean`.\nℹ The error occurred in group 1: Region = \"Central America and the Caribbean\",\n  viewOfSpend = \"MilitarySpend_currentUSD\".\nCaused by error in `mask$eval_all_filter()`:\n! object 'top6_mean' not found\n```\n:::\n\n```{.r .cell-code}\nbyRegionplot_top6<- byRegionStats_year_top6%>%\n  ggplot(mapping=aes(x = Year, y = mean))+\n  geom_point(aes(color = Region, alpha=0.9,)) +\n  facet_wrap(vars(`Region`),scales = \"free_y\") +\n  labs(title = \"Raw Mean Spend in USD for top 6 Spenders\" ,caption = \"Data from SPIRI Military Expediture Database\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(., mapping = aes(x = Year, y = mean)): object 'byRegionStats_year_top6' not found\n```\n:::\n\n```{.r .cell-code}\nbyRegionplot_top6\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'byRegionplot_top6' not found\n```\n:::\n:::\n\n\n## Seeing one member at a time\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##V .... not needed....V\n\nbyRegion_byYear_Stats<-combinedData%>%\n  group_by(Region,viewOfSpend, Year)%>%\n  summarize(mean = mean(Spend, na.rm=TRUE,sigfig=1),\n            std = sd(Spend, na.rm=TRUE))%>%\n  filter(mean>=1880)%>%\n  arrange(desc(mean))\n\nbyRegion_byYear_Stats\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 389 × 5\n# Groups:   Region, viewOfSpend [11]\n   Region        viewOfSpend               Year    mean     std\n   <chr>         <chr>                    <int>   <dbl>   <dbl>\n 1 North America MilitarySpend_currentUSD  2021 413561. 547458.\n 2 North America MilitarySpend_currentUSD  2020 400839. 533948.\n 3 North America MilitarySpend_currentUSD  2011 386841. 516820.\n 4 North America MilitarySpend_currentUSD  2010 378660. 508190.\n 5 North America MilitarySpend_currentUSD  2019 378369. 503424.\n 6 North America MilitarySpend_currentUSD  2012 372829. 498336.\n 7 North America MilitarySpend_currentUSD  2009 362427. 485769.\n 8 North America MilitarySpend_currentUSD  2018 352610. 466522.\n 9 North America MilitarySpend_currentUSD  2013 348872. 467195.\n10 North America MilitarySpend_currentUSD  2008 338049. 450720.\n# … with 379 more rows\n```\n:::\n\n```{.r .cell-code}\neasternEurope<- byRegionStats_year%>%\n  ggplot(mapping=aes(x = Year, y = mean))+\n  geom_point(aes(color = Region, alpha=0.9,)) +\n  theme_light() +\n  guides(alpha=\"none\") +\n labs(title = \"East asia and NA dominate raw spend\" ,caption = \"Data from SPIRI Military Expediture Database\")\n\n\neasternEurope\n```\n\n::: {.cell-output-display}\n![](Final-Project-_-JulianCastoro_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntopMean<-combinedData%>%\n  group_by(Country,Region,viewOfSpend)%>%\n  summarize(mean = mean(Spend, na.rm=TRUE,sigfig=1),\n            std = sd(Spend, na.rm=TRUE))%>%\n  filter(mean>=1880)%>%\n  arrange(desc(mean))\n\nbotMean<-combinedData%>%\n  group_by(Country,Region,viewOfSpend)%>%\n  summarize(mean = mean(Spend, na.rm=TRUE,sigfig=1),\n            std = sd(Spend, na.rm=TRUE))%>%\n  filter(mean>=1880)%>%\n  arrange(mean)\n\n\n\ncombinedData%>%\n  filter(Country == \"Afghanistan\")%>%\n  na.omit()%>%\n  mean(Spend)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] NA\n```\n:::\n:::\n\n\ntop 5 spenders on average:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(topMean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n# Groups:   Country, Region [6]\n  Country                  Region         viewOfSpend                mean    std\n  <chr>                    <chr>          <chr>                     <dbl>  <dbl>\n1 United States of America North America  MilitarySpend_currentUSD 2.88e5 2.46e5\n2 USSR                     Eastern Europe MilitarySpend_currentUSD 2.27e5 1.28e4\n3 China                    East Asia      MilitarySpend_currentUSD 9.03e4 8.95e4\n4 Russia                   Eastern Europe MilitarySpend_currentUSD 4.03e4 2.82e4\n5 United Kingdom           Western Europe MilitarySpend_currentUSD 3.11e4 2.31e4\n6 France                   Western Europe MilitarySpend_currentUSD 2.47e4 1.90e4\n```\n:::\n:::\n\n\nbot 5 spenders on average:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(botMean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n# Groups:   Country, Region [6]\n  Country      Region                            viewOfSpend          mean   std\n  <chr>        <chr>                             <chr>               <dbl> <dbl>\n1 Chile        South America                     MilitarySpend_curr… 1881. 1856.\n2 Denmark      Western Europe                    MilitarySpend_curr… 1975. 1627.\n3 Mexico       Central America and the Caribbean MilitarySpend_curr… 1977. 2257.\n4 Czechia      Central Europe                    MilitarySpend_curr… 2010.  794.\n5 South Africa sub-Saharan Africa                MilitarySpend_curr… 2128. 1509.\n6 Argentina    South America                     MilitarySpend_curr… 2136. 1758.\n```\n:::\n:::\n\n\n## Top spenders by Country\n\nIn the following analysis I will be looking at significant events which\nimpacted some if not all of the world. For the sake of clarity I will\nonly be focusing on a select group of individual countries which are\nnot directly involved. The top 10 countries which stand out as\nsignificant spenders in the last 10 years will be the ones focused on.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# getting top 10 mean spenders in last 10 years\ntopMeanCountries<-combinedData%>%\n  group_by(Country,viewOfSpend)%>%\n  filter(Year>=2012)%>%\n  filter(viewOfSpend==\"MilitarySpend_currentUSD\")%>%\n  summarize(mean = mean(Spend, na.rm=TRUE,sigfig=1))%>%\n  arrange(desc(mean))%>%\n  head(10)\ntopMeanCountriesVec<-topMeanCountries$Country\ntopMeanCountriesVec\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"United States of America\" \"China\"                   \n [3] \"Russia\"                   \"Saudi Arabia\"            \n [5] \"India\"                    \"United Kingdom\"          \n [7] \"France\"                   \"Japan\"                   \n [9] \"Germany\"                  \"Korea, South\"            \n```\n:::\n\n```{.r .cell-code}\n# Raw data for these 10 countries\ntop10SpendCountriesbyYear<-combinedData%>%\n  group_by(Country,viewOfSpend,Year)%>%\n  filter(viewOfSpend==\"MilitarySpend_currentUSD\")%>%\n  filter(Country %in% topMeanCountriesVec)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngrouped<-top10SpendCountriesbyYear%>%\n  ungroup()%>%\n  group_by(Country)\n\n#group_keys(grouped)\n\ntop10CountryTibbles<-grouped%>%\n  group_split(Country)\n\n#top10CountryTibbles\n\n\n# Using PURR here! Pretty powerful.\n  # result is list of tibbles which have been processed to contain YoY spend increases\ntop10CountryTibblesYoY<- map(top10CountryTibbles,~ .x %>% mutate(percentChangeYoY = ((Spend - lag(Spend))/Spend)*100))\n\n\n# I then stack these DF on top of eachother to create one single DF to interact with.\ntop10CountryYoY<-bind_rows(top10CountryTibblesYoY)\n\n\n#top10SpendCountriesbyYearYoY\n```\n:::\n\n\nPlots detailing \n\n\n::: {.cell}\n\n```{.r .cell-code}\nPercentChangeTop10Countries<-top10CountryYoY%>%\n  filter(Year>=1992)%>%\n  ggplot(mapping=aes(x = Year, y = percentChangeYoY))+\n  geom_line(aes(color = Country, alpha=0.9,))+\n  facet_wrap(vars(Country),scale=\"free_y\")+\n  theme(axis.text.x=element_text(angle=60,hjust=1))\n  \nPercentChangeTop10Countries\n```\n\n::: {.cell-output-display}\n![](Final-Project-_-JulianCastoro_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntop10Countries<- top10SpendCountriesbyYear%>%\n  ggplot(mapping=aes(x = Year, y = mean))+  \n  geom_point(aes(color = Country, alpha=0.9,)) +\n  theme_light() +\n  guides(alpha=\"none\") +\n  labs(title = \"East asia and NA dominate raw spend\" ,caption = \"Data from SPIRI Military Expediture Database\")\n\ntop10Countries\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `geom_point()`:\n! Problem while computing aesthetics.\nℹ Error occurred in the 1st layer.\nCaused by error in `compute_aesthetics()`:\n! Aesthetics are not valid data columns.\n✖ The following aesthetics are invalid:\n✖ `y = mean`\nℹ Did you mistype the name of a data column or forget to add `after_stat()`?\n```\n:::\n\n```{.r .cell-code}\ntop10Countries+\n  facet_wrap(vars(`Country`),scales = \"free_y\")+\n  theme(axis.text.x=element_text(angle=60,hjust=1))+\n  coord_cartesian((xlim=c(1990,2010)))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `geom_point()`:\n! Problem while computing aesthetics.\nℹ Error occurred in the 1st layer.\nCaused by error in `compute_aesthetics()`:\n! Aesthetics are not valid data columns.\n✖ The following aesthetics are invalid:\n✖ `y = mean`\nℹ Did you mistype the name of a data column or forget to add `after_stat()`?\n```\n:::\n:::\n\n\n## 9/11 analysis\n\nLook at US spending before and after\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUS911<-combinedData%>%\n  group_by(viewOfSpend,Year)%>%\n  filter(Country == 'United States of America')%>%\n  summarize(mean = mean(Spend, na.rm=TRUE))%>%\n  arrange(desc(mean))\n\n us911Plot<- US911%>%\n  ggplot(mapping=aes(x = Year, y = mean))+\n  geom_point(aes()) +\n  facet_wrap(vars(`viewOfSpend`),scales = \"free_y\") +\n  labs(title = \"United States \" ,caption = \"Data from SPIRI Military Expediture Database\")\n \nus911Plot\n```\n\n::: {.cell-output-display}\n![](Final-Project-_-JulianCastoro_files/figure-html/unnamed-chunk-44-1.png){width=672}\n:::\n:::\n\n\nIt looks like the event of 9/11 had a pretty significant impact on US\nspending. While initially it looks like spending just continues to rise\nwhen looking at the raw USD spending, it is refreshing to see the share\nof Gov spend has trended down in recent years as money is being spent\nelsewhere. Another interesting observation is that there was a slight\nupward trend in spending prior to the attack in 2001 however the\nspending increase was mostly reactionary.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus911Plot+\n  coord_cartesian((xlim=c(1990,2010)))\n```\n\n::: {.cell-output-display}\n![](Final-Project-_-JulianCastoro_files/figure-html/unnamed-chunk-45-1.png){width=672}\n:::\n:::\n\n\nTimeline 1998 - Bill Clinton warned bin laden preparing to higack US\naircraft\n\n1999 - Germany intercepts intel about plane crash\n\n2001 sept- Attack occurs oct-US attack on Afghanistan starts(end in\n2021)\n\nParties Involved\n  Al-Qaeda \n  - Saudi Arabia \n  - Kuwait\n\n## Covid Analysis\n\nLook at China, US, Russia, UK\n\n## Ukraine war analysis\n\n## Potential research questions\n\n1.  Global events which may have led to increases of spending. -9/11 and\n    ww1(1914-1918) and ww2(1939-1945) ww1 allies\n\n    -   France\n    -   Great britain\n    -   Russia\n    -   Italy\n    -   Japan\n    -   US(from 1917) Central Powers -Germany\n    -   Austria-Hungary\n    -   Turkey ww2 Alot of allies(listing main for now)\n    -   US\n    -   \n\n    5 years before and after snapshot of those involved heavily\n\n2.  Grouped view of allies\n\n3.  Grouped view of regions\n\n4.  Which countries are steady vs decrease/increase\n\n5.  Could overlay US per capita spending with public opinion of military\n\n6.  Share of govt spending\n\n## planned vizualizations\n\nNumber correlates to above 1. group by continent and those involved\nchart displays spending in USD - scatter\nhttps://r-graph-gallery.com/271-ggplot2-animated-gif-chart-with-gganimate.html -\nhttps://r-graph-gallery.com/interactive-charts.html\n\nFirst viz:\nhttps://r-graph-gallery.com/271-ggplot2-animated-gif-chart-with-gganimate.html\n\nanimated bubble chart Split by region - Y axis raw USD spending - x axis\nshare of gov spending - time will be what changes\n\nHave sections for the following events ww1 ww2 9/11 Covid19 Ukrain\ninvasion\n\nSections to include: Continent based spending - scatter plot - Xaxis: 5\nyears before and after event - Yaxis: spending in USD - Covid19:\nspending as share of gov spend - points:Nations if not too noisy,\ncolored by region ( could also just sum by region)\n\nvertical lines on years for key events\n\nexploratory chart would be cool, with buttons for key events and it\nshows a 5 year spread.\n\nMap of world, could somehow select an event, event location would be\ndisplayed as well as spending in the rest of the world. - could show if\nproximity to event would affect spending habits.\n\n## Conclusion\n\n> \"Every gun that is made, every warship launched, every rocket fired\n> signifies in the final sense, a theft from those who hunger and are\n> not fed, those who are cold and are not clothed. \\> \\> This world in\n> arms is not spending money alone. It is spending the sweat of its\n> laborers, the genius of its scientists, the hopes of its children.\n> This is not a way of life at all in any \\> true sense. Under the\n> clouds of war, it is humanity hanging on a cross of iron.\"\n\nDwight D. Eisenhower\n\nCitations:\n[1]\nhttps://www.goodreads.com/quotes/tag/military-budget#:\\~:text=%E2%80%9CEvery%20gun%20that%20is%20made,is%20not%20spending%20money%20alone.\n\n[2]\nhttps://www.sipri.org/about\n\n[3]\nR Core Team (2017). R: A language and environment for statistical\ncomputing. R Foundation for Statistical Computing, Vienna, Austria. URL\nhttps://www.R-project.org/.\n\n[4]\nWickham, H., & Grolemund, G. (2016). R for data science: Visualize,\nmodel, transform, tidy, and import data. OReilly Media.\n\n[5]\nTambudzai, Z. (2011). Determinants of military expenditure in Zimbabwe. The Economics of Peace and Security Journal, 6(2). doi:http://dx.doi.org/10.15355/epsj.6.2.41\n\n[6]\nhttps://www.investopedia.com/terms/g/gdp.asp\n\nAppendix: Full descriptions as provided by SIPRI:\n\n1.  Introduction\n2.  Estimates of world, regional and sub-regional totals in\n    constant (2019) US\\$ (billions).\n3.  Data for military expenditure by country in current price local\n    currency, presented according to each country's financial year.\n4.  Data for military expenditure by country in current price local\n    currency, presented according to calendar year.\n5.  Data for military expenditure by country in constant price (2019)\n    US\\$ (millions), presented according to calendar year, and in\n    current US\\$m. for 2020.\n6.  Data for military expenditure by country in current US\\$ (millions),\n    presented according to calendar year.\n7.  Data for military expenditure by country as a share of GDP,\n    presented according to calendar year.\n8.  Data for military expenditure per capita, in current US\\$, presented\n    according to calender year. (1988-2020 only)\n9.  Data for military expenditure as a percentage of general government\n    expenditure. (1988-2020 only)\n\nAnimations\n\n::: {.cell}\n\n```{.r .cell-code}\n# animationWIP<-combinedData%>%\n#   group_by(Country,viewOfSpend,Year)%>%\n#   pivot_wider(names_from = viewOfSpend,values_from = Spend)\n# \n# \n# ggplot(animationWIP, aes(x=`Year`,y=`MilitarySpend_currentUSD`, color = Country,size= MilitarySpend_ShareofGDP))+\n#   geom_point(alpha = 0.6,)+\n#   scale_radius(limits = c(0, NA), range = c(2, 12)) +\n#   facet_wrap(vars(Region),scales = \"free_y\")+\n#   labs(title = 'Year: {frame_time}', x = 'Share of Gov Spend', y= 'raw USD')+\n#   theme(legend.position = \"none\")\n# \n# myAnimation<- ggplot(animationWIP, aes(x=`Year`,y=`MilitarySpend_currentUSD`, color = Country,size= MilitarySpend_ShareofGDP))+\n#   geom_point(alpha = 0.6,)+\n#   scale_radius(limits = c(0, NA), range = c(2, 12)) +\n#   facet_wrap(vars(Region),scales = \"free_y\")+\n#   labs(title = 'Year: {frame_time}', x = 'Year', y= 'raw USD')+\n#   theme(legend.position = \"none\")+\n#   transition_time(`Year`)+\n#   ease_aes('linear')\n# \n# animate(myAnimation,duration = 15,fps = 20,width=600,height = 600, renderer = gifski_renderer())\n# anim_save(\"GovSpend_VS_RawUSD.gif\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# world_map<-map_data(\"world\")%>%\n#   filter(! long>180)\n#   \n# gsub(\"USA\",\"United states of America\",world_map)\n# \n# view(world_map)\n# \n# dataForMap<- combinedData %>%\n#   filter(viewOfSpend == \"MilitarySpend_currentUSD\")%>%\n#   rename(region=Country)\n# view(dataForMap)\n# \n# worldMapCountries<-world_map%>%\n#   distinct(region)\n# \n# mapAnimationData<-left_join(world_map,dataForMap)%>%\n#   filter(viewOfSpend==\"MilitarySpend_currentUSD\")\n# \n# \n# test<-mapAnimationData%>%\n#   group_by(long,lat,region)%>%\n#   summarize(mean = mean(Spend, na.rm=TRUE))\n# \n# \n# test%>%\n#   ggplot(aes(fill=mean, map_id=region))+\n#   geom_map(map=world_map)\n# \n# \n# test %>% \n#   ggplot(aes(map_id = region,fill=mean)) +\n#   geom_map(map = world_map) +\n#   expand_limits(x = world_map$long, y = world_map$lat)\n```\n:::\n",
    "supporting": [
      "Final-Project-_-JulianCastoro_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}