{
  "hash": "d8b81d7abcbdb06214c1357c38d90d67",
  "result": {
    "markdown": "---\ntitle: \"Global Military Spending - An Analysis\"\ndescription: \"WIP Final Project\"\nauthor: \"Julian Castoro\"\ndate: \"2022-11-29\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\noutput: distill::distill_article\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(ggplot2)\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(purrr)\nlibrary(lubridate)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Introduction\n### Data choice overview\nI initially chose this data set because recent events abroad have certainly escalated a global fear of war and I wanted to see how the tides of military spending ebbed and flowed \nover the course of recent history. The more I cleaned the data and played around with visualizations, the more questions I had. I am excited to see what sort of trends come from analyzing this data set. \n\nI plan to show how different countries and regions value military spending and how that value changes over the course of time. Ideally I will be able to explain patterns in what I see with global or locally important historic events. How did the US spending change after 9/11 or more recently did we see anyone bolstering their defenses before news broke of the Russian invasion of Ukraine? How did spending change globally after the first and then second world war? While I am not a statistical expert and will not be able to refute a causation vs correlation argument, visualizations of these events and the corresponding spending patterns will still be interesting and hopefully provoking of conversation.\n\n\n\n\n\n\n\n\n## Data\n\n### Briefly describe the data\n\nBelow is a list of the available sheets in the SIPRI military spending data export. A few of the tabs are the same base information altered to reflect a specific currency or ratio. I am choosing to use the \"Current USD\" as my source of raw spending numbers as I believe it to be the easiest to understand and relate to. I will also be using \"share of GDP\" as well as \"Share of Govt. spending\" to provide context around a nations spending compared to their population they intend on defending as well as compared to overall spending. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsheets <- excel_sheets(\"_data/SIPRI-Milex-data-1949-2021.xlsx\")\nsheets\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Front page\"                     \"Regional totals\"               \n [3] \"Local currency financial years\" \"Local currency calendar years\" \n [5] \"Constant (2020) USD\"            \"Current USD\"                   \n [7] \"Share of GDP\"                   \"Per capita\"                    \n [9] \"Share of Govt. spending\"        \"Footnotes\"                     \n```\n:::\n:::\n\n\n### Where did this information come from?\n\nThe Military spending information I am analyzing comes from **SIPRI**, the **S**tockholm **I**nternational **P**eace **R**esearch **I**nstitute. SIPRI was established in 1966 for the purpose of \"research into conflict, armaments, arms control and disarmament\". The organization is funded by the Swedish government however it regularly works internationally with research centers around the globe. SIPRI collected this particular data set from the official reports of each of the included governments in the form of official publications such as public budgets.\n\n\n\nHere is a peek at what the raw information looks like.\n\n::: {.cell}\n\n```{.r .cell-code}\nrawrawData_ShareOfGovSpend <- read_excel(\"_data/SIPRI-Milex-data-1949-2021.xlsx\",sheet=sheets[9])\nhead(rawrawData_ShareOfGovSpend)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 37\n  Military e…¹ ...2  ...3  ...4  ...5  ...6  ...7  ...8  ...9  ...10 ...11 ...12\n  <chr>        <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr>\n1 \"Countries … <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n2 \"Figures ar… <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n3 \"Data for g… <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n4 \"Figures in… <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n5 \"\\\". .\\\" = … <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n6  <NA>        <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n# … with 25 more variables: ...13 <chr>, ...14 <chr>, ...15 <chr>, ...16 <chr>,\n#   ...17 <chr>, ...18 <chr>, ...19 <chr>, ...20 <chr>, ...21 <chr>,\n#   ...22 <chr>, ...23 <chr>, ...24 <chr>, ...25 <chr>, ...26 <chr>,\n#   ...27 <chr>, ...28 <chr>, ...29 <chr>, ...30 <chr>, ...31 <chr>,\n#   ...32 <chr>, ...33 <chr>, ...34 <chr>, ...35 <chr>, ...36 <chr>,\n#   ...37 <chr>, and abbreviated variable name\n#   ¹​`Military expenditure by country as percentage of government spending, 1949-2021         © SIPRI 2021`\n```\n:::\n:::\n\n\n\n### Reading in Raw information\n\nReading in raw information\n\nThe data provided by the Stockholm International Peace Research Institute(sipri) was separated into multiple tabs in one excel .xlsx file. \n\nIn order to begin working I imported the tabs I planned to utilize, skipping over some of the notes and title rows at the start of each tab.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrawData_CurrentUSD <- read_excel(\"_data/SIPRI-Milex-data-1949-2021.xlsx\",sheet=sheets[6],skip=5)\nrawData_ShareOfGDP <- read_excel(\"_data/SIPRI-Milex-data-1949-2021.xlsx\",sheet=sheets[7],skip=5)\nrawData_ShareOfGovSpend <- read_excel(\"_data/SIPRI-Milex-data-1949-2021.xlsx\",sheet=sheets[9],skip=7)\n\n\n\nhead(rawData_CurrentUSD)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 75\n  Country   Notes `1949` `1950` `1951` `1952` `1953` `1954` `1955` `1956` `1957`\n  <chr>     <chr> <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 <NA>      <NA>  <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n2 Africa    <NA>  <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n3 North Af… <NA>  <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n4 Algeria   §4    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n5 Libya     ‡§¶16 xxx    xxx    ...    ...    ...    ...    ...    ...    ...   \n6 Morocco   §17   xxx    xxx    xxx    xxx    xxx    xxx    xxx    23.71… 35.40…\n# … with 64 more variables: `1958` <chr>, `1959` <chr>, `1960` <chr>,\n#   `1961` <chr>, `1962` <chr>, `1963` <chr>, `1964` <chr>, `1965` <chr>,\n#   `1966` <chr>, `1967` <chr>, `1968` <chr>, `1969` <chr>, `1970` <chr>,\n#   `1971` <chr>, `1972` <chr>, `1973` <chr>, `1974` <chr>, `1975` <chr>,\n#   `1976` <chr>, `1977` <chr>, `1978` <chr>, `1979` <chr>, `1980` <chr>,\n#   `1981` <chr>, `1982` <chr>, `1983` <chr>, `1984` <chr>, `1985` <chr>,\n#   `1986` <chr>, `1987` <chr>, `1988` <chr>, `1989` <chr>, `1990` <chr>, …\n```\n:::\n\n```{.r .cell-code}\nhead(rawData_ShareOfGDP)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 75\n  Country   Notes `1949` `1950` `1951` `1952` `1953` `1954` `1955` `1956` `1957`\n  <chr>     <chr> <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 <NA>      <NA>  <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n2 Africa    <NA>  <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n3 North Af… <NA>  <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n4 Algeria   §4    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n5 Libya     ‡§¶16 xxx    xxx    ...    ...    ...    ...    ...    ...    ...   \n6 Morocco   §17   xxx    xxx    xxx    xxx    xxx    xxx    xxx    1.180… 1.759…\n# … with 64 more variables: `1958` <chr>, `1959` <chr>, `1960` <chr>,\n#   `1961` <chr>, `1962` <chr>, `1963` <chr>, `1964` <chr>, `1965` <chr>,\n#   `1966` <chr>, `1967` <chr>, `1968` <chr>, `1969` <chr>, `1970` <chr>,\n#   `1971` <chr>, `1972` <chr>, `1973` <chr>, `1974` <chr>, `1975` <chr>,\n#   `1976` <chr>, `1977` <chr>, `1978` <chr>, `1979` <chr>, `1980` <chr>,\n#   `1981` <chr>, `1982` <chr>, `1983` <chr>, `1984` <chr>, `1985` <chr>,\n#   `1986` <chr>, `1987` <chr>, `1988` <chr>, `1989` <chr>, `1990` <chr>, …\n```\n:::\n\n```{.r .cell-code}\nhead(rawData_ShareOfGovSpend)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 37\n  Country  Notes Repor…¹ `1988` `1989` `1990` `1991` `1992` `1993` `1994` `1995`\n  <chr>    <chr> <lgl>   <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 <NA>     <NA>  NA      <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n2 Africa   <NA>  NA      <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n3 North A… <NA>  NA      <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n4 Algeria  §4    NA      ...    ...    5.682… 4.356… 7.450… 7.634… 0.101… 9.989…\n5 Libya    ‡§¶16 NA      ...    ...    ...    ...    ...    ...    ...    ...   \n6 Morocco  §17   NA      ...    ...    0.145… 0.158… 0.151… 0.158… 0.162… 0.160…\n# … with 26 more variables: `1996` <chr>, `1997` <chr>, `1998` <chr>,\n#   `1999` <chr>, `2000` <chr>, `2001` <chr>, `2002` <chr>, `2003` <chr>,\n#   `2004` <chr>, `2005` <chr>, `2006` <chr>, `2007` <chr>, `2008` <chr>,\n#   `2009` <chr>, `2010` <chr>, `2011` <chr>, `2012` <chr>, `2013` <chr>,\n#   `2014` <chr>, `2015` <chr>, `2016` <chr>, `2017` <chr>, `2018` <chr>,\n#   `2019` <chr>, `2020` <chr>, `2021` <chr>, and abbreviated variable name\n#   ¹​`Reporting year`\n```\n:::\n:::\n\n\n\n\nNext I delete the first row of NA as well as the Notes column for each tibble.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## trying Purr here to be cleaner, we have not covered this yet so please let me know if this could be better.\n\n#tibleList <- lst(rawData_CurrentUSD, rawData_ShareOfGDP, rawData_ShareOfGovSpend)\n\n# could pur this with my func i bet\n\n## not working ^^\n\n\n\n\nrawData_CurrentUSD <- rawData_CurrentUSD[-1,]  %>%\n  select(-Notes)\n\n\nrawData_ShareOfGDP <- rawData_ShareOfGDP[-1,] %>%\n  select(-Notes)\n\n\nrawData_ShareOfGovSpend <- rawData_ShareOfGovSpend[-1,] %>%\n  select(-2:-3)\n\n\nhead(rawData_CurrentUSD)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 74\n  Country  `1949` `1950` `1951` `1952` `1953` `1954` `1955` `1956` `1957` `1958`\n  <chr>    <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 Africa   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n2 North A… <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n3 Algeria  xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n4 Libya    xxx    xxx    ...    ...    ...    ...    ...    ...    ...    ...   \n5 Morocco  xxx    xxx    xxx    xxx    xxx    xxx    xxx    23.71… 35.40… 41.69…\n6 Tunisia  xxx    xxx    xxx    xxx    xxx    xxx    xxx    3.714… 6.411… 9.523…\n# … with 63 more variables: `1959` <chr>, `1960` <chr>, `1961` <chr>,\n#   `1962` <chr>, `1963` <chr>, `1964` <chr>, `1965` <chr>, `1966` <chr>,\n#   `1967` <chr>, `1968` <chr>, `1969` <chr>, `1970` <chr>, `1971` <chr>,\n#   `1972` <chr>, `1973` <chr>, `1974` <chr>, `1975` <chr>, `1976` <chr>,\n#   `1977` <chr>, `1978` <chr>, `1979` <chr>, `1980` <chr>, `1981` <chr>,\n#   `1982` <chr>, `1983` <chr>, `1984` <chr>, `1985` <chr>, `1986` <chr>,\n#   `1987` <chr>, `1988` <chr>, `1989` <chr>, `1990` <chr>, `1991` <chr>, …\n```\n:::\n\n```{.r .cell-code}\nhead(rawData_ShareOfGDP)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 74\n  Country  `1949` `1950` `1951` `1952` `1953` `1954` `1955` `1956` `1957` `1958`\n  <chr>    <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 Africa   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n2 North A… <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n3 Algeria  xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n4 Libya    xxx    xxx    ...    ...    ...    ...    ...    ...    ...    ...   \n5 Morocco  xxx    xxx    xxx    xxx    xxx    xxx    xxx    1.180… 1.759… 2.141…\n6 Tunisia  xxx    xxx    xxx    xxx    xxx    xxx    xxx    ...    ...    ...   \n# … with 63 more variables: `1959` <chr>, `1960` <chr>, `1961` <chr>,\n#   `1962` <chr>, `1963` <chr>, `1964` <chr>, `1965` <chr>, `1966` <chr>,\n#   `1967` <chr>, `1968` <chr>, `1969` <chr>, `1970` <chr>, `1971` <chr>,\n#   `1972` <chr>, `1973` <chr>, `1974` <chr>, `1975` <chr>, `1976` <chr>,\n#   `1977` <chr>, `1978` <chr>, `1979` <chr>, `1980` <chr>, `1981` <chr>,\n#   `1982` <chr>, `1983` <chr>, `1984` <chr>, `1985` <chr>, `1986` <chr>,\n#   `1987` <chr>, `1988` <chr>, `1989` <chr>, `1990` <chr>, `1991` <chr>, …\n```\n:::\n\n```{.r .cell-code}\nhead(rawData_ShareOfGovSpend)  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 35\n  Country  `1988` `1989` `1990` `1991` `1992` `1993` `1994` `1995` `1996` `1997`\n  <chr>    <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 Africa   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n2 North A… <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n3 Algeria  ...    ...    5.682… 4.356… 7.450… 7.634… 0.101… 9.989… 0.109… 0.119…\n4 Libya    ...    ...    ...    ...    ...    ...    ...    ...    ...    0.116…\n5 Morocco  ...    ...    0.145… 0.158… 0.151… 0.158… 0.162… 0.160… 0.176… 0.177…\n6 Tunisia  ...    ...    ...    6.326… 6.329… 6.191… 6.401… 6.258… 6.674… 6.709…\n# … with 24 more variables: `1998` <chr>, `1999` <chr>, `2000` <chr>,\n#   `2001` <chr>, `2002` <chr>, `2003` <chr>, `2004` <chr>, `2005` <chr>,\n#   `2006` <chr>, `2007` <chr>, `2008` <chr>, `2009` <chr>, `2010` <chr>,\n#   `2011` <chr>, `2012` <chr>, `2013` <chr>, `2014` <chr>, `2015` <chr>,\n#   `2016` <chr>, `2017` <chr>, `2018` <chr>, `2019` <chr>, `2020` <chr>,\n#   `2021` <chr>\n```\n:::\n:::\n\n\n### Tidying Data\n\nBefore pivoting my data I wanted to add a column for region. I chose to do this with an algorithm as an exercise in iteration however it would have been more practical to just hard code this column.\n\n#### Before Pivoting I am adding a column for region\n\n\nThe list of countries where there are NA's for every year:\n\n::: {.cell}\n\n```{.r .cell-code}\nRegions <- rawData_CurrentUSD %>%\n  filter(is.na(`1949`))%>%\n  select(Country)\n\nRegions\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 18 × 1\n   Country                          \n   <chr>                            \n 1 Africa                           \n 2 North Africa                     \n 3 sub-Saharan Africa               \n 4 Americas                         \n 5 Central America and the Caribbean\n 6 North America                    \n 7 South America                    \n 8 Asia & Oceania                   \n 9 Oceania                          \n10 South Asia                       \n11 East Asia                        \n12 South East Asia                  \n13 Central Asia                     \n14 Europe                           \n15 Central Europe                   \n16 Eastern Europe                   \n17 Western Europe                   \n18 Middle East                      \n```\n:::\n:::\n\nYou will notice that some of these are continents and sub-continents, I wanted to break these into a `Region` field. The pattern I saw and chose to exploit was the fact that the overarching category would always be followed with a more specific category such as the **Africa** followed by **North Africa** values (see earlier print outs to see raw information). \n\nI then added an empty vector into the tibble and populated it according to the Country column using the pattern described above.\n\nOnce I had left flags in the region column dictating where each region was starting I could use `fill(Region)` in order to populate the rest of the column.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemptyRegionCol <- as.numeric(vector(mode = \"character\",length = length(rawData_CurrentUSD$`1949`)))## doing as numeric here as a hacky way to fill this with NA's, any better way?\n\n\n#adding col to tibble to be populated later\nmutated_CurrentUSD <- rawData_CurrentUSD %>%\n  mutate(Region =emptyRegionCol,.before=2)\n\n#mutated_CurrentUSD\n#head(mutated_CurrentUSD)\n\n\n\n# replacing the empty char in region with actual region if 2 NAs appear in a row\n  #iterates along the indices of the Country vector\nfor(i in seq_along(mutated_CurrentUSD$Country) ){\n  \n   #if 2 nas in a row then do something\n  if(is.na(mutated_CurrentUSD$`1949`[i]) && is.na(mutated_CurrentUSD$`1949`[i+1]) ){\n    mutated_CurrentUSD$Region[i+1] <- mutated_CurrentUSD$Country[i+1] #this works because when referencing an index outside of the vector R will return NA - Great to know.\n  }\n  \n  \n  #if the row is a region\n  if(is.na(mutated_CurrentUSD$`1949`[i]) ){\n     mutated_CurrentUSD$Region[i+1] <- mutated_CurrentUSD$Country[i]\n  }\n\n  \n}\n\nmutated_CurrentUSD <- mutated_CurrentUSD %>%\n  fill(Region)\n\nmutated_CurrentUSD \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 191 × 75\n   Country Region `1949` `1950` `1951` `1952` `1953` `1954` `1955` `1956` `1957`\n   <chr>   <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n 1 Africa  <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n 2 North … Africa <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n 3 Algeria North… xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n 4 Libya   North… xxx    xxx    ...    ...    ...    ...    ...    ...    ...   \n 5 Morocco North… xxx    xxx    xxx    xxx    xxx    xxx    xxx    23.71… 35.40…\n 6 Tunisia North… xxx    xxx    xxx    xxx    xxx    xxx    xxx    3.714… 6.411…\n 7 sub-Sa… North… <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n 8 Angola  sub-S… xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n 9 Benin   sub-S… xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n10 Botswa… sub-S… xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n# … with 181 more rows, and 64 more variables: `1958` <chr>, `1959` <chr>,\n#   `1960` <chr>, `1961` <chr>, `1962` <chr>, `1963` <chr>, `1964` <chr>,\n#   `1965` <chr>, `1966` <chr>, `1967` <chr>, `1968` <chr>, `1969` <chr>,\n#   `1970` <chr>, `1971` <chr>, `1972` <chr>, `1973` <chr>, `1974` <chr>,\n#   `1975` <chr>, `1976` <chr>, `1977` <chr>, `1978` <chr>, `1979` <chr>,\n#   `1980` <chr>, `1981` <chr>, `1982` <chr>, `1983` <chr>, `1984` <chr>,\n#   `1985` <chr>, `1986` <chr>, `1987` <chr>, `1988` <chr>, `1989` <chr>, …\n```\n:::\n:::\n\n\n\nNow that I had my proof of concept for cleaning one of the sheets, in a format I wanted, it was time to clean the other sheets as well. I could have taken the above algorithm and modified it to work for each of the other tabs individually however I took the opportunity to practice with functions and created the below function to clean any of the tabs once they were loaded in and lightly cleaned.\n\n\n# Clean and format function\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## creating a function to clean the other sheets\n##Input: a partially cleaned tibble, must have been read in and had excess rows trimmed\n##output: tibble with regions correctly labeled and umbrella region categories i.e Africa above south Africa removed\n##Note: All sub categories contained the main category name in them, will use regex to create groupings in the future.\n\nCleanData <- function(inSheet){\n  emptyRegionCol <- as.numeric(vector(mode = \"character\",length = nrow(select(inSheet,2))))\n\n#adding col to tibble to be populated later\n  output <- inSheet %>%\n    mutate(Region = emptyRegionCol,.before=2)\n\n\n# replacing the empty char in region with actual region if 2 NAs appear in a row\n #iterates along the indices of the Country vector\n  for(i in seq_along(output$Country)){\n  \n    if(is.na(output[[i,3]]) && is.na(output[[(i+1),3]]))\n      output$Region[i+1] <- output$Country[i+1]\n    \n    if(is.na(output[[i,3]]))\n       output$Region[i+1] <- output$Country[i]\n  }\n  \n  output <- output %>%\n    fill(Region)\n  \n  \n  # removing header rows\n  output <- output %>%\n    filter(!is.na(output[[3]]))\n}\n```\n:::\n\n\nBelow I call the function on each of the tibbles loaded in earlier.\n\nBefore:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(rawData_CurrentUSD)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 74\n  Country  `1949` `1950` `1951` `1952` `1953` `1954` `1955` `1956` `1957` `1958`\n  <chr>    <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 Africa   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n2 North A… <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n3 Algeria  xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n4 Libya    xxx    xxx    ...    ...    ...    ...    ...    ...    ...    ...   \n5 Morocco  xxx    xxx    xxx    xxx    xxx    xxx    xxx    23.71… 35.40… 41.69…\n6 Tunisia  xxx    xxx    xxx    xxx    xxx    xxx    xxx    3.714… 6.411… 9.523…\n# … with 63 more variables: `1959` <chr>, `1960` <chr>, `1961` <chr>,\n#   `1962` <chr>, `1963` <chr>, `1964` <chr>, `1965` <chr>, `1966` <chr>,\n#   `1967` <chr>, `1968` <chr>, `1969` <chr>, `1970` <chr>, `1971` <chr>,\n#   `1972` <chr>, `1973` <chr>, `1974` <chr>, `1975` <chr>, `1976` <chr>,\n#   `1977` <chr>, `1978` <chr>, `1979` <chr>, `1980` <chr>, `1981` <chr>,\n#   `1982` <chr>, `1983` <chr>, `1984` <chr>, `1985` <chr>, `1986` <chr>,\n#   `1987` <chr>, `1988` <chr>, `1989` <chr>, `1990` <chr>, `1991` <chr>, …\n```\n:::\n\n```{.r .cell-code}\nhead(rawData_ShareOfGDP)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 74\n  Country  `1949` `1950` `1951` `1952` `1953` `1954` `1955` `1956` `1957` `1958`\n  <chr>    <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 Africa   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n2 North A… <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n3 Algeria  xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n4 Libya    xxx    xxx    ...    ...    ...    ...    ...    ...    ...    ...   \n5 Morocco  xxx    xxx    xxx    xxx    xxx    xxx    xxx    1.180… 1.759… 2.141…\n6 Tunisia  xxx    xxx    xxx    xxx    xxx    xxx    xxx    ...    ...    ...   \n# … with 63 more variables: `1959` <chr>, `1960` <chr>, `1961` <chr>,\n#   `1962` <chr>, `1963` <chr>, `1964` <chr>, `1965` <chr>, `1966` <chr>,\n#   `1967` <chr>, `1968` <chr>, `1969` <chr>, `1970` <chr>, `1971` <chr>,\n#   `1972` <chr>, `1973` <chr>, `1974` <chr>, `1975` <chr>, `1976` <chr>,\n#   `1977` <chr>, `1978` <chr>, `1979` <chr>, `1980` <chr>, `1981` <chr>,\n#   `1982` <chr>, `1983` <chr>, `1984` <chr>, `1985` <chr>, `1986` <chr>,\n#   `1987` <chr>, `1988` <chr>, `1989` <chr>, `1990` <chr>, `1991` <chr>, …\n```\n:::\n\n```{.r .cell-code}\nhead(rawData_ShareOfGovSpend)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 35\n  Country  `1988` `1989` `1990` `1991` `1992` `1993` `1994` `1995` `1996` `1997`\n  <chr>    <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 Africa   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n2 North A… <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  \n3 Algeria  ...    ...    5.682… 4.356… 7.450… 7.634… 0.101… 9.989… 0.109… 0.119…\n4 Libya    ...    ...    ...    ...    ...    ...    ...    ...    ...    0.116…\n5 Morocco  ...    ...    0.145… 0.158… 0.151… 0.158… 0.162… 0.160… 0.176… 0.177…\n6 Tunisia  ...    ...    ...    6.326… 6.329… 6.191… 6.401… 6.258… 6.674… 6.709…\n# … with 24 more variables: `1998` <chr>, `1999` <chr>, `2000` <chr>,\n#   `2001` <chr>, `2002` <chr>, `2003` <chr>, `2004` <chr>, `2005` <chr>,\n#   `2006` <chr>, `2007` <chr>, `2008` <chr>, `2009` <chr>, `2010` <chr>,\n#   `2011` <chr>, `2012` <chr>, `2013` <chr>, `2014` <chr>, `2015` <chr>,\n#   `2016` <chr>, `2017` <chr>, `2018` <chr>, `2019` <chr>, `2020` <chr>,\n#   `2021` <chr>\n```\n:::\n:::\n\n\nAfter:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCleaned_currentUSD <- CleanData(rawData_CurrentUSD)\nCleaned_ShareOfGovSpend <- CleanData(rawData_ShareOfGovSpend)\nCleaned_ShareOfGDP <- CleanData(rawData_ShareOfGDP)\n\nhead(Cleaned_currentUSD)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 75\n  Country Region  `1949` `1950` `1951` `1952` `1953` `1954` `1955` `1956` `1957`\n  <chr>   <chr>   <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 Algeria North … xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n2 Libya   North … xxx    xxx    ...    ...    ...    ...    ...    ...    ...   \n3 Morocco North … xxx    xxx    xxx    xxx    xxx    xxx    xxx    23.71… 35.40…\n4 Tunisia North … xxx    xxx    xxx    xxx    xxx    xxx    xxx    3.714… 6.411…\n5 Angola  sub-Sa… xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n6 Benin   sub-Sa… xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n# … with 64 more variables: `1958` <chr>, `1959` <chr>, `1960` <chr>,\n#   `1961` <chr>, `1962` <chr>, `1963` <chr>, `1964` <chr>, `1965` <chr>,\n#   `1966` <chr>, `1967` <chr>, `1968` <chr>, `1969` <chr>, `1970` <chr>,\n#   `1971` <chr>, `1972` <chr>, `1973` <chr>, `1974` <chr>, `1975` <chr>,\n#   `1976` <chr>, `1977` <chr>, `1978` <chr>, `1979` <chr>, `1980` <chr>,\n#   `1981` <chr>, `1982` <chr>, `1983` <chr>, `1984` <chr>, `1985` <chr>,\n#   `1986` <chr>, `1987` <chr>, `1988` <chr>, `1989` <chr>, `1990` <chr>, …\n```\n:::\n\n```{.r .cell-code}\nhead(Cleaned_ShareOfGovSpend)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 36\n  Country Region  `1988` `1989` `1990` `1991` `1992` `1993` `1994` `1995` `1996`\n  <chr>   <chr>   <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 Algeria North … ...    ...    5.682… 4.356… 7.450… 7.634… 0.101… 9.989… 0.109…\n2 Libya   North … ...    ...    ...    ...    ...    ...    ...    ...    ...   \n3 Morocco North … ...    ...    0.145… 0.158… 0.151… 0.158… 0.162… 0.160… 0.176…\n4 Tunisia North … ...    ...    ...    6.326… 6.329… 6.191… 6.401… 6.258… 6.674…\n5 Angola  sub-Sa… ...    ...    ...    ...    ...    ...    ...    ...    6.032…\n6 Benin   sub-Sa… ...    0.104… 9.239… ...    ...    ...    ...    ...    ...   \n# … with 25 more variables: `1997` <chr>, `1998` <chr>, `1999` <chr>,\n#   `2000` <chr>, `2001` <chr>, `2002` <chr>, `2003` <chr>, `2004` <chr>,\n#   `2005` <chr>, `2006` <chr>, `2007` <chr>, `2008` <chr>, `2009` <chr>,\n#   `2010` <chr>, `2011` <chr>, `2012` <chr>, `2013` <chr>, `2014` <chr>,\n#   `2015` <chr>, `2016` <chr>, `2017` <chr>, `2018` <chr>, `2019` <chr>,\n#   `2020` <chr>, `2021` <chr>\n```\n:::\n\n```{.r .cell-code}\nhead(Cleaned_ShareOfGDP)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 75\n  Country Region  `1949` `1950` `1951` `1952` `1953` `1954` `1955` `1956` `1957`\n  <chr>   <chr>   <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> \n1 Algeria North … xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n2 Libya   North … xxx    xxx    ...    ...    ...    ...    ...    ...    ...   \n3 Morocco North … xxx    xxx    xxx    xxx    xxx    xxx    xxx    1.180… 1.759…\n4 Tunisia North … xxx    xxx    xxx    xxx    xxx    xxx    xxx    ...    ...   \n5 Angola  sub-Sa… xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n6 Benin   sub-Sa… xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx    xxx   \n# … with 64 more variables: `1958` <chr>, `1959` <chr>, `1960` <chr>,\n#   `1961` <chr>, `1962` <chr>, `1963` <chr>, `1964` <chr>, `1965` <chr>,\n#   `1966` <chr>, `1967` <chr>, `1968` <chr>, `1969` <chr>, `1970` <chr>,\n#   `1971` <chr>, `1972` <chr>, `1973` <chr>, `1974` <chr>, `1975` <chr>,\n#   `1976` <chr>, `1977` <chr>, `1978` <chr>, `1979` <chr>, `1980` <chr>,\n#   `1981` <chr>, `1982` <chr>, `1983` <chr>, `1984` <chr>, `1985` <chr>,\n#   `1986` <chr>, `1987` <chr>, `1988` <chr>, `1989` <chr>, `1990` <chr>, …\n```\n:::\n:::\n\n\n## Pivoting years and \nNext I pivot the years, it should be noted that both the pivoting and Converting of notation could be handled by the clean function above, i kept the steps separate so that I could show the progression of the dataframe.\n\n\nI must also handle the xxx and ... notations. From the information page of my data set I can see that the notation is described as follows:\n\nRaw Notation  | Meaning\n------------- | -------------\n...  | Data unavailable\nxxx  |  Country did not exist or was not independent during all or part of the year in question\n\n\nFor now I think I will just keep both as NA but will save this form of the information for future use.\n\nAfter pivot and notation changes:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCleaned_currentUSD <- Cleaned_currentUSD %>%\n  pivot_longer(cols=3:ncol(Cleaned_currentUSD),names_to = \"Year\",values_drop_na = FALSE)%>%\n    na_if(\"...\") %>%\n      na_if(\"xxx\")\n  \nCleaned_ShareOfGovSpend <- Cleaned_ShareOfGovSpend %>%\n  pivot_longer(cols=3:ncol(Cleaned_ShareOfGovSpend),names_to = \"Year\",values_drop_na = FALSE)%>%\n    na_if(\"...\") %>%\n      na_if(\"xxx\")\n\nCleaned_ShareOfGDP <- Cleaned_ShareOfGDP %>%\n  pivot_longer(cols=3:ncol(Cleaned_ShareOfGDP),names_to = \"Year\",values_drop_na = FALSE)%>%\n    na_if(\"...\") %>%\n      na_if(\"xxx\")\n\n\nhead(Cleaned_currentUSD)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  Country Region       Year  value\n  <chr>   <chr>        <chr> <chr>\n1 Algeria North Africa 1949  <NA> \n2 Algeria North Africa 1950  <NA> \n3 Algeria North Africa 1951  <NA> \n4 Algeria North Africa 1952  <NA> \n5 Algeria North Africa 1953  <NA> \n6 Algeria North Africa 1954  <NA> \n```\n:::\n\n```{.r .cell-code}\nhead(Cleaned_ShareOfGovSpend)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  Country Region       Year  value                \n  <chr>   <chr>        <chr> <chr>                \n1 Algeria North Africa 1988  <NA>                 \n2 Algeria North Africa 1989  <NA>                 \n3 Algeria North Africa 1990  5.6826154062017679E-2\n4 Algeria North Africa 1991  4.3562992947460667E-2\n5 Algeria North Africa 1992  7.450020082662831E-2 \n6 Algeria North Africa 1993  7.6341156103707189E-2\n```\n:::\n\n```{.r .cell-code}\nhead(Cleaned_ShareOfGDP)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  Country Region       Year  value\n  <chr>   <chr>        <chr> <chr>\n1 Algeria North Africa 1949  <NA> \n2 Algeria North Africa 1950  <NA> \n3 Algeria North Africa 1951  <NA> \n4 Algeria North Africa 1952  <NA> \n5 Algeria North Africa 1953  <NA> \n6 Algeria North Africa 1954  <NA> \n```\n:::\n:::\n\n\n\n\n### Converting column types\nFinally I will convert the column types to their correct representation.\n\nBefore:\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(Cleaned_currentUSD)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  Country Region       Year  value\n  <chr>   <chr>        <chr> <chr>\n1 Algeria North Africa 1949  <NA> \n2 Algeria North Africa 1950  <NA> \n3 Algeria North Africa 1951  <NA> \n4 Algeria North Africa 1952  <NA> \n5 Algeria North Africa 1953  <NA> \n6 Algeria North Africa 1954  <NA> \n```\n:::\n\n```{.r .cell-code}\nhead(Cleaned_ShareOfGovSpend)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  Country Region       Year  value                \n  <chr>   <chr>        <chr> <chr>                \n1 Algeria North Africa 1988  <NA>                 \n2 Algeria North Africa 1989  <NA>                 \n3 Algeria North Africa 1990  5.6826154062017679E-2\n4 Algeria North Africa 1991  4.3562992947460667E-2\n5 Algeria North Africa 1992  7.450020082662831E-2 \n6 Algeria North Africa 1993  7.6341156103707189E-2\n```\n:::\n\n```{.r .cell-code}\nhead(Cleaned_ShareOfGDP)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  Country Region       Year  value\n  <chr>   <chr>        <chr> <chr>\n1 Algeria North Africa 1949  <NA> \n2 Algeria North Africa 1950  <NA> \n3 Algeria North Africa 1951  <NA> \n4 Algeria North Africa 1952  <NA> \n5 Algeria North Africa 1953  <NA> \n6 Algeria North Africa 1954  <NA> \n```\n:::\n\n```{.r .cell-code}\n# Year to date\nCleaned_currentUSD$Year<-as_date(Cleaned_currentUSD$Year, format = \"%Y\",tz=NULL)\nCleaned_ShareOfGovSpend$Year<-as_date(Cleaned_ShareOfGovSpend$Year, format = \"%Y\",tz=NULL)\nCleaned_ShareOfGDP$Year<-as_date(Cleaned_ShareOfGDP$Year, format = \"%Y\",tz=NULL)\n\n\n\n\n\n# value to double\nCleaned_currentUSD$value <- as.numeric(Cleaned_currentUSD$value)\nCleaned_ShareOfGovSpend$value<- as.numeric(Cleaned_ShareOfGovSpend$value)\nCleaned_ShareOfGDP$value<- as.numeric(Cleaned_ShareOfGDP$value)\n```\n:::\n\nAfter:\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(Cleaned_currentUSD)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  Country Region       Year       value\n  <chr>   <chr>        <date>     <dbl>\n1 Algeria North Africa 1949-11-29    NA\n2 Algeria North Africa 1950-11-29    NA\n3 Algeria North Africa 1951-11-29    NA\n4 Algeria North Africa 1952-11-29    NA\n5 Algeria North Africa 1953-11-29    NA\n6 Algeria North Africa 1954-11-29    NA\n```\n:::\n\n```{.r .cell-code}\nhead(Cleaned_ShareOfGovSpend)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  Country Region       Year         value\n  <chr>   <chr>        <date>       <dbl>\n1 Algeria North Africa 1988-11-29 NA     \n2 Algeria North Africa 1989-11-29 NA     \n3 Algeria North Africa 1990-11-29  0.0568\n4 Algeria North Africa 1991-11-29  0.0436\n5 Algeria North Africa 1992-11-29  0.0745\n6 Algeria North Africa 1993-11-29  0.0763\n```\n:::\n\n```{.r .cell-code}\nhead(Cleaned_ShareOfGDP)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  Country Region       Year       value\n  <chr>   <chr>        <date>     <dbl>\n1 Algeria North Africa 1949-11-29    NA\n2 Algeria North Africa 1950-11-29    NA\n3 Algeria North Africa 1951-11-29    NA\n4 Algeria North Africa 1952-11-29    NA\n5 Algeria North Africa 1953-11-29    NA\n6 Algeria North Africa 1954-11-29    NA\n```\n:::\n:::\n\n\n\n\n## Potential research questions\n\n\n1. Global events which may have led to increases of spending.\n  -9/11 and ww1 and ww2 \n    5 years before and after snapshot of those involved heavily\n  \n2. Grouped view of allies\n3. Grouped view of regions\n4. Which countries are steady vs decrease/increase\n5. Could overlay US per capita spending with public opinion of military\n6. Share of govt spending \n\n## planned vizualizations\nNumber correlates to above\n1. group by continent and those involved\nchart displays spending in USD\n- scatter\nhttps://r-graph-gallery.com/271-ggplot2-animated-gif-chart-with-gganimate.html\n- https://r-graph-gallery.com/interactive-charts.html\n\nvertical lines on years for key events\n\n\nexploratory chart would be cool, with buttons for key events and it shows a 5 year spread.\n\n\n## Conclusion\n> “Every gun that is made, every warship launched, every rocket fired signifies in the final sense, a theft from those who hunger and are not fed, those who are cold and are not clothed. > > This world in arms is not spending money alone. It is spending the sweat of its laborers, the genius of its scientists, the hopes of its children. This is not a way of life at all in any > true sense. Under the clouds of war, it is humanity hanging on a cross of iron.”\n\nDwight D. Eisenhower\n\n\n\nCitations:\nhttps://www.goodreads.com/quotes/tag/military-budget#:~:text=%E2%80%9CEvery%20gun%20that%20is%20made,is%20not%20spending%20money%20alone.\n\nhttps://www.sipri.org/about\n\nR Core Team (2017). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.\n\nWickham, H., & Grolemund, G. (2016). R for data science: Visualize, model, transform, tidy, and import data. OReilly Media.\n\nAppendix:\nFull descriptions as provided by SIPRI:\n\n1. Introduction\n2. Estimates of world, regional and sub-regional totals in constant (2019) US$ (billions).\n3. Data for military expenditure by country in current price local currency, presented according to each country's financial year.\n4. Data for military expenditure by country in current price local currency, presented according to calendar year.\n5. Data for military expenditure by country in constant price (2019) US$ (millions), presented according to calendar year, and in current US$m. for 2020.\n6. Data for military expenditure by country in current US$ (millions), presented according to calendar year.\n7. Data for military expenditure by country as a share of GDP, presented according to calendar year.\n8. Data for military expenditure per capita, in current US$, presented according to calender year. (1988-2020 only)\n9. Data for military expenditure as a percentage of general government expenditure. (1988-2020 only)\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}