<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Owen Tibby">
<meta name="dcterms.date" content="2022-11-30">

<title>DACSS 601: Data Science Fundamentals - FALL 2022 - Homework 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<meta name="twitter:title" content="DACSS 601: Data Science Fundamentals - FALL 2022 - Homework 3">
<meta name="twitter:description" content="The emphasis in this homework is on exploratory data analysis using both graphics and statistics.">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <img src="../images/UMass White Wordmark Horiz.png" alt="">
    <span class="navbar-title">DACSS 601: Data Science Fundamentals - FALL 2022</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page">Fall 2022 Posts</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">Contributors</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss">DACSS</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DACSS/601_Fall_2022"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Homework 3</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Course information</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Syllabus.html" class="sidebar-item-text sidebar-link">Overview</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../instructional_team.html" class="sidebar-item-text sidebar-link">Instructional Team</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course_schedule.html" class="sidebar-item-text sidebar-link">Course Schedule</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Weekly materials</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Fall 2022 posts</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://dacss.github.io/601_Fall_2022_final_posts/" class="sidebar-item-text sidebar-link">final posts</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#instructions" id="toc-instructions" class="nav-link active" data-scroll-target="#instructions">Instructions</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#reading-in-the-data" id="toc-reading-in-the-data" class="nav-link" data-scroll-target="#reading-in-the-data">Reading in the Data</a></li>
  <li><a href="#brief-description-of-the-data" id="toc-brief-description-of-the-data" class="nav-link" data-scroll-target="#brief-description-of-the-data">Brief Description of the data</a></li>
  <li><a href="#narrative-about-the-data-set.." id="toc-narrative-about-the-data-set.." class="nav-link" data-scroll-target="#narrative-about-the-data-set..">Narrative about the data set..</a></li>
  <li><a href="#potential-research-questions" id="toc-potential-research-questions" class="nav-link" data-scroll-target="#potential-research-questions">Potential Research Questions</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Homework 3</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">HW3</div>
    <div class="quarto-category">Used Vehicle Data</div>
    <div class="quarto-category">Owen Tibby</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Owen Tibby </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 30, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vindecodr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in library(vindecodr): there is no package called 'vindecodr'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotrix)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sparklyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in library(sparklyr): there is no package called 'sparklyr'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="instructions" class="level2">
<h2 class="anchored" data-anchor-id="instructions">Instructions</h2>
<p>The emphasis in this homework is on exploratory data analysis using both graphics and statistics. You should build on your prior homework - incorporating any feedback and adjusting the code and text as needed. These homeworks are intended to be cumulative. Therefore, while it is fine to switch datasets, you will need to include all of the information from HW1 for your new (or old) dataset in this hw submission as well.</p>
<ul>
<li><p>Include descriptive statistics (e.g, mean, median, and standard deviation for numerical variables, and frequencies and/or mode for categorical variables</p></li>
<li><p>Include relevant visualizations using ggplot2 to complement these descriptive statistics. Be sure to use faceting, coloring, and titles as needed. Each visualization should be accompanied by descriptive text that highlights:</p></li>
<li><p>the variable(s) used</p></li>
<li><p>what questions might be answered with the visualizations</p></li>
<li><p>what conclusions you can draw</p></li>
<li><p>Use group_by() and summarise() to compute descriptive stats and/or visualizations for any relevant groupings. For example, if you were interested in how average income varies by state, you might compute mean income for all states combined, and then compare this to the range and distribution of mean income for each individual state in the US.</p></li>
<li><p>Identify limitations of your visualization, such as:</p></li>
<li><p>What questions are left unanswered with your visualizations</p></li>
<li><p>What about the visualizations may be unclear to a naive viewer</p></li>
<li><p>How could you&nbsp;improve the visualizations for the final project</p></li>
</ul>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
</section>
<section id="reading-in-the-data" class="level2">
<h2 class="anchored" data-anchor-id="reading-in-the-data">Reading in the Data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #RStudio Desktop</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"car_prices.csv"</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">mmr =</span> <span class="fu">col_number</span>(), <span class="at">year =</span> <span class="fu">col_character</span>(), <span class="at">sellingprice =</span> <span class="fu">col_number</span>(), <span class="at">...17 =</span> <span class="fu">col_skip</span>()))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Catalog.csv"</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">Brand =</span> <span class="fu">col_skip</span>(), <span class="at">ModelName =</span> <span class="fu">col_skip</span>()))  <span class="co">#, Trim = col_skip()))</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>exchange_rate <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"HistoricalPrices.xlsx"</span>, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"numeric"</span>, <span class="st">"text"</span>, <span class="st">"skip"</span>, <span class="st">"skip"</span>, <span class="st">"skip"</span>, <span class="st">"numeric"</span>))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # #RStudio Cloud</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  carprices &lt;-read_csv("/cloud/project/Final_project/car_prices.csv",</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#      col_types = cols(mmr = col_number(), year = col_character(), sellingprice = col_number(), ...17 = col_skip()))</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   ca_catalog &lt;- read_csv("/cloud/project/Final_project/Catalog.csv", col_types = cols(Brand = col_skip(), ModelName = col_skip()))  #, Trim = col_skip()))</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  exchange_rate &lt;- read_excel("/cloud/project/Final_project/HistoricalPrices.xlsx",  col_types = c("numeric", "text", "skip", "skip", "skip", "numeric"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="brief-description-of-the-data" class="level2">
<h2 class="anchored" data-anchor-id="brief-description-of-the-data">Brief Description of the data</h2>
<p>This data set contains historical used vehicle auction prices that took place between 1982 and 2015.</p>
<p>First, lets take a look at the variables in the data set.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(carprices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     year               make              model               trim          
 Length:558837      Length:558837      Length:558837      Length:558837     
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
     body           transmission           vin               state          
 Length:558837      Length:558837      Length:558837      Length:558837     
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
   condition        odometer         color             interior        
 Min.   :1.000   Min.   :     1   Length:558837      Length:558837     
 1st Qu.:2.700   1st Qu.: 28371   Class :character   Class :character  
 Median :3.600   Median : 52254   Mode  :character   Mode  :character  
 Mean   :3.425   Mean   : 68320                                        
 3rd Qu.:4.200   3rd Qu.: 99109                                        
 Max.   :5.000   Max.   :999999                                        
 NA's   :11820   NA's   :94                                            
    seller               mmr          sellingprice      saledate        
 Length:558837      Min.   :    25   Min.   :     1   Length:558837     
 Class :character   1st Qu.:  7100   1st Qu.:  6900   Class :character  
 Mode  :character   Median : 12250   Median : 12100   Mode  :character  
                    Mean   : 13769   Mean   : 13611                     
                    3rd Qu.: 18300   3rd Qu.: 18200                     
                    Max.   :182000   Max.   :230000                     
                    NA's   :26                                          </code></pre>
</div>
</div>
<p>## Cleaning the Data</p>
<p>I’ve noticed a few records belonging to Canadian provinces. “ab” is Alberta, “on” is Ontario, “qc” is Quebec &amp; “ns” represents Nova Scotia.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Observing the amount of NAs in our most important variables</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># carprices %&gt;% </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(model), is.na(make)) %&gt;% </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   dim()</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Justify dropping NAs... Why did i exclude it</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(make), <span class="sc">!</span><span class="fu">is.na</span>(model), <span class="sc">!</span><span class="fu">is.na</span>(odometer), <span class="sc">!</span><span class="fu">is.na</span>(mmr)) </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dfSummary(carprices)</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Observing all records for model year 2007 and newer</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">year</span><span class="st">`</span><span class="sc">&gt;</span> <span class="dv">2006</span>, sellingprice<span class="sc">&gt;</span><span class="dv">100</span>, condition<span class="sc">&gt;</span><span class="fl">2.41</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(carprices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 388155     16</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the consistency in the names of states and body types</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  carprices <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 38 × 1
   state
   &lt;chr&gt;
 1 ca   
 2 tx   
 3 pa   
 4 mn   
 5 az   
 6 tn   
 7 md   
 8 ne   
 9 oh   
10 fl   
# … with 28 more rows</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span>state <span class="ot">&lt;-</span> <span class="fu">toupper</span>(carprices<span class="sc">$</span>state)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(body) <span class="sc">%&gt;%</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span><span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 83 × 1
   body         
   &lt;chr&gt;        
 1 SUV          
 2 Sedan        
 3 Convertible  
 4 Wagon        
 5 Coupe        
 6 Crew Cab     
 7 G Coupe      
 8 G Sedan      
 9 Hatchback    
10 Elantra Coupe
# … with 73 more rows</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span>body <span class="ot">&lt;-</span> <span class="fu">toupper</span>(carprices<span class="sc">$</span>body)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I notice that there are 76 distinct values for body. I’ll explore and condense them into fewer categories in a new column called “Body_type” below</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the consistency in the names of Body types}</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(body) <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 43 × 1
   body         
   &lt;chr&gt;        
 1 SUV          
 2 SEDAN        
 3 CONVERTIBLE  
 4 WAGON        
 5 COUPE        
 6 CREW CAB     
 7 G COUPE      
 8 G SEDAN      
 9 HATCHBACK    
10 ELANTRA COUPE
# … with 33 more rows</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a Body Type column</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">Body_Type =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(body, <span class="st">"EDAN"</span>)<span class="sc">~</span> <span class="st">"Sedan"</span>, <span class="fu">str_detect</span>(body, <span class="st">"SUV"</span>) <span class="sc">~</span> <span class="st">"SUV"</span>, <span class="fu">str_detect</span>(body, <span class="st">"AB"</span>) <span class="sc">~</span> <span class="st">"Pickup"</span>, <span class="fu">str_detect</span>(body, <span class="st">"OUP"</span>)<span class="sc">~</span> <span class="st">"Coupe"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>, <span class="st">"VAN"</span>)<span class="sc">~</span> <span class="st">"Minivan"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"ONV"</span>)<span class="sc">~</span> <span class="st">"Convertible"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"AGO"</span>) <span class="sc">~</span> <span class="st">"Wagon"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"ATCH"</span>)<span class="sc">~</span> <span class="st">"Hatchback"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"CREW"</span>)<span class="sc">~</span> <span class="st">"Pickup"</span> ))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print(head(carprices))</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(carprices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
       n
   &lt;int&gt;
1 388155</code></pre>
</div>
</div>
<p>Next step is to link multiple files to get the MSRP from a historical catalog. We’ll need this in order to get AV/MSRP ratios.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a Key in the CDN catalog</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span>  ca_catalog <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">YearOfLaunch=</span> <span class="st">`</span><span class="at">Model Year</span><span class="st">`</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Catalog with MSRP in CAD</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span> ca_catalog <span class="sc">%&gt;%</span> </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(<span class="st">`</span><span class="at">Combined</span><span class="st">`</span>, <span class="st">`</span><span class="at">YearOfLaunch</span><span class="st">`</span>, <span class="st">`</span><span class="at">Segment</span><span class="st">`</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>( <span class="at">Trim_Count=</span><span class="fu">n</span>(), <span class="at">AVG_MSRP_CAD=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>, <span class="at">na.rm=</span> <span class="cn">TRUE</span>), <span class="at">MSRP_Range_CAD=</span> (<span class="fu">max</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>)<span class="sc">-</span> <span class="fu">min</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>)), <span class="at">StdDev_MSRP_CAD=</span> <span class="fu">sd</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">FALSE</span>), <span class="at">Error.MSRP_CAD=</span> <span class="fu">std.error</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">FALSE</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Joining the data to convert CAD MSRP to USD MSRP later</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span> <span class="fu">left_join</span>(ca_catalog, exchange_rate, <span class="fu">c</span>(<span class="st">"YearOfLaunch"</span><span class="ot">=</span> <span class="st">"Year"</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating US$ Catalog and Converting to MSRP from CAD to USD</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>us_catalog <span class="ot">&lt;-</span> ca_catalog <span class="sc">%&gt;%</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AVG_MSRP=</span> <span class="fu">round</span>((<span class="st">`</span><span class="at">AVG_MSRP_CAD</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span>), <span class="at">digits =</span> <span class="dv">0</span>), <span class="at">MSRP_Range=</span> <span class="st">`</span><span class="at">MSRP_Range_CAD</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span>, <span class="at">StdDev_MSRP=</span> <span class="st">`</span><span class="at">StdDev_MSRP_CAD</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span>, <span class="at">Error.MSRP=</span> <span class="st">`</span><span class="at">Error.MSRP_CAD</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span> )</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Finalizing US Catalog for Joining</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>us_catalog <span class="ot">&lt;-</span> us_catalog <span class="sc">%&gt;%</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(Combined, Segment, AVG_MSRP, MSRP_Range, Trim_Count, StdDev_MSRP, Error.MSRP) <span class="sc">%&gt;%</span> </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span> <span class="fu">round</span>((<span class="st">`</span><span class="at">Error.MSRP</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">AVG_MSRP</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">1</span>), <span class="st">`</span><span class="at">%MSRP_Range</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>((<span class="st">`</span><span class="at">MSRP_Range</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">AVG_MSRP</span><span class="st">`</span> <span class="sc">*</span><span class="dv">100</span>), <span class="at">digits=</span><span class="dv">1</span>))</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a common key to join carprices and us_catalog</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year2=</span>year, <span class="at">make2=</span>make, <span class="at">model2=</span>model)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span>  <span class="fu">unite</span>(<span class="st">`</span><span class="at">YMM</span><span class="st">`</span>, <span class="st">`</span><span class="at">year2</span><span class="st">`</span>, <span class="st">`</span><span class="at">make2</span><span class="st">`</span>, <span class="st">`</span><span class="at">model2</span><span class="st">`</span>, <span class="at">sep=</span><span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Joining Data with us_catalog</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># carprices &lt;- head(carprices) </span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">left_join</span>(carprices, us_catalog, <span class="fu">c</span>(<span class="st">"YMM"</span><span class="ot">=</span> <span class="st">"Combined"</span> )) </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#saving our raw records beofre filtering</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>raw_carprices <span class="ot">&lt;-</span> carprices</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtering out the keys that were not mapped (Run these false keys through a vin decoder to get exact matches)</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>false_keys <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(AVG_MSRP))</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing NAs in MSRP from main dataset</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(AVG_MSRP)) </span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co">#replace_na(carprices$StdDev_MSRP, 0)</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(carprices))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 26
  year  make  model    trim      body  trans…¹ vin   state condi…² odome…³ color
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;
1 2015  Kia   Sorento  LX        SUV   automa… 5xyk… CA        5     16639 white
2 2015  Kia   Sorento  LX        SUV   automa… 5xyk… CA        5      9393 white
3 2014  BMW   3 Series 328i SUL… SEDAN automa… wba3… CA        4.5    1331 gray 
4 2015  Volvo S60      T5        SEDAN automa… yv16… CA        4.1   14282 white
5 2014  BMW   M5       Base      SEDAN automa… wbsf… CA        3.4   14943 black
6 2014  Audi  A4       2.0T Pre… SEDAN automa… wauf… CA        4.2    9557 white
# … with 15 more variables: interior &lt;chr&gt;, seller &lt;chr&gt;, mmr &lt;dbl&gt;,
#   sellingprice &lt;dbl&gt;, saledate &lt;chr&gt;, Body_Type &lt;chr&gt;, YMM &lt;chr&gt;,
#   Segment &lt;chr&gt;, AVG_MSRP &lt;dbl&gt;, MSRP_Range &lt;dbl&gt;, Trim_Count &lt;int&gt;,
#   StdDev_MSRP &lt;dbl&gt;, Error.MSRP &lt;dbl&gt;, `Error %` &lt;dbl&gt;, `%MSRP_Range` &lt;dbl&gt;,
#   and abbreviated variable names ¹​transmission, ²​condition, ³​odometer</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To clean Year, make, Model fields in false_keys, Run Below </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>VinIn <span class="ot">&lt;-</span>false_keys <span class="sc">%&gt;%</span> <span class="fu">select</span>(vin) </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>VinIn <span class="ot">&lt;-</span> VinIn<span class="sc">$</span>vin</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>decode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a> VIN<span class="ot">&lt;-</span> <span class="fu">decode_vin</span>(x)}</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>decoded_keys <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(VinIn,  decode)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Saving the above output as a CSV</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(decoded_keys, <span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Owen-Matthew</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">Github</span><span class="sc">\\</span><span class="st">601_Fall_2022</span><span class="sc">\\</span><span class="st">posts</span><span class="sc">\\</span><span class="st">decoded_keys.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>false_keys <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vin) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 46123     1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #R Studio Desktop Read In</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># #Cleaning False keys</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>action_keys <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"decoded_keys.csv"</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># #R Studio Cloud Read In</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># #Cleaning False keys</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># action_keys &lt;- read_csv("/cloud/project/Final_project/decoded_keys.csv")</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>a_keys <span class="ot">&lt;-</span> action_keys</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>a_keys <span class="ot">&lt;-</span>  a_keys <span class="sc">%&gt;%</span> </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(year)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(make)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(model)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(VIN)) </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Join with Catalog</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>a_keys <span class="ot">&lt;-</span>  a_keys <span class="sc">%&gt;%</span> </span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(model_year, make,model, VIN) <span class="sc">%&gt;%</span> </span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year=</span> model_year, <span class="at">make2=</span>make, <span class="at">model2=</span>model) <span class="sc">%&gt;%</span> </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span> (YMM, model_year, make2, model2, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>a_keys <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(a_keys, us_catalog, <span class="fu">c</span>(<span class="st">"YMM"</span><span class="ot">=</span> <span class="st">"Combined"</span> )) </span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking to see if a vehicle was auctioned multiple times, to see if we need to include sale date as a matching key</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>unique_check <span class="ot">&lt;-</span> a_keys <span class="sc">%&gt;%</span> </span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">VIN</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Selecting useful columns in false_keys</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>false_keys <span class="ot">&lt;-</span> false_keys <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(trim, body, Body_Type, transmission, vin, state , condition, odometer, color, interior,seller, mmr, sellingprice, saledate)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Join with false keys to get sale records</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>cleaned_keys<span class="ot">=</span> <span class="fu">inner_join</span>(a_keys, false_keys, <span class="fu">c</span>(<span class="st">"VIN"</span> <span class="ot">=</span> <span class="st">"vin"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">rename</span>(<span class="st">"vin"</span> <span class="ot">=</span> <span class="st">"VIN"</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co">#get column names &amp; order from carprices</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>check_cols <span class="ot">&lt;-</span>  <span class="fu">colnames</span>(carprices) <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co">#checking to see if the column order is the same</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>cleaned_keys <span class="ot">&lt;-</span> cleaned_keys[, check_cols]</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(cleaned_keys))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 26
   year make     model trim      body  trans…¹ vin   state condi…² odome…³ color
  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;
1  2013 INFINITI G37   G37 Sport G CO… automa… jn1c… CA        4.5   14716 white
2  2013 INFINITI G37   G37 Jour… G SE… automa… jn1c… CA        4.6      68 black
3  2013 INFINITI G37   G37 Jour… G SE… automa… jn1c… CA        4.5   24112 white
4  2013 INFINITI G37   G37 Sport G CO… automa… jn1c… CA        4.7    4859 black
5  2013 INFINITI G37   G37 Sport G CO… automa… jn1c… CA        4.5   21126 black
6  2013 INFINITI G37   G37 Jour… G SE… automa… jn1c… CA        4.2   26675 blue 
# … with 15 more variables: interior &lt;chr&gt;, seller &lt;chr&gt;, mmr &lt;dbl&gt;,
#   sellingprice &lt;dbl&gt;, saledate &lt;chr&gt;, Body_Type &lt;chr&gt;, YMM &lt;chr&gt;,
#   Segment &lt;chr&gt;, AVG_MSRP &lt;dbl&gt;, MSRP_Range &lt;dbl&gt;, Trim_Count &lt;int&gt;,
#   StdDev_MSRP &lt;dbl&gt;, Error.MSRP &lt;dbl&gt;, `Error %` &lt;dbl&gt;, `%MSRP_Range` &lt;dbl&gt;,
#   and abbreviated variable names ¹​transmission, ²​condition, ³​odometer</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(carprices))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 26
  year  make  model    trim      body  trans…¹ vin   state condi…² odome…³ color
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;
1 2015  Kia   Sorento  LX        SUV   automa… 5xyk… CA        5     16639 white
2 2015  Kia   Sorento  LX        SUV   automa… 5xyk… CA        5      9393 white
3 2014  BMW   3 Series 328i SUL… SEDAN automa… wba3… CA        4.5    1331 gray 
4 2015  Volvo S60      T5        SEDAN automa… yv16… CA        4.1   14282 white
5 2014  BMW   M5       Base      SEDAN automa… wbsf… CA        3.4   14943 black
6 2014  Audi  A4       2.0T Pre… SEDAN automa… wauf… CA        4.2    9557 white
# … with 15 more variables: interior &lt;chr&gt;, seller &lt;chr&gt;, mmr &lt;dbl&gt;,
#   sellingprice &lt;dbl&gt;, saledate &lt;chr&gt;, Body_Type &lt;chr&gt;, YMM &lt;chr&gt;,
#   Segment &lt;chr&gt;, AVG_MSRP &lt;dbl&gt;, MSRP_Range &lt;dbl&gt;, Trim_Count &lt;int&gt;,
#   StdDev_MSRP &lt;dbl&gt;, Error.MSRP &lt;dbl&gt;, `Error %` &lt;dbl&gt;, `%MSRP_Range` &lt;dbl&gt;,
#   and abbreviated variable names ¹​transmission, ²​condition, ³​odometer</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We managed to clean 30% of the previous NA records; 13632 of 46608 records</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reorganize cleaned keys to rbind with carprices data</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(carprices, cleaned_keys)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(carprices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 367892     26</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking for NA values in AVG_MSRP and YMM</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># carprices %&gt;% </span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(AVG_MSRP)) %&gt;% </span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   print()</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># carprices %&gt;% </span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(YMM)) %&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   print()</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing na records in Error%</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span><span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="ot">&lt;-</span> carprices<span class="sc">$</span><span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">replace_na</span>(<span class="dv">0</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="sc">&lt;</span> <span class="dv">7</span>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing 677 NA records for Bodytype</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>na.body <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(<span class="fu">is.na</span>(Body_Type))</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Body_Type))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>•</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the Canadian records</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>({</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  carprices <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state<span class="sc">==</span> <span class="fu">c</span>(<span class="st">"AB"</span>, <span class="st">"ON"</span>, <span class="st">"QC"</span>, <span class="st">"NS"</span>)) </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Excluding Canadian records</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span>carprices <span class="sc">%&gt;%</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(state<span class="sc">!=</span> <span class="fu">c</span>(<span class="st">"AB"</span>, <span class="st">"ON"</span>, <span class="st">"QC"</span>, <span class="st">"NS"</span>))</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I’ll create a new variable called Launch_date. Since most vehicles of model year x are released in the fall of the the previous year, I’ll follow that logic and assume that for all makes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Launch Date Step 1</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(carprices<span class="sc">$</span>year))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">launch_month=</span> <span class="st">"9"</span>, <span class="at">launch_day=</span> <span class="st">"1"</span>, <span class="at">launch_year=</span> (<span class="st">`</span><span class="at">year</span><span class="st">`</span><span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Launch Date Step 2</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">launch_date=</span> <span class="fu">make_date</span>(<span class="at">year=</span> <span class="st">`</span><span class="at">launch_year</span><span class="st">`</span>, <span class="at">month =</span> <span class="st">`</span><span class="at">launch_month</span><span class="st">`</span>, <span class="at">day=</span><span class="st">`</span><span class="at">launch_day</span><span class="st">`</span>))</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting saledate to a date variable</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(saledate, <span class="at">into=</span> <span class="fu">c</span>(<span class="st">"ddd"</span>, <span class="st">"sale_month"</span>, <span class="st">"sale_day"</span>, <span class="st">"sale_year"</span>, <span class="st">"sale_time"</span>, <span class="st">"GMT"</span>, <span class="st">"TMZ"</span>), <span class="at">sep=</span><span class="st">" "</span>)   </span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Recoding the format of the sale month</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">sale_month2=</span> <span class="fu">recode</span>(sale_month, <span class="st">`</span><span class="at">Jan</span><span class="st">`</span> <span class="ot">=</span><span class="st">"1"</span>, <span class="st">`</span><span class="at">Feb</span><span class="st">`</span><span class="ot">=</span> <span class="st">"2"</span>, <span class="st">`</span><span class="at">Mar</span><span class="st">`</span><span class="ot">=</span><span class="st">"3"</span>, <span class="st">`</span><span class="at">Apr</span><span class="st">`</span><span class="ot">=</span><span class="st">"4"</span>, <span class="st">`</span><span class="at">May</span><span class="st">`</span><span class="ot">=</span><span class="st">"5"</span>, <span class="st">`</span><span class="at">Jun</span><span class="st">`</span><span class="ot">=</span><span class="st">"6"</span>, <span class="st">`</span><span class="at">Jul</span><span class="st">`</span><span class="ot">=</span><span class="st">"7"</span>, <span class="st">`</span><span class="at">Aug</span><span class="st">`</span><span class="ot">=</span><span class="st">"8"</span>, <span class="st">`</span><span class="at">Sep</span><span class="st">`</span><span class="ot">=</span><span class="st">"9"</span>, <span class="st">`</span><span class="at">Oct</span><span class="st">`</span><span class="ot">=</span><span class="st">"10"</span>, <span class="st">`</span><span class="at">Nov</span><span class="st">`</span><span class="ot">=</span><span class="st">"11"</span>, <span class="st">`</span><span class="at">Dec</span><span class="st">`</span><span class="ot">=</span><span class="st">"12"</span> ))</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Date_Sold</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="co">#carprices &lt;- mutate(carprices, sale_year2=sale_year)</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">sale_year2=</span>sale_year, <span class="at">Date_Sold =</span> <span class="fu">make_date</span>(<span class="at">year=</span>sale_year2, <span class="at">month =</span> sale_month2, <span class="at">day =</span> sale_day))</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidyiing up: selecting important columns</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(year, make, model, trim, transmission, Body_Type, state, condition, odometer, color, mmr, sellingprice, sale_year, launch_date, Date_Sold, AVG_MSRP, Trim_Count, <span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="st">`</span><span class="at">%MSRP_Range</span><span class="st">`</span>, Segment ) </span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="co">#print(head(carprices))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Calculating the age of the vehicle at the time of sale:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Age of vehicle</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">Age_months=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">difftime</span>(Date_Sold, launch_date, <span class="at">units=</span> <span class="st">"days"</span>))<span class="sc">/</span><span class="dv">30</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking for negatives in Vehicle Age</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span> </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Age_months) <span class="sc">%&gt;%</span> </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_months<span class="sc">&lt;</span><span class="dv">0</span>)<span class="co"># %&gt;% </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
  Age_months
       &lt;dbl&gt;
1         -8
2         -8
3         -8
4         -8
5         -8</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print.difftime()</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Recoding Vehicle Age</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span>carprices <span class="sc">%&gt;%</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_months=</span><span class="fu">recode</span>(Age_months, <span class="st">`</span><span class="at">-8</span><span class="st">`</span><span class="ot">=</span><span class="dv">0</span>))</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Age in years</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span>carprices <span class="sc">%&gt;%</span> </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_years=</span><span class="fu">round</span>(Age_months<span class="sc">/</span><span class="dv">12</span>, <span class="dv">0</span>))</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(carprices))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 22
   year make  model    trim    trans…¹ Body_…² state condi…³ odome…⁴ color   mmr
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
1  2015 Kia   Sorento  LX      automa… SUV     CA        5     16639 white 20500
2  2015 Kia   Sorento  LX      automa… SUV     CA        5      9393 white 20800
3  2014 BMW   3 Series 328i S… automa… Sedan   CA        4.5    1331 gray  31900
4  2015 Volvo S60      T5      automa… Sedan   CA        4.1   14282 white 27500
5  2014 BMW   M5       Base    automa… Sedan   CA        3.4   14943 black 69000
6  2014 Audi  A4       2.0T P… automa… Sedan   CA        4.2    9557 white 32100
# … with 11 more variables: sellingprice &lt;dbl&gt;, sale_year &lt;chr&gt;,
#   launch_date &lt;date&gt;, Date_Sold &lt;date&gt;, AVG_MSRP &lt;dbl&gt;, Trim_Count &lt;int&gt;,
#   `Error %` &lt;dbl&gt;, `%MSRP_Range` &lt;dbl&gt;, Segment &lt;chr&gt;, Age_months &lt;dbl&gt;,
#   Age_years &lt;dbl&gt;, and abbreviated variable names ¹​transmission, ²​Body_Type,
#   ³​condition, ⁴​odometer</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Retained value</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">RV_percent=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">sellingprice</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">AVG_MSRP</span><span class="st">`</span> <span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">1</span>))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span>  carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RV_percent <span class="sc">&lt;</span> <span class="dv">125</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(carprices))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 23
   year make  model    trim    trans…¹ Body_…² state condi…³ odome…⁴ color   mmr
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
1  2015 Kia   Sorento  LX      automa… SUV     CA        5     16639 white 20500
2  2015 Kia   Sorento  LX      automa… SUV     CA        5      9393 white 20800
3  2014 BMW   3 Series 328i S… automa… Sedan   CA        4.5    1331 gray  31900
4  2015 Volvo S60      T5      automa… Sedan   CA        4.1   14282 white 27500
5  2014 BMW   M5       Base    automa… Sedan   CA        3.4   14943 black 69000
6  2014 Audi  A4       2.0T P… automa… Sedan   CA        4.2    9557 white 32100
# … with 12 more variables: sellingprice &lt;dbl&gt;, sale_year &lt;chr&gt;,
#   launch_date &lt;date&gt;, Date_Sold &lt;date&gt;, AVG_MSRP &lt;dbl&gt;, Trim_Count &lt;int&gt;,
#   `Error %` &lt;dbl&gt;, `%MSRP_Range` &lt;dbl&gt;, Segment &lt;chr&gt;, Age_months &lt;dbl&gt;,
#   Age_years &lt;dbl&gt;, RV_percent &lt;dbl&gt;, and abbreviated variable names
#   ¹​transmission, ²​Body_Type, ³​condition, ⁴​odometer</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#How does the distriburion of RV% look?</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(carprices<span class="sc">$</span>RV_percent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.90   37.00   47.20   47.98   58.40  124.70 </code></pre>
</div>
</div>
</section>
<section id="narrative-about-the-data-set.." class="level2">
<h2 class="anchored" data-anchor-id="narrative-about-the-data-set..">Narrative about the data set..</h2>
<p>This data set contains historical used vehicle auction prices that took place between 1982 and 2015. The data was collected from all Manheim auction houses across the 34 states in the USA. Each observation details a wholesale auction transaction that includes: the vehicle information, state, selling price and the market average price i.e the Manheim Market Report price (MMR) and other specifics about the sale.</p>
</section>
<section id="potential-research-questions" class="level2">
<h2 class="anchored" data-anchor-id="potential-research-questions">Potential Research Questions</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Establishing vehicle groups</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Error in Nissan records</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>mainstream <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Toyota"</span>, <span class="st">"Honda"</span>, <span class="st">"Hyundai"</span>, <span class="st">"Nissan"</span>, <span class="st">"Hyundai"</span>, <span class="st">"Kia"</span>, <span class="st">"Mazda"</span>, <span class="st">"Subaru"</span>, <span class="st">"Volkswagen"</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>luxury <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BMW"</span>, <span class="st">"Audi"</span>, <span class="st">"Mercedes Benz"</span>, <span class="st">"Porsche"</span>, <span class="st">"Lexus"</span>, <span class="st">"INFINITI"</span>, <span class="st">"Acura"</span>, <span class="st">"Genesis"</span>, <span class="st">"Volvo"</span>, <span class="st">"Cadillac"</span>, <span class="st">"Lincoln"</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>passenger <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"Sedan"</span>, <span class="st">"SUV"</span>, <span class="st">"Coupe"</span>, <span class="st">"Convertible"</span>, <span class="st">"Wagon"</span>, <span class="st">"Hatchback"</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>Japanese4 <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"Toyota"</span>, <span class="st">"Honda"</span>, <span class="st">"Nissan"</span>, <span class="st">"Mazda"</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>Korean <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Kia"</span>, <span class="st">"Hyundai"</span>, <span class="st">"Genesis"</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>German <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Audi"</span>, <span class="st">"BMW"</span>, <span class="st">"Mercedes Benz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol type="1">
<li>Is there a correlation between mileage, age and condition?</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">mainstream</span><span class="st">`</span>, <span class="st">`</span><span class="at">luxury</span><span class="st">`</span>), Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in make == c(mainstream, luxury): longer object length is not a multiple
of shorter object length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in Body_Type == c(passenger): longer object length is not a multiple of
shorter object length</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot2) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span>condition , <span class="at">y =</span> (odometer), <span class="at">color=</span> Age_years) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation: colour
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OwenTibby_HW3_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="2" type="1">
<li>How does mileage affect vehicle sale price/ RV?</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">mainstream</span><span class="st">`</span>, <span class="st">`</span><span class="at">luxury</span><span class="st">`</span>), Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger), RV_percent <span class="sc">&gt;</span><span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in make == c(mainstream, luxury): longer object length is not a multiple
of shorter object length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in Body_Type == c(passenger): longer object length is not a multiple of
shorter object length</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot2) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">y =</span> RV_percent, <span class="at">x =</span> (odometer)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OwenTibby_HW3_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Control for Age &amp; condition</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="3" type="1">
<li>What is there a correlation between condition and Retained value?</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">mainstream</span><span class="st">`</span>, <span class="st">`</span><span class="at">luxury</span><span class="st">`</span>), Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger) ) <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(Age_years)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in make == c(mainstream, luxury): longer object length is not a multiple
of shorter object length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in Body_Type == c(passenger): longer object length is not a multiple of
shorter object length</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot2) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span>condition, <span class="at">y =</span> (RV_percent)) <span class="sc">+</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OwenTibby_HW3_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="4" type="1">
<li>How does the transaction volume vary by age across volume states</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Analyzing the number of transactions by state by the age </span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>vol.states<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years <span class="sc">&lt;</span> <span class="dv">7</span>, Age_years <span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_years, state) <span class="sc">%&gt;%</span> </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>vol.states <span class="sc">%&gt;%</span> </span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(state, <span class="sc">-</span>n), <span class="at">y=</span> n) <span class="sc">+</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill=</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"State"</span>, <span class="at">y=</span><span class="st">"Number of Transactions"</span>) <span class="sc">+</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Age_years))<span class="sc">+</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtitle</span>(<span class="st">"Number of Transactions by State faceted by Vehicle Age"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="OwenTibby_HW3_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above, we see that most vehicles are auctioned between ages 2 and 4 years. This corresponds to the popular lease terms of 24 to 48 months.</p>
<ol start="2" type="1">
<li>Which segment retains the best value?</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>by_segment <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years <span class="sc">&lt;</span> <span class="dv">8</span>, Age_years<span class="sc">&gt;</span><span class="dv">0</span>, <span class="sc">!</span><span class="fu">is.na</span>(Segment), Body_Type<span class="sc">==</span> passenger, make<span class="sc">==</span><span class="fu">c</span>(mainstream, luxury)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_years, Segment, sale_year, Age_months) <span class="sc">%&gt;%</span> </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Segment_RV=</span> <span class="fu">round</span>(<span class="fu">mean</span>(RV_percent), <span class="at">digits=</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Segment_RV)) <span class="sc">%&gt;%</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>((Age_years)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>((sale_year)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) </span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">head</span>(by_segment))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
# Groups:   Age_years, Segment, sale_year [2]
  Age_years Segment     sale_year Age_months Segment_RV
      &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt;
1         1 Compact Car 2014              16       70.3
2         1 Compact Car 2015               8       94.3
3         1 Compact Car 2015              10       80.5
4         1 Compact Car 2015               9       77.4
5         1 Compact Car 2015              17       65.2
6         1 Compact Car 2015              16       63.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> by_segment) <span class="sc">+</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Age_months, <span class="at">y =</span> Segment_RV, <span class="at">color =</span> <span class="st">`</span><span class="at">Segment</span><span class="st">`</span>), <span class="at">se=</span> F) <span class="co">#+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="OwenTibby_HW3_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~sale_year)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the Segments with the highest RV</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>best_value_segments <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years<span class="sc">&gt;</span> <span class="dv">1</span>, Age_years <span class="sc">&lt;</span><span class="dv">6</span>, Body_Type<span class="sc">==</span> passenger, <span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="sc">!</span><span class="fu">is.na</span>(Segment)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Segment,Age_years,  RV_percent, odometer, condition, model) <span class="sc">%&gt;%</span> </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">RV_percentage =</span> <span class="fu">mean</span>(RV_percent), <span class="at">odometer=</span><span class="fu">mean</span>(odometer),<span class="at">condition=</span><span class="fu">mean</span>(condition), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Segment=</span>Segment, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent), <span class="at">odometer=</span><span class="fu">mean</span>(odometer),<span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(Segment, Age_years) <span class="sc">%&gt;%</span> </span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Segment=</span>Segment, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent),<span class="at">Mileage=</span><span class="fu">mean</span>(odometer), <span class="at">Condition=</span><span class="fu">mean</span>(condition),  <span class="at">Sample_Size =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>((Age_years))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in Body_Type == passenger: longer object length is not a multiple of
shorter object length</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(best_value_segments)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 6
# Groups:   Segment, Age_years [36]
   Segment                  Age_years RV_percent Mileage Condition Sample_Size
   &lt;chr&gt;                        &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;       &lt;int&gt;
 1 Mid-Size SUV/Crossover           2       63.2  31575.      4.16        1658
 2 Subcompact SUV/Crossover         2       62.0  25790.      4.18         381
 3 Compact SUV/Crossover            2       61.2  31791.      4.18        1892
 4 Full-Size SUV/Crossover          2       61.1  35426.      4.13         415
 5 Subcompact Car                   2       59.9  27101.      3.97         992
 6 Compact Car                      2       57.9  28675.      3.94        3189
 7 Sports Car                       2       52.1  27601.      4.00         651
 8 Mid-Size Car                     2       50.5  29878.      3.99        4368
 9 Full-Size Car                    2       47.8  33692.      3.95         868
10 Mid-Size SUV/Crossover           3       54.1  40314.      4.00         919
# … with 26 more rows</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing a few missing fields in Segments that were missing in Catalog</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>BVS <span class="ot">&lt;-</span> best_value_segments <span class="sc">%&gt;%</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Segment)) </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(data = BVS) + </span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(mapping = aes(x = Age_years, y = RV_percent, color = `Segment`)) +</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_smooth(mapping = aes(x = Age_years, y = RV_percent, color = `Segment`), se= F)</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>BVS <span class="sc">%&gt;%</span> </span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> Age_years, <span class="at">y =</span>(RV_percent)) <span class="sc">+</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span> <span class="st">"identity"</span>, <span class="at">fill=</span><span class="st">"darkred"</span>) <span class="sc">+</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Segment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="OwenTibby_HW3_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Volume models</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>vol.models<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>( Age_years <span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>vol.models.passenger <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(Age_years <span class="sc">&gt;</span><span class="dv">0</span>, Body_Type<span class="sc">==</span> passenger) <span class="sc">%&gt;%</span> </span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in Body_Type == passenger: longer object length is not a multiple of
shorter object length</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>popular.models <span class="ot">&lt;-</span>  vol.models.passenger<span class="sc">$</span>model</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>vol.models <span class="sc">%&gt;%</span> </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(model, <span class="sc">-</span>n), <span class="at">y=</span> n) <span class="sc">+</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill=</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Model"</span>, <span class="at">y=</span><span class="st">"Number of Wholesale Transactions"</span>)<span class="sc">+</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Top Selling Used Vehicles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="OwenTibby_HW3_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>vol.models.passenger <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(model, <span class="sc">-</span>n), <span class="at">y=</span> n) <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill=</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Model"</span>, <span class="at">y=</span><span class="st">"Number of Transactions for Top  Selling Models"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="OwenTibby_HW3_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Do the most popular vehicles retain the best value or is it the opposite? Let’s explore below:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the models with the highest RV</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>best_value_models <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years<span class="sc">&gt;</span> <span class="dv">1</span>, Age_years <span class="sc">&lt;</span><span class="dv">6</span>, Body_Type<span class="sc">==</span> passenger, <span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(make, model,Age_years,  RV_percent, odometer, condition, Segment) <span class="sc">%&gt;%</span> </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">RV_percentage =</span> <span class="fu">mean</span>(RV_percent), <span class="at">odometer=</span><span class="fu">mean</span>(odometer), <span class="at">condition=</span><span class="fu">mean</span>(condition), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">make=</span>make, <span class="at">model=</span>model, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent), <span class="at">odometer=</span><span class="fu">mean</span>(odometer),<span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(make, model, Age_years) <span class="sc">%&gt;%</span> </span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">make=</span>make, <span class="at">model=</span>model, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent), <span class="at">mileage=</span><span class="fu">mean</span>(odometer), <span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) <span class="sc">%&gt;%</span> </span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Filtering a sample size 20 or more</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">19</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>((Age_years))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in Body_Type == passenger: longer object length is not a multiple of
shorter object length</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(best_value_models)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 366 × 7
# Groups:   make, model, Age_years [366]
   make   model        Age_years RV_percent mileage condition     n
   &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;
 1 Jeep   Wrangler             2       86.0  22507.      4.55   119
 2 Toyota 4Runner              2       85.6  26949.      4.47    30
 3 Subaru XV Crosstrek         2       83.0  15515       4.68    21
 4 Jeep   Cherokee             2       77.5  18633.      4.29    43
 5 Toyota RAV4                 2       72.9  27580.      4.19    72
 6 Toyota Highlander           2       72.0  28409.      4.10    33
 7 Nissan Versa Note           2       71.9  17331.      4.16    54
 8 Subaru Impreza              2       71.4  16454.      4.22    23
 9 BMW    X3                   2       69.9  20962.      4.20    22
10 Subaru Outback              2       69.3  28139.      4.29    69
# … with 356 more rows</code></pre>
</div>
</div>
<p>How does the RV% compare among volume models?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vol.models %&gt;% </span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot()+ aes(y= RV_percent , x=Age_months)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Popular makes</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Distribution of makes</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>vol.brands<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years <span class="sc">&lt;</span> <span class="dv">7</span>, Age_years <span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(make) <span class="sc">%&gt;%</span> </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vol.brands)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   make          n
   &lt;chr&gt;     &lt;int&gt;
 1 Ford      65459
 2 Nissan    35946
 3 Chevrolet 32329
 4 Toyota    23732
 5 Dodge     21475
 6 Hyundai   15149
 7 Honda     13749
 8 Kia       13547
 9 INFINITI  12451
10 BMW       11348</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>vol.brands <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(make, <span class="sc">-</span>n), <span class="at">y=</span> n) <span class="sc">+</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill=</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Brand"</span>, <span class="at">y=</span><span class="st">"Number of Transactions"</span>) <span class="sc">+</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co">#facet_wrap(vars(Age_years))+</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtitle</span>(<span class="st">"Popular Brands"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="OwenTibby_HW3_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Japanese makes</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years<span class="sc">&lt;</span><span class="dv">7</span>, make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">"Toyota"</span>, <span class="st">"Honda"</span>, <span class="st">"Nissan"</span>, <span class="st">"Hyundai"</span>), Body_Type<span class="sc">==</span> (<span class="st">"Sedan"</span>))</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot) <span class="sc">+</span> </span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Age_months, <span class="at">y =</span> RV_percent, <span class="at">color =</span> <span class="st">`</span><span class="at">make</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OwenTibby_HW3_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Best mainstream cars to buy post-2015?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(make<span class="sc">==</span> mainstream, Age_years <span class="sc">==</span> <span class="dv">2</span>, <span class="st">`</span><span class="at">%MSRP_Range</span><span class="st">`</span> <span class="sc">&lt;</span><span class="dv">50</span>, Body_Type<span class="sc">==</span> passenger) <span class="sc">%&gt;%</span> </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) <span class="sc">%&gt;%</span> </span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 198 × 23
# Groups:   model [25]
    year make    model  trim   trans…¹ Body_…² state condi…³ odome…⁴ color   mmr
   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
 1  2014 Hyundai Accent GS     automa… Hatchb… TN        4.6    6566 blue  11300
 2  2013 Hyundai Accent GS     automa… Hatchb… FL        4.8   14730 silv…  9875
 3  2013 Hyundai Accent GS     automa… Hatchb… FL        2.7   21101 black  9350
 4  2014 Hyundai Accent GS     &lt;NA&gt;    Hatchb… ON        2.8   40860 black 11100
 5  2014 Nissan  Altima 2.5 S  automa… Sedan   WA        4.1    2371 white 17050
 6  2014 Nissan  Altima 2.5 S  automa… Sedan   TN        4.1   22847 —     15600
 7  2014 Nissan  Altima 2.5 S  automa… Sedan   TN        4.7   27050 black 15250
 8  2013 Nissan  Altima 3.5 SL automa… Sedan   GA        3.7   19959 blue  16800
 9  2013 Nissan  Altima 3.5 SL automa… Sedan   MO        4.7   18735 white 19200
10  2014 Nissan  Altima 2.5 S  &lt;NA&gt;    Sedan   CA        2.9    2030 white 17250
# … with 188 more rows, 12 more variables: sellingprice &lt;dbl&gt;, sale_year &lt;chr&gt;,
#   launch_date &lt;date&gt;, Date_Sold &lt;date&gt;, AVG_MSRP &lt;dbl&gt;, Trim_Count &lt;int&gt;,
#   `Error %` &lt;dbl&gt;, `%MSRP_Range` &lt;dbl&gt;, Segment &lt;chr&gt;, Age_months &lt;dbl&gt;,
#   Age_years &lt;dbl&gt;, RV_percent &lt;dbl&gt;, and abbreviated variable names
#   ¹​transmission, ²​Body_Type, ³​condition, ⁴​odometer</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Monthly mileage by state</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>plot7 <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">mainstream</span><span class="st">`</span>, <span class="st">`</span><span class="at">luxury</span><span class="st">`</span>), Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger) )</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot7) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span>state , <span class="at">y =</span> ((odometer)<span class="sc">/</span> Age_months)) <span class="sc">+</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>:::</p>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/601_Fall_2022" data-repo-id="R_kgDOH564Gw" data-category="Announcements" data-category-id="DIC_kwDOH564G84CRdBB" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb91" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Homework 3"</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Owen Tibby"</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="an">desription:</span><span class="co"> "Homework 3"</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "11/30/2022"</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - HW3</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - Used Vehicle Data</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - Owen Tibby</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vindecodr)</span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotrix)</span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sparklyr)</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a><span class="fu">## Instructions</span></span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>The emphasis in this homework is on exploratory data analysis using both graphics and statistics. You should build on your prior homework - incorporating any feedback and adjusting the code and text as needed. These homeworks are intended to be cumulative. Therefore, while it is fine to switch datasets, you will need to include all of the information from HW1 for your new (or old) dataset in this hw submission as well.</span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Include descriptive statistics (e.g, mean, median, and standard deviation for numerical variables, and frequencies and/or mode for categorical variables</span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Include relevant visualizations using ggplot2 to complement these descriptive statistics. Be sure to use faceting, coloring, and titles as needed. Each visualization should be accompanied by descriptive text that highlights:</span>
<span id="cb91-49"><a href="#cb91-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-50"><a href="#cb91-50" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the variable(s) used</span>
<span id="cb91-51"><a href="#cb91-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-52"><a href="#cb91-52" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>what questions might be answered with the visualizations</span>
<span id="cb91-53"><a href="#cb91-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-54"><a href="#cb91-54" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>what conclusions you can draw</span>
<span id="cb91-55"><a href="#cb91-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-56"><a href="#cb91-56" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use group_by() and summarise() to compute descriptive stats and/or visualizations for any relevant groupings. For example, if you were interested in how average income varies by state, you might compute mean income for all states combined, and then compare this to the range and distribution of mean income for each individual state in the US.</span>
<span id="cb91-57"><a href="#cb91-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-58"><a href="#cb91-58" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Identify limitations of your visualization, such as:</span>
<span id="cb91-59"><a href="#cb91-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-60"><a href="#cb91-60" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>What questions are left unanswered with your visualizations</span>
<span id="cb91-61"><a href="#cb91-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-62"><a href="#cb91-62" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>What about the visualizations may be unclear to a naive viewer</span>
<span id="cb91-63"><a href="#cb91-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-64"><a href="#cb91-64" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>How could you&nbsp;improve the visualizations for the final project</span>
<span id="cb91-65"><a href="#cb91-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-66"><a href="#cb91-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-67"><a href="#cb91-67" aria-hidden="true" tabindex="-1"></a><span class="fu">## </span></span>
<span id="cb91-68"><a href="#cb91-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-69"><a href="#cb91-69" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reading in the Data</span></span>
<span id="cb91-70"><a href="#cb91-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-71"><a href="#cb91-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-72"><a href="#cb91-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE}</span></span>
<span id="cb91-73"><a href="#cb91-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-74"><a href="#cb91-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-75"><a href="#cb91-75" aria-hidden="true" tabindex="-1"></a><span class="co"># #RStudio Desktop</span></span>
<span id="cb91-76"><a href="#cb91-76" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"car_prices.csv"</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">mmr =</span> <span class="fu">col_number</span>(), <span class="at">year =</span> <span class="fu">col_character</span>(), <span class="at">sellingprice =</span> <span class="fu">col_number</span>(), <span class="at">...17 =</span> <span class="fu">col_skip</span>()))</span>
<span id="cb91-77"><a href="#cb91-77" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Catalog.csv"</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">Brand =</span> <span class="fu">col_skip</span>(), <span class="at">ModelName =</span> <span class="fu">col_skip</span>()))  <span class="co">#, Trim = col_skip()))</span></span>
<span id="cb91-78"><a href="#cb91-78" aria-hidden="true" tabindex="-1"></a>exchange_rate <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"HistoricalPrices.xlsx"</span>, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"numeric"</span>, <span class="st">"text"</span>, <span class="st">"skip"</span>, <span class="st">"skip"</span>, <span class="st">"skip"</span>, <span class="st">"numeric"</span>))</span>
<span id="cb91-79"><a href="#cb91-79" aria-hidden="true" tabindex="-1"></a><span class="co"># # #RStudio Cloud</span></span>
<span id="cb91-80"><a href="#cb91-80" aria-hidden="true" tabindex="-1"></a><span class="co">#  carprices &lt;-read_csv("/cloud/project/Final_project/car_prices.csv",</span></span>
<span id="cb91-81"><a href="#cb91-81" aria-hidden="true" tabindex="-1"></a><span class="co">#      col_types = cols(mmr = col_number(), year = col_character(), sellingprice = col_number(), ...17 = col_skip()))</span></span>
<span id="cb91-82"><a href="#cb91-82" aria-hidden="true" tabindex="-1"></a><span class="co">#   ca_catalog &lt;- read_csv("/cloud/project/Final_project/Catalog.csv", col_types = cols(Brand = col_skip(), ModelName = col_skip()))  #, Trim = col_skip()))</span></span>
<span id="cb91-83"><a href="#cb91-83" aria-hidden="true" tabindex="-1"></a><span class="co">#  exchange_rate &lt;- read_excel("/cloud/project/Final_project/HistoricalPrices.xlsx",  col_types = c("numeric", "text", "skip", "skip", "skip", "numeric"))</span></span>
<span id="cb91-84"><a href="#cb91-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-85"><a href="#cb91-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-86"><a href="#cb91-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-87"><a href="#cb91-87" aria-hidden="true" tabindex="-1"></a><span class="fu">## Brief Description of the data</span></span>
<span id="cb91-88"><a href="#cb91-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-89"><a href="#cb91-89" aria-hidden="true" tabindex="-1"></a>This data set contains historical used vehicle auction prices that took place between 1982 and 2015.</span>
<span id="cb91-90"><a href="#cb91-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-91"><a href="#cb91-91" aria-hidden="true" tabindex="-1"></a>First, lets take a look at the variables in the data set.</span>
<span id="cb91-92"><a href="#cb91-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-93"><a href="#cb91-93" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE}</span></span>
<span id="cb91-94"><a href="#cb91-94" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(carprices)</span>
<span id="cb91-95"><a href="#cb91-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-96"><a href="#cb91-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-97"><a href="#cb91-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-98"><a href="#cb91-98" aria-hidden="true" tabindex="-1"></a> ## Cleaning the Data</span>
<span id="cb91-99"><a href="#cb91-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-100"><a href="#cb91-100" aria-hidden="true" tabindex="-1"></a>I've noticed a few records belonging to Canadian provinces. "ab" is Alberta, "on" is Ontario, "qc" is Quebec &amp; "ns" represents Nova Scotia.</span>
<span id="cb91-101"><a href="#cb91-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-104"><a href="#cb91-104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-105"><a href="#cb91-105" aria-hidden="true" tabindex="-1"></a><span class="co">#Observing the amount of NAs in our most important variables</span></span>
<span id="cb91-106"><a href="#cb91-106" aria-hidden="true" tabindex="-1"></a><span class="co"># carprices %&gt;% </span></span>
<span id="cb91-107"><a href="#cb91-107" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(model), is.na(make)) %&gt;% </span></span>
<span id="cb91-108"><a href="#cb91-108" aria-hidden="true" tabindex="-1"></a><span class="co">#   dim()</span></span>
<span id="cb91-109"><a href="#cb91-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-110"><a href="#cb91-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-111"><a href="#cb91-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-112"><a href="#cb91-112" aria-hidden="true" tabindex="-1"></a><span class="co">#Justify dropping NAs... Why did i exclude it</span></span>
<span id="cb91-113"><a href="#cb91-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-114"><a href="#cb91-114" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-115"><a href="#cb91-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(make), <span class="sc">!</span><span class="fu">is.na</span>(model), <span class="sc">!</span><span class="fu">is.na</span>(odometer), <span class="sc">!</span><span class="fu">is.na</span>(mmr)) </span>
<span id="cb91-116"><a href="#cb91-116" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dfSummary(carprices)</span></span>
<span id="cb91-117"><a href="#cb91-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-118"><a href="#cb91-118" aria-hidden="true" tabindex="-1"></a><span class="co">#Observing all records for model year 2007 and newer</span></span>
<span id="cb91-119"><a href="#cb91-119" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-120"><a href="#cb91-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">year</span><span class="st">`</span><span class="sc">&gt;</span> <span class="dv">2006</span>, sellingprice<span class="sc">&gt;</span><span class="dv">100</span>, condition<span class="sc">&gt;</span><span class="fl">2.41</span>)</span>
<span id="cb91-121"><a href="#cb91-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(carprices)</span>
<span id="cb91-122"><a href="#cb91-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-123"><a href="#cb91-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-126"><a href="#cb91-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-127"><a href="#cb91-127" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the consistency in the names of states and body types</span></span>
<span id="cb91-128"><a href="#cb91-128" aria-hidden="true" tabindex="-1"></a>  carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-129"><a href="#cb91-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state) <span class="sc">%&gt;%</span> </span>
<span id="cb91-130"><a href="#cb91-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb91-131"><a href="#cb91-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-132"><a href="#cb91-132" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span>state <span class="ot">&lt;-</span> <span class="fu">toupper</span>(carprices<span class="sc">$</span>state)</span>
<span id="cb91-133"><a href="#cb91-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-134"><a href="#cb91-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-135"><a href="#cb91-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-136"><a href="#cb91-136" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-137"><a href="#cb91-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(body) <span class="sc">%&gt;%</span> </span>
<span id="cb91-138"><a href="#cb91-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span><span class="fu">print</span>()</span>
<span id="cb91-139"><a href="#cb91-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-140"><a href="#cb91-140" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span>body <span class="ot">&lt;-</span> <span class="fu">toupper</span>(carprices<span class="sc">$</span>body)</span>
<span id="cb91-141"><a href="#cb91-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-142"><a href="#cb91-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-143"><a href="#cb91-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-144"><a href="#cb91-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-145"><a href="#cb91-145" aria-hidden="true" tabindex="-1"></a>I notice that there are 76 distinct values for body. I'll explore and condense them into fewer categories in a new column called "Body_type" below</span>
<span id="cb91-146"><a href="#cb91-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-149"><a href="#cb91-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-150"><a href="#cb91-150" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the consistency in the names of Body types}</span></span>
<span id="cb91-151"><a href="#cb91-151" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-152"><a href="#cb91-152" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(body) <span class="sc">%&gt;%</span> </span>
<span id="cb91-153"><a href="#cb91-153" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>()</span>
<span id="cb91-154"><a href="#cb91-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-155"><a href="#cb91-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-156"><a href="#cb91-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-157"><a href="#cb91-157" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a Body Type column</span></span>
<span id="cb91-158"><a href="#cb91-158" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">Body_Type =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(body, <span class="st">"EDAN"</span>)<span class="sc">~</span> <span class="st">"Sedan"</span>, <span class="fu">str_detect</span>(body, <span class="st">"SUV"</span>) <span class="sc">~</span> <span class="st">"SUV"</span>, <span class="fu">str_detect</span>(body, <span class="st">"AB"</span>) <span class="sc">~</span> <span class="st">"Pickup"</span>, <span class="fu">str_detect</span>(body, <span class="st">"OUP"</span>)<span class="sc">~</span> <span class="st">"Coupe"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>, <span class="st">"VAN"</span>)<span class="sc">~</span> <span class="st">"Minivan"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"ONV"</span>)<span class="sc">~</span> <span class="st">"Convertible"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"AGO"</span>) <span class="sc">~</span> <span class="st">"Wagon"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"ATCH"</span>)<span class="sc">~</span> <span class="st">"Hatchback"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"CREW"</span>)<span class="sc">~</span> <span class="st">"Pickup"</span> ))</span>
<span id="cb91-159"><a href="#cb91-159" aria-hidden="true" tabindex="-1"></a><span class="co"># print(head(carprices))</span></span>
<span id="cb91-160"><a href="#cb91-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-161"><a href="#cb91-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-162"><a href="#cb91-162" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(carprices)</span>
<span id="cb91-163"><a href="#cb91-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-164"><a href="#cb91-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-165"><a href="#cb91-165" aria-hidden="true" tabindex="-1"></a>Next step is to link multiple files to get the MSRP from a historical catalog. We'll need this in order to get AV/MSRP ratios.</span>
<span id="cb91-166"><a href="#cb91-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-167"><a href="#cb91-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE}</span></span>
<span id="cb91-168"><a href="#cb91-168" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a Key in the CDN catalog</span></span>
<span id="cb91-169"><a href="#cb91-169" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span>  ca_catalog <span class="sc">%&gt;%</span> </span>
<span id="cb91-170"><a href="#cb91-170" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">YearOfLaunch=</span> <span class="st">`</span><span class="at">Model Year</span><span class="st">`</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb91-171"><a href="#cb91-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-172"><a href="#cb91-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-173"><a href="#cb91-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-174"><a href="#cb91-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-175"><a href="#cb91-175" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Catalog with MSRP in CAD</span></span>
<span id="cb91-176"><a href="#cb91-176" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span> ca_catalog <span class="sc">%&gt;%</span> </span>
<span id="cb91-177"><a href="#cb91-177" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(<span class="st">`</span><span class="at">Combined</span><span class="st">`</span>, <span class="st">`</span><span class="at">YearOfLaunch</span><span class="st">`</span>, <span class="st">`</span><span class="at">Segment</span><span class="st">`</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb91-178"><a href="#cb91-178" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>( <span class="at">Trim_Count=</span><span class="fu">n</span>(), <span class="at">AVG_MSRP_CAD=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>, <span class="at">na.rm=</span> <span class="cn">TRUE</span>), <span class="at">MSRP_Range_CAD=</span> (<span class="fu">max</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>)<span class="sc">-</span> <span class="fu">min</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>)), <span class="at">StdDev_MSRP_CAD=</span> <span class="fu">sd</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">FALSE</span>), <span class="at">Error.MSRP_CAD=</span> <span class="fu">std.error</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">FALSE</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb91-179"><a href="#cb91-179" aria-hidden="true" tabindex="-1"></a><span class="fu">ungroup</span>()</span>
<span id="cb91-180"><a href="#cb91-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-181"><a href="#cb91-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-184"><a href="#cb91-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-185"><a href="#cb91-185" aria-hidden="true" tabindex="-1"></a><span class="co">#Joining the data to convert CAD MSRP to USD MSRP later</span></span>
<span id="cb91-186"><a href="#cb91-186" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span> <span class="fu">left_join</span>(ca_catalog, exchange_rate, <span class="fu">c</span>(<span class="st">"YearOfLaunch"</span><span class="ot">=</span> <span class="st">"Year"</span>))</span>
<span id="cb91-187"><a href="#cb91-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-188"><a href="#cb91-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-189"><a href="#cb91-189" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating US$ Catalog and Converting to MSRP from CAD to USD</span></span>
<span id="cb91-190"><a href="#cb91-190" aria-hidden="true" tabindex="-1"></a>us_catalog <span class="ot">&lt;-</span> ca_catalog <span class="sc">%&gt;%</span> </span>
<span id="cb91-191"><a href="#cb91-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AVG_MSRP=</span> <span class="fu">round</span>((<span class="st">`</span><span class="at">AVG_MSRP_CAD</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span>), <span class="at">digits =</span> <span class="dv">0</span>), <span class="at">MSRP_Range=</span> <span class="st">`</span><span class="at">MSRP_Range_CAD</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span>, <span class="at">StdDev_MSRP=</span> <span class="st">`</span><span class="at">StdDev_MSRP_CAD</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span>, <span class="at">Error.MSRP=</span> <span class="st">`</span><span class="at">Error.MSRP_CAD</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span> )</span>
<span id="cb91-192"><a href="#cb91-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-193"><a href="#cb91-193" aria-hidden="true" tabindex="-1"></a><span class="co">#Finalizing US Catalog for Joining</span></span>
<span id="cb91-194"><a href="#cb91-194" aria-hidden="true" tabindex="-1"></a>us_catalog <span class="ot">&lt;-</span> us_catalog <span class="sc">%&gt;%</span> </span>
<span id="cb91-195"><a href="#cb91-195" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(Combined, Segment, AVG_MSRP, MSRP_Range, Trim_Count, StdDev_MSRP, Error.MSRP) <span class="sc">%&gt;%</span> </span>
<span id="cb91-196"><a href="#cb91-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span> <span class="fu">round</span>((<span class="st">`</span><span class="at">Error.MSRP</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">AVG_MSRP</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">1</span>), <span class="st">`</span><span class="at">%MSRP_Range</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>((<span class="st">`</span><span class="at">MSRP_Range</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">AVG_MSRP</span><span class="st">`</span> <span class="sc">*</span><span class="dv">100</span>), <span class="at">digits=</span><span class="dv">1</span>))</span>
<span id="cb91-197"><a href="#cb91-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-198"><a href="#cb91-198" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a common key to join carprices and us_catalog</span></span>
<span id="cb91-199"><a href="#cb91-199" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-200"><a href="#cb91-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year2=</span>year, <span class="at">make2=</span>make, <span class="at">model2=</span>model)</span>
<span id="cb91-201"><a href="#cb91-201" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span>  <span class="fu">unite</span>(<span class="st">`</span><span class="at">YMM</span><span class="st">`</span>, <span class="st">`</span><span class="at">year2</span><span class="st">`</span>, <span class="st">`</span><span class="at">make2</span><span class="st">`</span>, <span class="st">`</span><span class="at">model2</span><span class="st">`</span>, <span class="at">sep=</span><span class="st">" "</span>)</span>
<span id="cb91-202"><a href="#cb91-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-203"><a href="#cb91-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-206"><a href="#cb91-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-207"><a href="#cb91-207" aria-hidden="true" tabindex="-1"></a><span class="co">#Joining Data with us_catalog</span></span>
<span id="cb91-208"><a href="#cb91-208" aria-hidden="true" tabindex="-1"></a><span class="co"># carprices &lt;- head(carprices) </span></span>
<span id="cb91-209"><a href="#cb91-209" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">left_join</span>(carprices, us_catalog, <span class="fu">c</span>(<span class="st">"YMM"</span><span class="ot">=</span> <span class="st">"Combined"</span> )) </span>
<span id="cb91-210"><a href="#cb91-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-211"><a href="#cb91-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-212"><a href="#cb91-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-213"><a href="#cb91-213" aria-hidden="true" tabindex="-1"></a><span class="co">#saving our raw records beofre filtering</span></span>
<span id="cb91-214"><a href="#cb91-214" aria-hidden="true" tabindex="-1"></a>raw_carprices <span class="ot">&lt;-</span> carprices</span>
<span id="cb91-215"><a href="#cb91-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-216"><a href="#cb91-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-217"><a href="#cb91-217" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtering out the keys that were not mapped (Run these false keys through a vin decoder to get exact matches)</span></span>
<span id="cb91-218"><a href="#cb91-218" aria-hidden="true" tabindex="-1"></a>false_keys <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-219"><a href="#cb91-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(AVG_MSRP))</span>
<span id="cb91-220"><a href="#cb91-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-221"><a href="#cb91-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-222"><a href="#cb91-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-223"><a href="#cb91-223" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing NAs in MSRP from main dataset</span></span>
<span id="cb91-224"><a href="#cb91-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-225"><a href="#cb91-225" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-226"><a href="#cb91-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(AVG_MSRP)) </span>
<span id="cb91-227"><a href="#cb91-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-228"><a href="#cb91-228" aria-hidden="true" tabindex="-1"></a><span class="co">#replace_na(carprices$StdDev_MSRP, 0)</span></span>
<span id="cb91-229"><a href="#cb91-229" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(carprices))</span>
<span id="cb91-230"><a href="#cb91-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-231"><a href="#cb91-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-232"><a href="#cb91-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-233"><a href="#cb91-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE }</span></span>
<span id="cb91-234"><a href="#cb91-234" aria-hidden="true" tabindex="-1"></a><span class="co"># To clean Year, make, Model fields in false_keys, Run Below </span></span>
<span id="cb91-235"><a href="#cb91-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-236"><a href="#cb91-236" aria-hidden="true" tabindex="-1"></a>VinIn <span class="ot">&lt;-</span>false_keys <span class="sc">%&gt;%</span> <span class="fu">select</span>(vin) </span>
<span id="cb91-237"><a href="#cb91-237" aria-hidden="true" tabindex="-1"></a>VinIn <span class="ot">&lt;-</span> VinIn<span class="sc">$</span>vin</span>
<span id="cb91-238"><a href="#cb91-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-239"><a href="#cb91-239" aria-hidden="true" tabindex="-1"></a>decode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb91-240"><a href="#cb91-240" aria-hidden="true" tabindex="-1"></a> VIN<span class="ot">&lt;-</span> <span class="fu">decode_vin</span>(x)}</span>
<span id="cb91-241"><a href="#cb91-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-242"><a href="#cb91-242" aria-hidden="true" tabindex="-1"></a>decoded_keys <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(VinIn,  decode)</span>
<span id="cb91-243"><a href="#cb91-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-244"><a href="#cb91-244" aria-hidden="true" tabindex="-1"></a><span class="co">#Saving the above output as a CSV</span></span>
<span id="cb91-245"><a href="#cb91-245" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(decoded_keys, <span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Owen-Matthew</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">Github</span><span class="sc">\\</span><span class="st">601_Fall_2022</span><span class="sc">\\</span><span class="st">posts</span><span class="sc">\\</span><span class="st">decoded_keys.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb91-246"><a href="#cb91-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-247"><a href="#cb91-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-248"><a href="#cb91-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-249"><a href="#cb91-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-250"><a href="#cb91-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-251"><a href="#cb91-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE}</span></span>
<span id="cb91-252"><a href="#cb91-252" aria-hidden="true" tabindex="-1"></a>false_keys <span class="sc">%&gt;%</span> </span>
<span id="cb91-253"><a href="#cb91-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vin) <span class="sc">%&gt;%</span> </span>
<span id="cb91-254"><a href="#cb91-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-255"><a href="#cb91-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>()</span>
<span id="cb91-256"><a href="#cb91-256" aria-hidden="true" tabindex="-1"></a><span class="co"># #R Studio Desktop Read In</span></span>
<span id="cb91-257"><a href="#cb91-257" aria-hidden="true" tabindex="-1"></a><span class="co"># #Cleaning False keys</span></span>
<span id="cb91-258"><a href="#cb91-258" aria-hidden="true" tabindex="-1"></a>action_keys <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"decoded_keys.csv"</span>)</span>
<span id="cb91-259"><a href="#cb91-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-260"><a href="#cb91-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-261"><a href="#cb91-261" aria-hidden="true" tabindex="-1"></a><span class="co"># #R Studio Cloud Read In</span></span>
<span id="cb91-262"><a href="#cb91-262" aria-hidden="true" tabindex="-1"></a><span class="co"># #Cleaning False keys</span></span>
<span id="cb91-263"><a href="#cb91-263" aria-hidden="true" tabindex="-1"></a><span class="co"># action_keys &lt;- read_csv("/cloud/project/Final_project/decoded_keys.csv")</span></span>
<span id="cb91-264"><a href="#cb91-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-265"><a href="#cb91-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-266"><a href="#cb91-266" aria-hidden="true" tabindex="-1"></a>a_keys <span class="ot">&lt;-</span> action_keys</span>
<span id="cb91-267"><a href="#cb91-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-268"><a href="#cb91-268" aria-hidden="true" tabindex="-1"></a>a_keys <span class="ot">&lt;-</span>  a_keys <span class="sc">%&gt;%</span> </span>
<span id="cb91-269"><a href="#cb91-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(year)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-270"><a href="#cb91-270" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(make)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-271"><a href="#cb91-271" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(model)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-272"><a href="#cb91-272" aria-hidden="true" tabindex="-1"></a> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(VIN)) </span>
<span id="cb91-273"><a href="#cb91-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-274"><a href="#cb91-274" aria-hidden="true" tabindex="-1"></a><span class="co">#Join with Catalog</span></span>
<span id="cb91-275"><a href="#cb91-275" aria-hidden="true" tabindex="-1"></a>a_keys <span class="ot">&lt;-</span>  a_keys <span class="sc">%&gt;%</span> </span>
<span id="cb91-276"><a href="#cb91-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(model_year, make,model, VIN) <span class="sc">%&gt;%</span> </span>
<span id="cb91-277"><a href="#cb91-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year=</span> model_year, <span class="at">make2=</span>make, <span class="at">model2=</span>model) <span class="sc">%&gt;%</span> </span>
<span id="cb91-278"><a href="#cb91-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span> (YMM, model_year, make2, model2, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb91-279"><a href="#cb91-279" aria-hidden="true" tabindex="-1"></a>a_keys <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(a_keys, us_catalog, <span class="fu">c</span>(<span class="st">"YMM"</span><span class="ot">=</span> <span class="st">"Combined"</span> )) </span>
<span id="cb91-280"><a href="#cb91-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-281"><a href="#cb91-281" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking to see if a vehicle was auctioned multiple times, to see if we need to include sale date as a matching key</span></span>
<span id="cb91-282"><a href="#cb91-282" aria-hidden="true" tabindex="-1"></a>unique_check <span class="ot">&lt;-</span> a_keys <span class="sc">%&gt;%</span> </span>
<span id="cb91-283"><a href="#cb91-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">VIN</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-284"><a href="#cb91-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-285"><a href="#cb91-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>() </span>
<span id="cb91-286"><a href="#cb91-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-287"><a href="#cb91-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-290"><a href="#cb91-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-291"><a href="#cb91-291" aria-hidden="true" tabindex="-1"></a><span class="co">#Selecting useful columns in false_keys</span></span>
<span id="cb91-292"><a href="#cb91-292" aria-hidden="true" tabindex="-1"></a>false_keys <span class="ot">&lt;-</span> false_keys <span class="sc">%&gt;%</span></span>
<span id="cb91-293"><a href="#cb91-293" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(trim, body, Body_Type, transmission, vin, state , condition, odometer, color, interior,seller, mmr, sellingprice, saledate)</span>
<span id="cb91-294"><a href="#cb91-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-295"><a href="#cb91-295" aria-hidden="true" tabindex="-1"></a><span class="co">#Join with false keys to get sale records</span></span>
<span id="cb91-296"><a href="#cb91-296" aria-hidden="true" tabindex="-1"></a>cleaned_keys<span class="ot">=</span> <span class="fu">inner_join</span>(a_keys, false_keys, <span class="fu">c</span>(<span class="st">"VIN"</span> <span class="ot">=</span> <span class="st">"vin"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-297"><a href="#cb91-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-298"><a href="#cb91-298" aria-hidden="true" tabindex="-1"></a> <span class="fu">rename</span>(<span class="st">"vin"</span> <span class="ot">=</span> <span class="st">"VIN"</span>)</span>
<span id="cb91-299"><a href="#cb91-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-300"><a href="#cb91-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-301"><a href="#cb91-301" aria-hidden="true" tabindex="-1"></a><span class="co">#get column names &amp; order from carprices</span></span>
<span id="cb91-302"><a href="#cb91-302" aria-hidden="true" tabindex="-1"></a>check_cols <span class="ot">&lt;-</span>  <span class="fu">colnames</span>(carprices) <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()</span>
<span id="cb91-303"><a href="#cb91-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-304"><a href="#cb91-304" aria-hidden="true" tabindex="-1"></a><span class="co">#checking to see if the column order is the same</span></span>
<span id="cb91-305"><a href="#cb91-305" aria-hidden="true" tabindex="-1"></a>cleaned_keys <span class="ot">&lt;-</span> cleaned_keys[, check_cols]</span>
<span id="cb91-306"><a href="#cb91-306" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(cleaned_keys))</span>
<span id="cb91-307"><a href="#cb91-307" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(carprices))</span>
<span id="cb91-308"><a href="#cb91-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-309"><a href="#cb91-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-310"><a href="#cb91-310" aria-hidden="true" tabindex="-1"></a><span class="co">#We managed to clean 30% of the previous NA records; 13632 of 46608 records</span></span>
<span id="cb91-311"><a href="#cb91-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-312"><a href="#cb91-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-315"><a href="#cb91-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-316"><a href="#cb91-316" aria-hidden="true" tabindex="-1"></a><span class="co">#reorganize cleaned keys to rbind with carprices data</span></span>
<span id="cb91-317"><a href="#cb91-317" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(carprices, cleaned_keys)</span>
<span id="cb91-318"><a href="#cb91-318" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(carprices)</span>
<span id="cb91-319"><a href="#cb91-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-320"><a href="#cb91-320" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking for NA values in AVG_MSRP and YMM</span></span>
<span id="cb91-321"><a href="#cb91-321" aria-hidden="true" tabindex="-1"></a><span class="co"># carprices %&gt;% </span></span>
<span id="cb91-322"><a href="#cb91-322" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(AVG_MSRP)) %&gt;% </span></span>
<span id="cb91-323"><a href="#cb91-323" aria-hidden="true" tabindex="-1"></a><span class="co">#   print()</span></span>
<span id="cb91-324"><a href="#cb91-324" aria-hidden="true" tabindex="-1"></a><span class="co"># carprices %&gt;% </span></span>
<span id="cb91-325"><a href="#cb91-325" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(YMM)) %&gt;%</span></span>
<span id="cb91-326"><a href="#cb91-326" aria-hidden="true" tabindex="-1"></a><span class="co">#   print()</span></span>
<span id="cb91-327"><a href="#cb91-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-328"><a href="#cb91-328" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing na records in Error%</span></span>
<span id="cb91-329"><a href="#cb91-329" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span><span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="ot">&lt;-</span> carprices<span class="sc">$</span><span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">replace_na</span>(<span class="dv">0</span>)</span>
<span id="cb91-330"><a href="#cb91-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-331"><a href="#cb91-331" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="sc">&lt;</span> <span class="dv">7</span>)</span>
<span id="cb91-332"><a href="#cb91-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-333"><a href="#cb91-333" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing 677 NA records for Bodytype</span></span>
<span id="cb91-334"><a href="#cb91-334" aria-hidden="true" tabindex="-1"></a>na.body <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(<span class="fu">is.na</span>(Body_Type))</span>
<span id="cb91-335"><a href="#cb91-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-336"><a href="#cb91-336" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Body_Type))</span>
<span id="cb91-337"><a href="#cb91-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-338"><a href="#cb91-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-339"><a href="#cb91-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-340"><a href="#cb91-340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-341"><a href="#cb91-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-342"><a href="#cb91-342" aria-hidden="true" tabindex="-1"></a>•</span>
<span id="cb91-343"><a href="#cb91-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-346"><a href="#cb91-346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-347"><a href="#cb91-347" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the Canadian records</span></span>
<span id="cb91-348"><a href="#cb91-348" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>({</span>
<span id="cb91-349"><a href="#cb91-349" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-350"><a href="#cb91-350" aria-hidden="true" tabindex="-1"></a>  carprices <span class="sc">%&gt;%</span></span>
<span id="cb91-351"><a href="#cb91-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state<span class="sc">==</span> <span class="fu">c</span>(<span class="st">"AB"</span>, <span class="st">"ON"</span>, <span class="st">"QC"</span>, <span class="st">"NS"</span>)) </span>
<span id="cb91-352"><a href="#cb91-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-353"><a href="#cb91-353" aria-hidden="true" tabindex="-1"></a><span class="co"># Excluding Canadian records</span></span>
<span id="cb91-354"><a href="#cb91-354" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span>carprices <span class="sc">%&gt;%</span></span>
<span id="cb91-355"><a href="#cb91-355" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(state<span class="sc">!=</span> <span class="fu">c</span>(<span class="st">"AB"</span>, <span class="st">"ON"</span>, <span class="st">"QC"</span>, <span class="st">"NS"</span>))</span>
<span id="cb91-356"><a href="#cb91-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-357"><a href="#cb91-357" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb91-358"><a href="#cb91-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-359"><a href="#cb91-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-360"><a href="#cb91-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-361"><a href="#cb91-361" aria-hidden="true" tabindex="-1"></a>I'll create a new variable called Launch_date. Since most vehicles of model year x are released in the fall of the the previous year, I'll follow that logic and assume that for all makes.</span>
<span id="cb91-362"><a href="#cb91-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-365"><a href="#cb91-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-366"><a href="#cb91-366" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Launch Date Step 1</span></span>
<span id="cb91-367"><a href="#cb91-367" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(carprices<span class="sc">$</span>year))</span>
<span id="cb91-368"><a href="#cb91-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-369"><a href="#cb91-369" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-370"><a href="#cb91-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">launch_month=</span> <span class="st">"9"</span>, <span class="at">launch_day=</span> <span class="st">"1"</span>, <span class="at">launch_year=</span> (<span class="st">`</span><span class="at">year</span><span class="st">`</span><span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb91-371"><a href="#cb91-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-372"><a href="#cb91-372" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Launch Date Step 2</span></span>
<span id="cb91-373"><a href="#cb91-373" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-374"><a href="#cb91-374" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">launch_date=</span> <span class="fu">make_date</span>(<span class="at">year=</span> <span class="st">`</span><span class="at">launch_year</span><span class="st">`</span>, <span class="at">month =</span> <span class="st">`</span><span class="at">launch_month</span><span class="st">`</span>, <span class="at">day=</span><span class="st">`</span><span class="at">launch_day</span><span class="st">`</span>))</span>
<span id="cb91-375"><a href="#cb91-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-376"><a href="#cb91-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-377"><a href="#cb91-377" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting saledate to a date variable</span></span>
<span id="cb91-378"><a href="#cb91-378" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-379"><a href="#cb91-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(saledate, <span class="at">into=</span> <span class="fu">c</span>(<span class="st">"ddd"</span>, <span class="st">"sale_month"</span>, <span class="st">"sale_day"</span>, <span class="st">"sale_year"</span>, <span class="st">"sale_time"</span>, <span class="st">"GMT"</span>, <span class="st">"TMZ"</span>), <span class="at">sep=</span><span class="st">" "</span>)   </span>
<span id="cb91-380"><a href="#cb91-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-381"><a href="#cb91-381" aria-hidden="true" tabindex="-1"></a><span class="co">#Recoding the format of the sale month</span></span>
<span id="cb91-382"><a href="#cb91-382" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">sale_month2=</span> <span class="fu">recode</span>(sale_month, <span class="st">`</span><span class="at">Jan</span><span class="st">`</span> <span class="ot">=</span><span class="st">"1"</span>, <span class="st">`</span><span class="at">Feb</span><span class="st">`</span><span class="ot">=</span> <span class="st">"2"</span>, <span class="st">`</span><span class="at">Mar</span><span class="st">`</span><span class="ot">=</span><span class="st">"3"</span>, <span class="st">`</span><span class="at">Apr</span><span class="st">`</span><span class="ot">=</span><span class="st">"4"</span>, <span class="st">`</span><span class="at">May</span><span class="st">`</span><span class="ot">=</span><span class="st">"5"</span>, <span class="st">`</span><span class="at">Jun</span><span class="st">`</span><span class="ot">=</span><span class="st">"6"</span>, <span class="st">`</span><span class="at">Jul</span><span class="st">`</span><span class="ot">=</span><span class="st">"7"</span>, <span class="st">`</span><span class="at">Aug</span><span class="st">`</span><span class="ot">=</span><span class="st">"8"</span>, <span class="st">`</span><span class="at">Sep</span><span class="st">`</span><span class="ot">=</span><span class="st">"9"</span>, <span class="st">`</span><span class="at">Oct</span><span class="st">`</span><span class="ot">=</span><span class="st">"10"</span>, <span class="st">`</span><span class="at">Nov</span><span class="st">`</span><span class="ot">=</span><span class="st">"11"</span>, <span class="st">`</span><span class="at">Dec</span><span class="st">`</span><span class="ot">=</span><span class="st">"12"</span> ))</span>
<span id="cb91-383"><a href="#cb91-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-384"><a href="#cb91-384" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Date_Sold</span></span>
<span id="cb91-385"><a href="#cb91-385" aria-hidden="true" tabindex="-1"></a><span class="co">#carprices &lt;- mutate(carprices, sale_year2=sale_year)</span></span>
<span id="cb91-386"><a href="#cb91-386" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">sale_year2=</span>sale_year, <span class="at">Date_Sold =</span> <span class="fu">make_date</span>(<span class="at">year=</span>sale_year2, <span class="at">month =</span> sale_month2, <span class="at">day =</span> sale_day))</span>
<span id="cb91-387"><a href="#cb91-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-388"><a href="#cb91-388" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidyiing up: selecting important columns</span></span>
<span id="cb91-389"><a href="#cb91-389" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-390"><a href="#cb91-390" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(year, make, model, trim, transmission, Body_Type, state, condition, odometer, color, mmr, sellingprice, sale_year, launch_date, Date_Sold, AVG_MSRP, Trim_Count, <span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="st">`</span><span class="at">%MSRP_Range</span><span class="st">`</span>, Segment ) </span>
<span id="cb91-391"><a href="#cb91-391" aria-hidden="true" tabindex="-1"></a><span class="co">#print(head(carprices))</span></span>
<span id="cb91-392"><a href="#cb91-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-393"><a href="#cb91-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-394"><a href="#cb91-394" aria-hidden="true" tabindex="-1"></a>Calculating the age of the vehicle at the time of sale:</span>
<span id="cb91-395"><a href="#cb91-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-398"><a href="#cb91-398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-399"><a href="#cb91-399" aria-hidden="true" tabindex="-1"></a><span class="co">#Age of vehicle</span></span>
<span id="cb91-400"><a href="#cb91-400" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">Age_months=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">difftime</span>(Date_Sold, launch_date, <span class="at">units=</span> <span class="st">"days"</span>))<span class="sc">/</span><span class="dv">30</span>))</span>
<span id="cb91-401"><a href="#cb91-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-402"><a href="#cb91-402" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking for negatives in Vehicle Age</span></span>
<span id="cb91-403"><a href="#cb91-403" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-404"><a href="#cb91-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Age_months) <span class="sc">%&gt;%</span> </span>
<span id="cb91-405"><a href="#cb91-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_months<span class="sc">&lt;</span><span class="dv">0</span>)<span class="co"># %&gt;% </span></span>
<span id="cb91-406"><a href="#cb91-406" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print.difftime()</span></span>
<span id="cb91-407"><a href="#cb91-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-408"><a href="#cb91-408" aria-hidden="true" tabindex="-1"></a><span class="co">#Recoding Vehicle Age</span></span>
<span id="cb91-409"><a href="#cb91-409" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span>carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-410"><a href="#cb91-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_months=</span><span class="fu">recode</span>(Age_months, <span class="st">`</span><span class="at">-8</span><span class="st">`</span><span class="ot">=</span><span class="dv">0</span>))</span>
<span id="cb91-411"><a href="#cb91-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-412"><a href="#cb91-412" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Age in years</span></span>
<span id="cb91-413"><a href="#cb91-413" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span>carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-414"><a href="#cb91-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_years=</span><span class="fu">round</span>(Age_months<span class="sc">/</span><span class="dv">12</span>, <span class="dv">0</span>))</span>
<span id="cb91-415"><a href="#cb91-415" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(carprices))</span>
<span id="cb91-416"><a href="#cb91-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-417"><a href="#cb91-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-418"><a href="#cb91-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-419"><a href="#cb91-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Calculating Retained Value% }</span></span>
<span id="cb91-420"><a href="#cb91-420" aria-hidden="true" tabindex="-1"></a><span class="co">#Retained value</span></span>
<span id="cb91-421"><a href="#cb91-421" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-422"><a href="#cb91-422" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">RV_percent=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">sellingprice</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">AVG_MSRP</span><span class="st">`</span> <span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">1</span>))</span>
<span id="cb91-423"><a href="#cb91-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-424"><a href="#cb91-424" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span>  carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RV_percent <span class="sc">&lt;</span> <span class="dv">125</span>)</span>
<span id="cb91-425"><a href="#cb91-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-426"><a href="#cb91-426" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(carprices))</span>
<span id="cb91-427"><a href="#cb91-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-428"><a href="#cb91-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-429"><a href="#cb91-429" aria-hidden="true" tabindex="-1"></a><span class="co">#How does the distriburion of RV% look?</span></span>
<span id="cb91-430"><a href="#cb91-430" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(carprices<span class="sc">$</span>RV_percent)</span>
<span id="cb91-431"><a href="#cb91-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-432"><a href="#cb91-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-433"><a href="#cb91-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-434"><a href="#cb91-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-435"><a href="#cb91-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-436"><a href="#cb91-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-437"><a href="#cb91-437" aria-hidden="true" tabindex="-1"></a><span class="fu">## Narrative about the data set..</span></span>
<span id="cb91-438"><a href="#cb91-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-439"><a href="#cb91-439" aria-hidden="true" tabindex="-1"></a>This data set contains historical used vehicle auction prices that took place between 1982 and 2015. The data was collected from all Manheim auction houses across the 34 states in the USA. Each observation details a wholesale auction transaction that includes: the vehicle information, state, selling price and the market average price i.e the Manheim Market Report price (MMR) and other specifics about the sale.</span>
<span id="cb91-440"><a href="#cb91-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-441"><a href="#cb91-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-442"><a href="#cb91-442" aria-hidden="true" tabindex="-1"></a><span class="fu">## Potential Research Questions</span></span>
<span id="cb91-443"><a href="#cb91-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-446"><a href="#cb91-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-447"><a href="#cb91-447" aria-hidden="true" tabindex="-1"></a><span class="co">#Establishing vehicle groups</span></span>
<span id="cb91-448"><a href="#cb91-448" aria-hidden="true" tabindex="-1"></a><span class="co">#Error in Nissan records</span></span>
<span id="cb91-449"><a href="#cb91-449" aria-hidden="true" tabindex="-1"></a>mainstream <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Toyota"</span>, <span class="st">"Honda"</span>, <span class="st">"Hyundai"</span>, <span class="st">"Nissan"</span>, <span class="st">"Hyundai"</span>, <span class="st">"Kia"</span>, <span class="st">"Mazda"</span>, <span class="st">"Subaru"</span>, <span class="st">"Volkswagen"</span>)</span>
<span id="cb91-450"><a href="#cb91-450" aria-hidden="true" tabindex="-1"></a>luxury <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BMW"</span>, <span class="st">"Audi"</span>, <span class="st">"Mercedes Benz"</span>, <span class="st">"Porsche"</span>, <span class="st">"Lexus"</span>, <span class="st">"INFINITI"</span>, <span class="st">"Acura"</span>, <span class="st">"Genesis"</span>, <span class="st">"Volvo"</span>, <span class="st">"Cadillac"</span>, <span class="st">"Lincoln"</span>)</span>
<span id="cb91-451"><a href="#cb91-451" aria-hidden="true" tabindex="-1"></a>passenger <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"Sedan"</span>, <span class="st">"SUV"</span>, <span class="st">"Coupe"</span>, <span class="st">"Convertible"</span>, <span class="st">"Wagon"</span>, <span class="st">"Hatchback"</span>)</span>
<span id="cb91-452"><a href="#cb91-452" aria-hidden="true" tabindex="-1"></a>Japanese4 <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"Toyota"</span>, <span class="st">"Honda"</span>, <span class="st">"Nissan"</span>, <span class="st">"Mazda"</span>)</span>
<span id="cb91-453"><a href="#cb91-453" aria-hidden="true" tabindex="-1"></a>Korean <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Kia"</span>, <span class="st">"Hyundai"</span>, <span class="st">"Genesis"</span>)</span>
<span id="cb91-454"><a href="#cb91-454" aria-hidden="true" tabindex="-1"></a>German <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Audi"</span>, <span class="st">"BMW"</span>, <span class="st">"Mercedes Benz"</span>)</span>
<span id="cb91-455"><a href="#cb91-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-456"><a href="#cb91-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-457"><a href="#cb91-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-458"><a href="#cb91-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-459"><a href="#cb91-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-460"><a href="#cb91-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-461"><a href="#cb91-461" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Is there a correlation between mileage, age and condition?</span>
<span id="cb91-462"><a href="#cb91-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-465"><a href="#cb91-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-466"><a href="#cb91-466" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-467"><a href="#cb91-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">mainstream</span><span class="st">`</span>, <span class="st">`</span><span class="at">luxury</span><span class="st">`</span>), Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger) )</span>
<span id="cb91-468"><a href="#cb91-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-469"><a href="#cb91-469" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot2) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span>condition , <span class="at">y =</span> (odometer), <span class="at">color=</span> Age_years) <span class="sc">+</span></span>
<span id="cb91-470"><a href="#cb91-470" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb91-471"><a href="#cb91-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb91-472"><a href="#cb91-472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-473"><a href="#cb91-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-474"><a href="#cb91-474" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>How does mileage affect vehicle sale price/ RV?</span>
<span id="cb91-475"><a href="#cb91-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-478"><a href="#cb91-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-479"><a href="#cb91-479" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-480"><a href="#cb91-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">mainstream</span><span class="st">`</span>, <span class="st">`</span><span class="at">luxury</span><span class="st">`</span>), Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger), RV_percent <span class="sc">&gt;</span><span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-481"><a href="#cb91-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) </span>
<span id="cb91-482"><a href="#cb91-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-483"><a href="#cb91-483" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot2) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">y =</span> RV_percent, <span class="at">x =</span> (odometer)) <span class="sc">+</span></span>
<span id="cb91-484"><a href="#cb91-484" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb91-485"><a href="#cb91-485" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>()</span>
<span id="cb91-486"><a href="#cb91-486" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb91-487"><a href="#cb91-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-488"><a href="#cb91-488" aria-hidden="true" tabindex="-1"></a><span class="co">#Control for Age &amp; condition</span></span>
<span id="cb91-489"><a href="#cb91-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-490"><a href="#cb91-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-491"><a href="#cb91-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-492"><a href="#cb91-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-493"><a href="#cb91-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-494"><a href="#cb91-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-495"><a href="#cb91-495" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>What is there a correlation between condition and Retained value?</span>
<span id="cb91-496"><a href="#cb91-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-499"><a href="#cb91-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-500"><a href="#cb91-500" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-501"><a href="#cb91-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">mainstream</span><span class="st">`</span>, <span class="st">`</span><span class="at">luxury</span><span class="st">`</span>), Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger) ) <span class="sc">%&gt;%</span> </span>
<span id="cb91-502"><a href="#cb91-502" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(Age_years)</span>
<span id="cb91-503"><a href="#cb91-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-504"><a href="#cb91-504" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot2) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span>condition, <span class="at">y =</span> (RV_percent)) <span class="sc">+</span></span>
<span id="cb91-505"><a href="#cb91-505" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>()</span>
<span id="cb91-506"><a href="#cb91-506" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb91-507"><a href="#cb91-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-508"><a href="#cb91-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-509"><a href="#cb91-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-510"><a href="#cb91-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-511"><a href="#cb91-511" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>How does the transaction volume vary by age across volume states</span>
<span id="cb91-512"><a href="#cb91-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-515"><a href="#cb91-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-516"><a href="#cb91-516" aria-hidden="true" tabindex="-1"></a><span class="co">#Analyzing the number of transactions by state by the age </span></span>
<span id="cb91-517"><a href="#cb91-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-518"><a href="#cb91-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-519"><a href="#cb91-519" aria-hidden="true" tabindex="-1"></a>vol.states<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-520"><a href="#cb91-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years <span class="sc">&lt;</span> <span class="dv">7</span>, Age_years <span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-521"><a href="#cb91-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_years, state) <span class="sc">%&gt;%</span> </span>
<span id="cb91-522"><a href="#cb91-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-523"><a href="#cb91-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-524"><a href="#cb91-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb91-525"><a href="#cb91-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-526"><a href="#cb91-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-527"><a href="#cb91-527" aria-hidden="true" tabindex="-1"></a>vol.states <span class="sc">%&gt;%</span> </span>
<span id="cb91-528"><a href="#cb91-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(state, <span class="sc">-</span>n), <span class="at">y=</span> n) <span class="sc">+</span></span>
<span id="cb91-529"><a href="#cb91-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill=</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb91-530"><a href="#cb91-530" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"State"</span>, <span class="at">y=</span><span class="st">"Number of Transactions"</span>) <span class="sc">+</span></span>
<span id="cb91-531"><a href="#cb91-531" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Age_years))<span class="sc">+</span></span>
<span id="cb91-532"><a href="#cb91-532" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtitle</span>(<span class="st">"Number of Transactions by State faceted by Vehicle Age"</span>)</span>
<span id="cb91-533"><a href="#cb91-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-534"><a href="#cb91-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-535"><a href="#cb91-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-536"><a href="#cb91-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-537"><a href="#cb91-537" aria-hidden="true" tabindex="-1"></a>From the above, we see that most vehicles are auctioned between ages 2 and 4 years. This corresponds to the popular lease terms of 24 to 48 months.</span>
<span id="cb91-538"><a href="#cb91-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-539"><a href="#cb91-539" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Which segment retains the best value?</span>
<span id="cb91-540"><a href="#cb91-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-541"><a href="#cb91-541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE}</span></span>
<span id="cb91-542"><a href="#cb91-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-543"><a href="#cb91-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-544"><a href="#cb91-544" aria-hidden="true" tabindex="-1"></a>by_segment <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-545"><a href="#cb91-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years <span class="sc">&lt;</span> <span class="dv">8</span>, Age_years<span class="sc">&gt;</span><span class="dv">0</span>, <span class="sc">!</span><span class="fu">is.na</span>(Segment), Body_Type<span class="sc">==</span> passenger, make<span class="sc">==</span><span class="fu">c</span>(mainstream, luxury)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-546"><a href="#cb91-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_years, Segment, sale_year, Age_months) <span class="sc">%&gt;%</span> </span>
<span id="cb91-547"><a href="#cb91-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-548"><a href="#cb91-548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Segment_RV=</span> <span class="fu">round</span>(<span class="fu">mean</span>(RV_percent), <span class="at">digits=</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-549"><a href="#cb91-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Segment_RV)) <span class="sc">%&gt;%</span></span>
<span id="cb91-550"><a href="#cb91-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>((Age_years)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-551"><a href="#cb91-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>((sale_year)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-552"><a href="#cb91-552" aria-hidden="true" tabindex="-1"></a> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) </span>
<span id="cb91-553"><a href="#cb91-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-554"><a href="#cb91-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">head</span>(by_segment))</span>
<span id="cb91-555"><a href="#cb91-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-556"><a href="#cb91-556" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> by_segment) <span class="sc">+</span> </span>
<span id="cb91-557"><a href="#cb91-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Age_months, <span class="at">y =</span> Segment_RV, <span class="at">color =</span> <span class="st">`</span><span class="at">Segment</span><span class="st">`</span>), <span class="at">se=</span> F) <span class="co">#+</span></span>
<span id="cb91-558"><a href="#cb91-558" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~sale_year)</span></span>
<span id="cb91-559"><a href="#cb91-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-560"><a href="#cb91-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-561"><a href="#cb91-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-562"><a href="#cb91-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-563"><a href="#cb91-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-564"><a href="#cb91-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-567"><a href="#cb91-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-568"><a href="#cb91-568" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the Segments with the highest RV</span></span>
<span id="cb91-569"><a href="#cb91-569" aria-hidden="true" tabindex="-1"></a>best_value_segments <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span></span>
<span id="cb91-570"><a href="#cb91-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years<span class="sc">&gt;</span> <span class="dv">1</span>, Age_years <span class="sc">&lt;</span><span class="dv">6</span>, Body_Type<span class="sc">==</span> passenger, <span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="sc">!</span><span class="fu">is.na</span>(Segment)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-571"><a href="#cb91-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Segment,Age_years,  RV_percent, odometer, condition, model) <span class="sc">%&gt;%</span> </span>
<span id="cb91-572"><a href="#cb91-572" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-573"><a href="#cb91-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">RV_percentage =</span> <span class="fu">mean</span>(RV_percent), <span class="at">odometer=</span><span class="fu">mean</span>(odometer),<span class="at">condition=</span><span class="fu">mean</span>(condition), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-574"><a href="#cb91-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-575"><a href="#cb91-575" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-576"><a href="#cb91-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Segment=</span>Segment, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent), <span class="at">odometer=</span><span class="fu">mean</span>(odometer),<span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-577"><a href="#cb91-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-578"><a href="#cb91-578" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(Segment, Age_years) <span class="sc">%&gt;%</span> </span>
<span id="cb91-579"><a href="#cb91-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Segment=</span>Segment, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent),<span class="at">Mileage=</span><span class="fu">mean</span>(odometer), <span class="at">Condition=</span><span class="fu">mean</span>(condition),  <span class="at">Sample_Size =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-580"><a href="#cb91-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-581"><a href="#cb91-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-582"><a href="#cb91-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>((Age_years))</span>
<span id="cb91-583"><a href="#cb91-583" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb91-584"><a href="#cb91-584" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(best_value_segments)</span>
<span id="cb91-585"><a href="#cb91-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-586"><a href="#cb91-586" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing a few missing fields in Segments that were missing in Catalog</span></span>
<span id="cb91-587"><a href="#cb91-587" aria-hidden="true" tabindex="-1"></a>BVS <span class="ot">&lt;-</span> best_value_segments <span class="sc">%&gt;%</span> </span>
<span id="cb91-588"><a href="#cb91-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Segment)) </span>
<span id="cb91-589"><a href="#cb91-589" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-590"><a href="#cb91-590" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(data = BVS) + </span></span>
<span id="cb91-591"><a href="#cb91-591" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(mapping = aes(x = Age_years, y = RV_percent, color = `Segment`)) +</span></span>
<span id="cb91-592"><a href="#cb91-592" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_smooth(mapping = aes(x = Age_years, y = RV_percent, color = `Segment`), se= F)</span></span>
<span id="cb91-593"><a href="#cb91-593" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb91-594"><a href="#cb91-594" aria-hidden="true" tabindex="-1"></a>BVS <span class="sc">%&gt;%</span> </span>
<span id="cb91-595"><a href="#cb91-595" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> Age_years, <span class="at">y =</span>(RV_percent)) <span class="sc">+</span></span>
<span id="cb91-596"><a href="#cb91-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span> <span class="st">"identity"</span>, <span class="at">fill=</span><span class="st">"darkred"</span>) <span class="sc">+</span></span>
<span id="cb91-597"><a href="#cb91-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Segment)</span>
<span id="cb91-598"><a href="#cb91-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-599"><a href="#cb91-599" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-600"><a href="#cb91-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-601"><a href="#cb91-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-602"><a href="#cb91-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-605"><a href="#cb91-605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-606"><a href="#cb91-606" aria-hidden="true" tabindex="-1"></a><span class="co">#Volume models</span></span>
<span id="cb91-607"><a href="#cb91-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-608"><a href="#cb91-608" aria-hidden="true" tabindex="-1"></a>vol.models<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-609"><a href="#cb91-609" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>( Age_years <span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-610"><a href="#cb91-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb91-611"><a href="#cb91-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-612"><a href="#cb91-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-613"><a href="#cb91-613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-614"><a href="#cb91-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb91-615"><a href="#cb91-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-616"><a href="#cb91-616" aria-hidden="true" tabindex="-1"></a>vol.models.passenger <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-617"><a href="#cb91-617" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(Age_years <span class="sc">&gt;</span><span class="dv">0</span>, Body_Type<span class="sc">==</span> passenger) <span class="sc">%&gt;%</span> </span>
<span id="cb91-618"><a href="#cb91-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb91-619"><a href="#cb91-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-620"><a href="#cb91-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-621"><a href="#cb91-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-622"><a href="#cb91-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb91-623"><a href="#cb91-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-624"><a href="#cb91-624" aria-hidden="true" tabindex="-1"></a>popular.models <span class="ot">&lt;-</span>  vol.models.passenger<span class="sc">$</span>model</span>
<span id="cb91-625"><a href="#cb91-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-626"><a href="#cb91-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-627"><a href="#cb91-627" aria-hidden="true" tabindex="-1"></a>vol.models <span class="sc">%&gt;%</span> </span>
<span id="cb91-628"><a href="#cb91-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(model, <span class="sc">-</span>n), <span class="at">y=</span> n) <span class="sc">+</span></span>
<span id="cb91-629"><a href="#cb91-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill=</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb91-630"><a href="#cb91-630" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Model"</span>, <span class="at">y=</span><span class="st">"Number of Wholesale Transactions"</span>)<span class="sc">+</span></span>
<span id="cb91-631"><a href="#cb91-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Top Selling Used Vehicles"</span>)</span>
<span id="cb91-632"><a href="#cb91-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-633"><a href="#cb91-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-634"><a href="#cb91-634" aria-hidden="true" tabindex="-1"></a>vol.models.passenger <span class="sc">%&gt;%</span> </span>
<span id="cb91-635"><a href="#cb91-635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(model, <span class="sc">-</span>n), <span class="at">y=</span> n) <span class="sc">+</span></span>
<span id="cb91-636"><a href="#cb91-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill=</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb91-637"><a href="#cb91-637" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Model"</span>, <span class="at">y=</span><span class="st">"Number of Transactions for Top  Selling Models"</span>)</span>
<span id="cb91-638"><a href="#cb91-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-639"><a href="#cb91-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-640"><a href="#cb91-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-641"><a href="#cb91-641" aria-hidden="true" tabindex="-1"></a>Do the most popular vehicles retain the best value or is it the opposite? Let's explore below:</span>
<span id="cb91-642"><a href="#cb91-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-643"><a href="#cb91-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-644"><a href="#cb91-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-647"><a href="#cb91-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-648"><a href="#cb91-648" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the models with the highest RV</span></span>
<span id="cb91-649"><a href="#cb91-649" aria-hidden="true" tabindex="-1"></a>best_value_models <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span></span>
<span id="cb91-650"><a href="#cb91-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years<span class="sc">&gt;</span> <span class="dv">1</span>, Age_years <span class="sc">&lt;</span><span class="dv">6</span>, Body_Type<span class="sc">==</span> passenger, <span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-651"><a href="#cb91-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(make, model,Age_years,  RV_percent, odometer, condition, Segment) <span class="sc">%&gt;%</span> </span>
<span id="cb91-652"><a href="#cb91-652" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-653"><a href="#cb91-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">RV_percentage =</span> <span class="fu">mean</span>(RV_percent), <span class="at">odometer=</span><span class="fu">mean</span>(odometer), <span class="at">condition=</span><span class="fu">mean</span>(condition), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-654"><a href="#cb91-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-655"><a href="#cb91-655" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-656"><a href="#cb91-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">make=</span>make, <span class="at">model=</span>model, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent), <span class="at">odometer=</span><span class="fu">mean</span>(odometer),<span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-657"><a href="#cb91-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-658"><a href="#cb91-658" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(make, model, Age_years) <span class="sc">%&gt;%</span> </span>
<span id="cb91-659"><a href="#cb91-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">make=</span>make, <span class="at">model=</span>model, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent), <span class="at">mileage=</span><span class="fu">mean</span>(odometer), <span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-660"><a href="#cb91-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-661"><a href="#cb91-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-662"><a href="#cb91-662" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-663"><a href="#cb91-663" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Filtering a sample size 20 or more</span></span>
<span id="cb91-664"><a href="#cb91-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">19</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-665"><a href="#cb91-665" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>((Age_years))</span>
<span id="cb91-666"><a href="#cb91-666" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(best_value_models)</span>
<span id="cb91-667"><a href="#cb91-667" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-668"><a href="#cb91-668" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-669"><a href="#cb91-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-670"><a href="#cb91-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-671"><a href="#cb91-671" aria-hidden="true" tabindex="-1"></a>How does the RV% compare among volume models?</span>
<span id="cb91-672"><a href="#cb91-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-675"><a href="#cb91-675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-676"><a href="#cb91-676" aria-hidden="true" tabindex="-1"></a><span class="co"># vol.models %&gt;% </span></span>
<span id="cb91-677"><a href="#cb91-677" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot()+ aes(y= RV_percent , x=Age_months)</span></span>
<span id="cb91-678"><a href="#cb91-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-679"><a href="#cb91-679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-680"><a href="#cb91-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-681"><a href="#cb91-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-682"><a href="#cb91-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-683"><a href="#cb91-683" aria-hidden="true" tabindex="-1"></a>Popular makes</span>
<span id="cb91-684"><a href="#cb91-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-687"><a href="#cb91-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-688"><a href="#cb91-688" aria-hidden="true" tabindex="-1"></a><span class="co">#Distribution of makes</span></span>
<span id="cb91-689"><a href="#cb91-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-690"><a href="#cb91-690" aria-hidden="true" tabindex="-1"></a>vol.brands<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-691"><a href="#cb91-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years <span class="sc">&lt;</span> <span class="dv">7</span>, Age_years <span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-692"><a href="#cb91-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(make) <span class="sc">%&gt;%</span> </span>
<span id="cb91-693"><a href="#cb91-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-694"><a href="#cb91-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-695"><a href="#cb91-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb91-696"><a href="#cb91-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-697"><a href="#cb91-697" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vol.brands)</span>
<span id="cb91-698"><a href="#cb91-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-699"><a href="#cb91-699" aria-hidden="true" tabindex="-1"></a>vol.brands <span class="sc">%&gt;%</span> </span>
<span id="cb91-700"><a href="#cb91-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(make, <span class="sc">-</span>n), <span class="at">y=</span> n) <span class="sc">+</span></span>
<span id="cb91-701"><a href="#cb91-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill=</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb91-702"><a href="#cb91-702" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Brand"</span>, <span class="at">y=</span><span class="st">"Number of Transactions"</span>) <span class="sc">+</span></span>
<span id="cb91-703"><a href="#cb91-703" aria-hidden="true" tabindex="-1"></a><span class="co">#facet_wrap(vars(Age_years))+</span></span>
<span id="cb91-704"><a href="#cb91-704" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtitle</span>(<span class="st">"Popular Brands"</span>)</span>
<span id="cb91-705"><a href="#cb91-705" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-706"><a href="#cb91-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-707"><a href="#cb91-707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE}</span></span>
<span id="cb91-708"><a href="#cb91-708" aria-hidden="true" tabindex="-1"></a><span class="co">#Japanese makes</span></span>
<span id="cb91-709"><a href="#cb91-709" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-710"><a href="#cb91-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years<span class="sc">&lt;</span><span class="dv">7</span>, make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">"Toyota"</span>, <span class="st">"Honda"</span>, <span class="st">"Nissan"</span>, <span class="st">"Hyundai"</span>), Body_Type<span class="sc">==</span> (<span class="st">"Sedan"</span>))</span>
<span id="cb91-711"><a href="#cb91-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-712"><a href="#cb91-712" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot) <span class="sc">+</span> </span>
<span id="cb91-713"><a href="#cb91-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Age_months, <span class="at">y =</span> RV_percent, <span class="at">color =</span> <span class="st">`</span><span class="at">make</span><span class="st">`</span>))</span>
<span id="cb91-714"><a href="#cb91-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-715"><a href="#cb91-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-716"><a href="#cb91-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-717"><a href="#cb91-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-718"><a href="#cb91-718" aria-hidden="true" tabindex="-1"></a>Best mainstream cars to buy post-2015?</span>
<span id="cb91-719"><a href="#cb91-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-720"><a href="#cb91-720" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE}</span></span>
<span id="cb91-721"><a href="#cb91-721" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-722"><a href="#cb91-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(make<span class="sc">==</span> mainstream, Age_years <span class="sc">==</span> <span class="dv">2</span>, <span class="st">`</span><span class="at">%MSRP_Range</span><span class="st">`</span> <span class="sc">&lt;</span><span class="dv">50</span>, Body_Type<span class="sc">==</span> passenger) <span class="sc">%&gt;%</span> </span>
<span id="cb91-723"><a href="#cb91-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb91-724"><a href="#cb91-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-725"><a href="#cb91-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb91-726"><a href="#cb91-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-727"><a href="#cb91-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-728"><a href="#cb91-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-729"><a href="#cb91-729" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-730"><a href="#cb91-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-731"><a href="#cb91-731" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-732"><a href="#cb91-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-733"><a href="#cb91-733" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-734"><a href="#cb91-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-735"><a href="#cb91-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-736"><a href="#cb91-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-737"><a href="#cb91-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-738"><a href="#cb91-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-739"><a href="#cb91-739" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb91-740"><a href="#cb91-740" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb91-741"><a href="#cb91-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-742"><a href="#cb91-742" aria-hidden="true" tabindex="-1"></a><span class="co">#Monthly mileage by state</span></span>
<span id="cb91-743"><a href="#cb91-743" aria-hidden="true" tabindex="-1"></a>plot7 <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb91-744"><a href="#cb91-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">mainstream</span><span class="st">`</span>, <span class="st">`</span><span class="at">luxury</span><span class="st">`</span>), Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger) )</span>
<span id="cb91-745"><a href="#cb91-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-746"><a href="#cb91-746" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot7) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span>state , <span class="at">y =</span> ((odometer)<span class="sc">/</span> Age_months)) <span class="sc">+</span></span>
<span id="cb91-747"><a href="#cb91-747" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) </span>
<span id="cb91-748"><a href="#cb91-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-749"><a href="#cb91-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-750"><a href="#cb91-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-751"><a href="#cb91-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-752"><a href="#cb91-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-753"><a href="#cb91-753" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb91-754"><a href="#cb91-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-755"><a href="#cb91-755" aria-hidden="true" tabindex="-1"></a><span class="fu">## </span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>