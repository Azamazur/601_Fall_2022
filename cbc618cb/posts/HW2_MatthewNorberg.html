<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Matthew Norberg">
<meta name="dcterms.date" content="2022-10-11">

<title>DACSS 601: Data Science Fundamentals - FALL 2022 - Olympic Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<meta name="twitter:title" content="DACSS 601: Data Science Fundamentals - FALL 2022 - Olympic Analysis">
<meta name="twitter:description" content="I choose to investigate a dataset containing information about the Olympic Games between 1896 and 2016. The data set is read in and displayed using the code below.">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <img src="../images/UMass White Wordmark Horiz.png" alt="">
    <span class="navbar-title">DACSS 601: Data Science Fundamentals - FALL 2022</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page">Fall 2022 Posts</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">Contributors</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss">DACSS</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DACSS/601_Fall_2022"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Olympic Analysis</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Course information</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Syllabus.html" class="sidebar-item-text sidebar-link">Overview</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../instructional_team.html" class="sidebar-item-text sidebar-link">Instructional Team</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course_schedule.html" class="sidebar-item-text sidebar-link">Course Schedule</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Weekly materials</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Fall 2022 posts</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://dacss.github.io/601_Fall_2022_final_posts/" class="sidebar-item-text sidebar-link">final posts</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-description" id="toc-data-description" class="nav-link active" data-scroll-target="#data-description">Data Description</a></li>
  <li><a href="#cleaning-the-data" id="toc-cleaning-the-data" class="nav-link" data-scroll-target="#cleaning-the-data">Cleaning The Data</a>
  <ul class="collapse">
  <li><a href="#initial-transformations" id="toc-initial-transformations" class="nav-link" data-scroll-target="#initial-transformations">Initial Transformations</a></li>
  <li><a href="#handling-missing-values" id="toc-handling-missing-values" class="nav-link" data-scroll-target="#handling-missing-values">Handling Missing Values</a></li>
  <li><a href="#cleaning-sport-event" id="toc-cleaning-sport-event" class="nav-link" data-scroll-target="#cleaning-sport-event">Cleaning Sport &amp; Event</a></li>
  <li><a href="#reordering-arranging" id="toc-reordering-arranging" class="nav-link" data-scroll-target="#reordering-arranging">Reordering &amp; Arranging</a></li>
  </ul></li>
  <li><a href="#saving-cleaned-data" id="toc-saving-cleaned-data" class="nav-link" data-scroll-target="#saving-cleaned-data">Saving Cleaned Data</a></li>
  <li><a href="#potential-research-questions" id="toc-potential-research-questions" class="nav-link" data-scroll-target="#potential-research-questions">Potential Research Questions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Olympic Analysis</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">hw2</div>
    <div class="quarto-category">Olympic_Data</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Matthew Norberg </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 11, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="data-description" class="level2">
<h2 class="anchored" data-anchor-id="data-description">Data Description</h2>
<p>I choose to investigate a dataset containing information about the <a href="https://www.kaggle.com/datasets/heesoo37/120-years-of-olympic-history-athletes-and-results?select=athlete_events.csv">Olympic Games</a> between 1896 and 2016. The data set is read in and displayed using the code below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Read in the data set</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>athletes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'./Data/athlete_events.csv'</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>noc <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'./Data/noc_regions.csv'</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># Display the athlete data set</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>athletes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 271,116 × 15
      ID Name     Sex     Age Height Weight Team  NOC   Games  Year Season City 
   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;
 1     1 A Dijia… M        24    180     80 China CHN   1992…  1992 Summer Barc…
 2     2 A Lamusi M        23    170     60 China CHN   2012…  2012 Summer Lond…
 3     3 Gunnar … M        24     NA     NA Denm… DEN   1920…  1920 Summer Antw…
 4     4 Edgar L… M        34     NA     NA Denm… DEN   1900…  1900 Summer Paris
 5     5 Christi… F        21    185     82 Neth… NED   1988…  1988 Winter Calg…
 6     5 Christi… F        21    185     82 Neth… NED   1988…  1988 Winter Calg…
 7     5 Christi… F        25    185     82 Neth… NED   1992…  1992 Winter Albe…
 8     5 Christi… F        25    185     82 Neth… NED   1992…  1992 Winter Albe…
 9     5 Christi… F        27    185     82 Neth… NED   1994…  1994 Winter Lill…
10     5 Christi… F        27    185     82 Neth… NED   1994…  1994 Winter Lill…
# … with 271,106 more rows, and 3 more variables: Sport &lt;chr&gt;, Event &lt;chr&gt;,
#   Medal &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Display the noc data set</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>noc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 230 × 3
   NOC   region      notes               
   &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;               
 1 AFG   Afghanistan &lt;NA&gt;                
 2 AHO   Curacao     Netherlands Antilles
 3 ALB   Albania     &lt;NA&gt;                
 4 ALG   Algeria     &lt;NA&gt;                
 5 AND   Andorra     &lt;NA&gt;                
 6 ANG   Angola      &lt;NA&gt;                
 7 ANT   Antigua     Antigua and Barbuda 
 8 ANZ   Australia   Australasia         
 9 ARG   Argentina   &lt;NA&gt;                
10 ARM   Armenia     &lt;NA&gt;                
# … with 220 more rows</code></pre>
</div>
</div>
<p>The dataset comes as a set of two csv files: ‘athlete_events’ and ‘noc_regions’ where each file represents a table in a relational database. The ‘athlete_events’ table contains most of the information that I am interested in. Each row in this table contains information about an athlete who competed in an Olympic event. Note that athletes can occur in the table more than once if they competed in multiple events or games. A good example of this is Michael Phelps who appears in the athletes table many times.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Find all the rows containing information about Michael Phelps</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="fu">filter</span>(athletes, <span class="fu">str_detect</span>(Name, <span class="st">"Michael"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(Name, <span class="st">"Phelps"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(ID, NOC, Sex, Height, Weight, Season))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 9
   Name                      Age Team        Games  Year City  Sport Event Medal
   &lt;chr&gt;                   &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 Michael Fred Phelps, II    15 United Sta… 2000…  2000 Sydn… Swim… Swim… &lt;NA&gt; 
 2 Michael Fred Phelps, II    19 United Sta… 2004…  2004 Athi… Swim… Swim… Bron…
 3 Michael Fred Phelps, II    19 United Sta… 2004…  2004 Athi… Swim… Swim… Bron…
 4 Michael Fred Phelps, II    19 United Sta… 2004…  2004 Athi… Swim… Swim… Gold 
 5 Michael Fred Phelps, II    19 United Sta… 2004…  2004 Athi… Swim… Swim… Gold 
 6 Michael Fred Phelps, II    19 United Sta… 2004…  2004 Athi… Swim… Swim… Gold 
 7 Michael Fred Phelps, II    19 United Sta… 2004…  2004 Athi… Swim… Swim… Gold 
 8 Michael Fred Phelps, II    19 United Sta… 2004…  2004 Athi… Swim… Swim… Gold 
 9 Michael Fred Phelps, II    19 United Sta… 2004…  2004 Athi… Swim… Swim… Gold 
10 Michael Fred Phelps, II    23 United Sta… 2008…  2008 Beij… Swim… Swim… Gold 
# … with 20 more rows</code></pre>
</div>
</div>
<p>Each row in the athletes table contains the National Olympic Committee that they are competing for which is stored as a three letter code in the ‘NOC’ column. The ‘NOC’ column serves as a foreign key to the ‘noc_regions’ table. The ‘noc_regions’ table maps the National Olympic Committee code to its corresponding country and provides additional notes about the committee. For example, consider this row in ‘noc_regions’: (HKG, China, Hong Kong). This tells us that the code HKG corresponds Hong Kong Olympic Committee in China.</p>
<p>In the majority of the cases, the ‘notes’ column of the ‘noc_regions’ table is empty. The case I gave in the previous example is an outlier case in which it is present. In cases where it is present, it often provides another way besides the NOC code to distinguish between two committees from the same region. The code chunk below display all the entries in the ‘noc_regions’ table that have notes associated with it. Notice that many of the rows in the table have the same region.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># List the countries have non-null values in 'notes' column</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>noc <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(notes)) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">arrange</span>(region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 3
   NOC   region                      notes                      
   &lt;chr&gt; &lt;chr&gt;                       &lt;chr&gt;                      
 1 ANT   Antigua                     Antigua and Barbuda        
 2 ANZ   Australia                   Australasia                
 3 NFL   Canada                      Newfoundland               
 4 HKG   China                       Hong Kong                  
 5 AHO   Curacao                     Netherlands Antilles       
 6 BOH   Czech Republic              Bohemia                    
 7 CRT   Greece                      Crete                      
 8 IOA   Individual Olympic Athletes Individual Olympic Athletes
 9 NBO   Malaysia                    North Borneo               
10 SKN   Saint Kitts                 Turks and Caicos Islands   
# … with 11 more rows</code></pre>
</div>
</div>
</section>
<section id="cleaning-the-data" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-the-data">Cleaning The Data</h2>
<section id="initial-transformations" class="level3">
<h3 class="anchored" data-anchor-id="initial-transformations">Initial Transformations</h3>
<p>The data was collected in csv format, which made it easy to read into a tibble. However, the data is not yet tidy. We will need to perform cleaning operations to make the data neater for analysis.</p>
<p>We can start by dropping the ‘Games’ column. We don’t need the ‘Games’ column because each entry in the column is a combination of the ‘Year’ and ‘Season’ columns which are already present in the data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Get rid of id &amp; games column</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>athletes <span class="ot">&lt;-</span> <span class="fu">select</span>(athletes, <span class="sc">-</span><span class="fu">c</span>(Games))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we can add the region from the ‘noc_region’ file to the athletes tibble so that we only have one tibble to work with. I choose to drop the ‘notes’ column in the noc file because most of the values are not available and the values which are available don’t provide much useful information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Combine information from noc table</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>athletes <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(athletes, noc) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>(notes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can clean up the ‘Medal’ column by replacing the values that are not available with the string “None”. Based on the context of the data set, we can assume that a NA in this column means that the athlete did not win a Medal in that event. Therefore, replacing these values with “None” seems logical.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Switch NA in Medal to None</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>athletes <span class="ot">&lt;-</span> athletes <span class="sc">%&gt;%</span> <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">Medal =</span> <span class="st">"None"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="handling-missing-values" class="level3">
<h3 class="anchored" data-anchor-id="handling-missing-values">Handling Missing Values</h3>
<p>There are four columns in the data set which contain missing values: ‘Region’, ‘Age’, ‘Height’, and ‘Weight’. I started by handling the missing values in the ‘region’ column first because it is the simplist. We can find the ‘NOC’ associated with unknown regions by querying the ‘noc_regions’ data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Display NA in region</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="fu">filter</span>(noc, <span class="fu">is.na</span>(region))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  NOC   region notes               
  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;               
1 ROT   &lt;NA&gt;   Refugee Olympic Team
2 TUV   &lt;NA&gt;   Tuvalu              
3 UNK   &lt;NA&gt;   Unknown             </code></pre>
</div>
</div>
<p>We know that any row in athletes that has an ‘NOC’ value of ‘ROT’, ‘TUV’, or ‘UNK’ will have a value in the ‘Region’ column that is NA. I think it would be sensible to replace the NA values according to the table below.</p>
<table class="table">
<thead>
<tr class="header">
<th>NOC</th>
<th>Region</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ROT</td>
<td>None</td>
<td>Regugee Olympic Team</td>
</tr>
<tr class="even">
<td>TUV</td>
<td>Tuvala</td>
<td>Tuvala</td>
</tr>
<tr class="odd">
<td>UNK</td>
<td>Unkown</td>
<td>Unknown</td>
</tr>
</tbody>
</table>
<p>The Refugee Olympic Team does not have a region, so I think it is sensible to replace those missing values with “None”. I did a google search and learned that <a href="https://en.wikipedia.org/wiki/Tuvalu">Tuvala</a> is a small indpenent island nation so it makes sense to replace those missing values with “Tuvala”. Lastly, I think it is fair to replace the missing values associated with the UNK NOC as “Unknown”. The code below changes the missing values according to the table above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Fill in missing values in Region column</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>athletes <span class="ot">&lt;-</span> athletes <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>            <span class="fu">mutate</span>(<span class="at">Temp =</span> <span class="fu">case_when</span>(NOC <span class="sc">==</span> <span class="st">"ROT"</span> <span class="sc">~</span> <span class="st">"None"</span>,</span>
<span id="cb15-4"><a href="#cb15-4"></a>                                      NOC <span class="sc">==</span> <span class="st">"TUV"</span> <span class="sc">~</span> <span class="st">"Tuvala"</span>,</span>
<span id="cb15-5"><a href="#cb15-5"></a>                                      NOC <span class="sc">==</span> <span class="st">"UNK"</span> <span class="sc">~</span> <span class="st">"Unknown"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>            <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(region) <span class="sc">~</span> Temp,</span>
<span id="cb15-7"><a href="#cb15-7"></a>                                      <span class="sc">!</span><span class="fu">is.na</span>(region) <span class="sc">~</span> region)) <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>            <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(region, Temp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s handle the missing values in the ‘Age’, ‘Height’, and ‘Weight’ columns next. Suppose we find a missing value in the ‘Age’ column. I think a reasonable idea would be to replace the missing value with the average age during the Olympic games that occurred in that year. We know that ‘Year’ column of the data set does not contain any missing values. Therefore, if we find a missing value in the ‘Age’ column, we can extract the value of the ‘Year’ column in that row and we know it will not be missing. Then we can calculate the average age during that year and replace the missing value with the average value. Using this approach, we can replace all the missing values in these columns.</p>
<p>First, let’s calculate the average age, height, and weight for each year in the data set. This is calculated and stored in the tibble using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Compute average age, height, and weight by years</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>AverageValues <span class="ot">&lt;-</span> athletes <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>                 <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>                 <span class="fu">summarise</span>(<span class="at">AverageAge =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span> <span class="dv">0</span>),</span>
<span id="cb16-5"><a href="#cb16-5"></a>                           <span class="at">AverageHeight =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span> <span class="dv">0</span>),</span>
<span id="cb16-6"><a href="#cb16-6"></a>                           <span class="at">AverageWeight =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span> <span class="dv">1</span>))</span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co"># Display the results</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>AverageValues</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 4
    Year AverageAge AverageHeight AverageWeight
   &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
 1  1896         24           173          71.4
 2  1900         29           177          74.6
 3  1904         27           176          72.2
 4  1906         27           178          75.9
 5  1908         27           178          75.4
 6  1912         28           177          73.1
 7  1920         29           176          73.1
 8  1924         28           175          71.7
 9  1928         29           175          71  
10  1932         33           174          70.5
# … with 25 more rows</code></pre>
</div>
</div>
<p>Now that we have computed the averages, it is time to replace the missing values. The ‘cleanColumn’ function cleans all of the columns mentioned above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Function to clean age, height, and weight</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>cleanColumn <span class="ot">&lt;-</span> <span class="cf">function</span>(column, indx) {</span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="co"># Iterate along the age column</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(column)) {</span>
<span id="cb18-5"><a href="#cb18-5"></a>    <span class="co"># Extract the current age</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>    cVal <span class="ot">&lt;-</span> column[[i]]</span>
<span id="cb18-7"><a href="#cb18-7"></a>    <span class="co"># Check for NA value</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>    <span class="cf">if</span> (<span class="fu">is.na</span>(cVal)) {</span>
<span id="cb18-9"><a href="#cb18-9"></a>      <span class="co"># Extract year from the row</span></span>
<span id="cb18-10"><a href="#cb18-10"></a>      cYear <span class="ot">&lt;-</span> <span class="fu">slice</span>(athletes, i)<span class="sc">$</span>Year[[<span class="dv">1</span>]]</span>
<span id="cb18-11"><a href="#cb18-11"></a>      <span class="co"># Replace the NA value with the average age from year</span></span>
<span id="cb18-12"><a href="#cb18-12"></a>      column[[i]] <span class="ot">&lt;-</span> <span class="fu">filter</span>(AverageValues, Year <span class="sc">==</span> cYear)[[indx]][[<span class="dv">1</span>]]</span>
<span id="cb18-13"><a href="#cb18-13"></a>    }</span>
<span id="cb18-14"><a href="#cb18-14"></a>  }</span>
<span id="cb18-15"><a href="#cb18-15"></a>  <span class="co"># Return cleaned column</span></span>
<span id="cb18-16"><a href="#cb18-16"></a>  <span class="fu">return</span>(column)</span>
<span id="cb18-17"><a href="#cb18-17"></a>}</span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="co"># Set age, height, and weight to cleaned version</span></span>
<span id="cb18-19"><a href="#cb18-19"></a>athletes<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">cleanColumn</span>(athletes<span class="sc">$</span>Age, <span class="dv">2</span>)</span>
<span id="cb18-20"><a href="#cb18-20"></a>athletes<span class="sc">$</span>Height <span class="ot">&lt;-</span> <span class="fu">cleanColumn</span>(athletes<span class="sc">$</span>Height, <span class="dv">3</span>)</span>
<span id="cb18-21"><a href="#cb18-21"></a>athletes<span class="sc">$</span>Weight <span class="ot">&lt;-</span> <span class="fu">cleanColumn</span>(athletes<span class="sc">$</span>Weight, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cleaning-sport-event" class="level3">
<h3 class="anchored" data-anchor-id="cleaning-sport-event">Cleaning Sport &amp; Event</h3>
<p>There is another transformation I would like to perform to make the data set a bit cleaner. Take a look at the first few values in the ‘Sport’ and ‘Event’ column. They are presented below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Display first few rows of Sport and Event columns</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>athletes <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">select</span>(Sport, Event) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Sport         Event                             
  &lt;chr&gt;         &lt;chr&gt;                             
1 Basketball    Basketball Men's Basketball       
2 Judo          Judo Men's Extra-Lightweight      
3 Football      Football Men's Football           
4 Tug-Of-War    Tug-Of-War Men's Tug-Of-War       
5 Speed Skating Speed Skating Women's 500 metres  
6 Speed Skating Speed Skating Women's 1,000 metres</code></pre>
</div>
</div>
<p>Notice how the first word or set of words in the ‘Event’ column is the same exact string in the ‘Sport’ column. The code chunk below confirms that this pattern is true throughout the entire data set. Note, I did not evaluate this code to speed up the rendering process. However, the output can be verified by running this qmd file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>testCols <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="co"># Iterate along sport column</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(athletes<span class="sc">$</span>Sport)) {</span>
<span id="cb21-4"><a href="#cb21-4"></a>    <span class="co"># Get the sport and event string at row i</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>    <span class="co"># Split each string on space character</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>    sport <span class="ot">&lt;-</span> <span class="fu">str_split</span>(athletes<span class="sc">$</span>Sport[[i]], <span class="st">" "</span>)[[<span class="dv">1</span>]]</span>
<span id="cb21-7"><a href="#cb21-7"></a>    event <span class="ot">&lt;-</span> <span class="fu">str_split</span>(athletes<span class="sc">$</span>Event[[i]], <span class="st">" "</span>)[[<span class="dv">1</span>]]</span>
<span id="cb21-8"><a href="#cb21-8"></a>    <span class="co"># Iterate over items in sport list</span></span>
<span id="cb21-9"><a href="#cb21-9"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(sport)) {</span>
<span id="cb21-10"><a href="#cb21-10"></a>      <span class="co"># Check to see if each item in sport is equivalent to corresponding item in event</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>      <span class="cf">if</span> (sport[[j]] <span class="sc">!=</span> event[[j]]) {</span>
<span id="cb21-12"><a href="#cb21-12"></a>        <span class="co"># If it is not equivalent -&gt; stop and display sport and event which breaks pattern</span></span>
<span id="cb21-13"><a href="#cb21-13"></a>        <span class="fu">cat</span>(<span class="st">"BREAK</span><span class="sc">\n</span><span class="st">"</span>, sport, <span class="st">" "</span>, event, <span class="st">"</span><span class="sc">\n</span><span class="st">Pattern does not hold"</span>)</span>
<span id="cb21-14"><a href="#cb21-14"></a>        <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb21-15"><a href="#cb21-15"></a>      }</span>
<span id="cb21-16"><a href="#cb21-16"></a>    }</span>
<span id="cb21-17"><a href="#cb21-17"></a>  }</span>
<span id="cb21-18"><a href="#cb21-18"></a>  <span class="co"># If we get here, then the property holds for the entire data set</span></span>
<span id="cb21-19"><a href="#cb21-19"></a>  <span class="fu">cat</span>(<span class="st">"Pattern holds for entire data set</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-20"><a href="#cb21-20"></a>  <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb21-21"><a href="#cb21-21"></a>}</span>
<span id="cb21-22"><a href="#cb21-22"></a><span class="fu">testCols</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I would like to remove the first few words that in the ‘Event’ column that are also present in the ‘Sport’ column. This will clean up the data set even more. Furthermore, we are not losing any information because we have confirmed that everything we are throwing away appears in the ‘Sport’ column. The following chunk of code cleans the ‘Event’ column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Function to clean event column</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>cleanEvent <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="co"># Iterate along and event columns</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(athletes<span class="sc">$</span>Sport)) {</span>
<span id="cb22-5"><a href="#cb22-5"></a>    <span class="co"># Split sport and event string at row i on space character</span></span>
<span id="cb22-6"><a href="#cb22-6"></a>    sport <span class="ot">&lt;-</span> <span class="fu">str_split</span>(athletes<span class="sc">$</span>Sport[[i]], <span class="st">" "</span>)[[<span class="dv">1</span>]]</span>
<span id="cb22-7"><a href="#cb22-7"></a>    event <span class="ot">&lt;-</span> <span class="fu">str_split</span>(athletes<span class="sc">$</span>Event[[i]], <span class="st">" "</span>)[[<span class="dv">1</span>]]</span>
<span id="cb22-8"><a href="#cb22-8"></a>    <span class="co"># Empty string to store new event</span></span>
<span id="cb22-9"><a href="#cb22-9"></a>    newEvent <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb22-10"><a href="#cb22-10"></a></span>
<span id="cb22-11"><a href="#cb22-11"></a>    <span class="co"># Iterate along event list</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(event)) {</span>
<span id="cb22-13"><a href="#cb22-13"></a>      <span class="co"># Once we get past the length of sport, start piecing together newEvent</span></span>
<span id="cb22-14"><a href="#cb22-14"></a>      <span class="cf">if</span> (j <span class="sc">&gt;</span> <span class="fu">length</span>(sport)) {</span>
<span id="cb22-15"><a href="#cb22-15"></a>        newEvent <span class="ot">=</span> <span class="fu">str_c</span>(newEvent, event[[j]], <span class="st">" "</span>)</span>
<span id="cb22-16"><a href="#cb22-16"></a>      }</span>
<span id="cb22-17"><a href="#cb22-17"></a>    }</span>
<span id="cb22-18"><a href="#cb22-18"></a>    </span>
<span id="cb22-19"><a href="#cb22-19"></a>    <span class="co"># Reset newEvent string at position i</span></span>
<span id="cb22-20"><a href="#cb22-20"></a>    athletes<span class="sc">$</span>Event[[i]] <span class="ot">&lt;-</span> newEvent</span>
<span id="cb22-21"><a href="#cb22-21"></a>  }</span>
<span id="cb22-22"><a href="#cb22-22"></a>  </span>
<span id="cb22-23"><a href="#cb22-23"></a>  <span class="co"># Return cleaned column to save changes</span></span>
<span id="cb22-24"><a href="#cb22-24"></a>  <span class="fu">return</span>(athletes<span class="sc">$</span>Event)</span>
<span id="cb22-25"><a href="#cb22-25"></a>}</span>
<span id="cb22-26"><a href="#cb22-26"></a>athletes<span class="sc">$</span>Event <span class="ot">&lt;-</span> <span class="fu">cleanEvent</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reordering-arranging" class="level3">
<h3 class="anchored" data-anchor-id="reordering-arranging">Reordering &amp; Arranging</h3>
<p>Lastly, let’s finish the cleaning process by reordering the columns and sorting them to make the data set easier to look at.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># Change column order and sort by year</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>athletes <span class="ot">&lt;-</span> athletes <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">relocate</span>(Team, <span class="at">.after =</span> Name) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="fu">relocate</span>(NOC, <span class="at">.after =</span> Team) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>  <span class="fu">relocate</span>(Region, <span class="at">.after =</span> NOC) <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="fu">arrange</span>(Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="saving-cleaned-data" class="level2">
<h2 class="anchored" data-anchor-id="saving-cleaned-data">Saving Cleaned Data</h2>
<p>Some of the operations that were required to clean the data set took some time to complete. To save time later, let’s save the clean data set in a new csv file so we don’t have to repeat all of the cleaning operations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Save cleaned data set</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="fu">write_csv</span>(athletes, <span class="st">'./Data/athletes_clean.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, let’s read in the new csv file and present the cleaned data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># Read in saved data set and display</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>athletes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'./Data/athletes_clean.csv'</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a>athletes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 270,767 × 15
      ID Name    Team  NOC   Region Sex     Age Height Weight  Year Season City 
   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;
 1  1724 "Arist… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…
 2  1724 "Arist… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…
 3  1725 "Konst… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…
 4  1725 "Konst… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…
 5  4113 "Anast… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…
 6  4116 "Ioann… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…
 7  4189 "Nikol… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…
 8  4431 "Georg… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…
 9  4493 "Antel… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…
10  5660 "Georg… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…
# … with 270,757 more rows, and 3 more variables: Sport &lt;chr&gt;, Event &lt;chr&gt;,
#   Medal &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="potential-research-questions" class="level2">
<h2 class="anchored" data-anchor-id="potential-research-questions">Potential Research Questions</h2>
<p>I am interested if there are relationships between success in the Olympics (whether you got a medal or not) and variables such as height, weight, age, and country. I believe we can use this data set to see what correlates with winning medals.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/601_Fall_2022" data-repo-id="R_kgDOH564Gw" data-category="Announcements" data-category-id="DIC_kwDOH564G84CRdBB" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb27" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb27-1"><a href="#cb27-1"></a><span class="co">---</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="an">title:</span><span class="co"> "Olympic Analysis"</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="an">author:</span><span class="co"> "Matthew Norberg"</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="an">date:</span><span class="co"> "10/11/2022"</span></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="co">  html: </span></span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="co">    toc: true</span></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="co">    code-copy: true</span></span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="co">    code-tools: true</span></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb27-12"><a href="#cb27-12"></a><span class="co">    highlight-style: github</span></span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="co">    theme: zephyr</span></span>
<span id="cb27-14"><a href="#cb27-14"></a><span class="co">    df-print: default</span></span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="an">categories:</span></span>
<span id="cb27-16"><a href="#cb27-16"></a><span class="co">  - hw2</span></span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="co">  - Olympic_Data</span></span>
<span id="cb27-18"><a href="#cb27-18"></a><span class="co">---</span></span>
<span id="cb27-19"><a href="#cb27-19"></a></span>
<span id="cb27-20"><a href="#cb27-20"></a><span class="in">```{r setUP}</span></span>
<span id="cb27-21"><a href="#cb27-21"></a><span class="co">#| label: setup</span></span>
<span id="cb27-22"><a href="#cb27-22"></a><span class="co">#| warning: false</span></span>
<span id="cb27-23"><a href="#cb27-23"></a><span class="co">#| message: false</span></span>
<span id="cb27-24"><a href="#cb27-24"></a></span>
<span id="cb27-25"><a href="#cb27-25"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb27-26"><a href="#cb27-26"></a></span>
<span id="cb27-27"><a href="#cb27-27"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span>
<span id="cb27-28"><a href="#cb27-28"></a><span class="in">```</span></span>
<span id="cb27-29"><a href="#cb27-29"></a></span>
<span id="cb27-30"><a href="#cb27-30"></a><span class="fu">## Data Description</span></span>
<span id="cb27-31"><a href="#cb27-31"></a></span>
<span id="cb27-32"><a href="#cb27-32"></a>I choose to investigate a dataset containing information about the <span class="co">[</span><span class="ot">Olympic Games</span><span class="co">](https://www.kaggle.com/datasets/heesoo37/120-years-of-olympic-history-athletes-and-results?select=athlete_events.csv)</span> between 1896 and 2016.  The data set is read in and displayed using the code below. </span>
<span id="cb27-33"><a href="#cb27-33"></a></span>
<span id="cb27-34"><a href="#cb27-34"></a><span class="in">```{r ReadIn}</span></span>
<span id="cb27-35"><a href="#cb27-35"></a><span class="co"># Read in the data set</span></span>
<span id="cb27-36"><a href="#cb27-36"></a>athletes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'./Data/athlete_events.csv'</span>)</span>
<span id="cb27-37"><a href="#cb27-37"></a>noc <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'./Data/noc_regions.csv'</span>)</span>
<span id="cb27-38"><a href="#cb27-38"></a></span>
<span id="cb27-39"><a href="#cb27-39"></a><span class="co"># Display the athlete data set</span></span>
<span id="cb27-40"><a href="#cb27-40"></a>athletes</span>
<span id="cb27-41"><a href="#cb27-41"></a><span class="co"># Display the noc data set</span></span>
<span id="cb27-42"><a href="#cb27-42"></a>noc</span>
<span id="cb27-43"><a href="#cb27-43"></a><span class="in">```</span></span>
<span id="cb27-44"><a href="#cb27-44"></a></span>
<span id="cb27-45"><a href="#cb27-45"></a>The dataset comes as a set of two csv files: 'athlete_events' and 'noc_regions' where each file represents a table in a relational database.  The 'athlete_events' table contains most of the information that I am interested in.  Each row in this table contains information about an athlete who competed in an Olympic event.  Note that athletes can occur in the table more than once if they competed in multiple events or games.  A good example of this is Michael Phelps who appears in the athletes table many times.</span>
<span id="cb27-46"><a href="#cb27-46"></a></span>
<span id="cb27-47"><a href="#cb27-47"></a><span class="in">```{r phelps}</span></span>
<span id="cb27-48"><a href="#cb27-48"></a><span class="co"># Find all the rows containing information about Michael Phelps</span></span>
<span id="cb27-49"><a href="#cb27-49"></a><span class="fu">filter</span>(athletes, <span class="fu">str_detect</span>(Name, <span class="st">"Michael"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(Name, <span class="st">"Phelps"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-50"><a href="#cb27-50"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(ID, NOC, Sex, Height, Weight, Season))</span>
<span id="cb27-51"><a href="#cb27-51"></a><span class="in">```</span></span>
<span id="cb27-52"><a href="#cb27-52"></a></span>
<span id="cb27-53"><a href="#cb27-53"></a>Each row in the athletes table contains the National Olympic Committee that they are competing for which is stored as a three letter code in the 'NOC' column. The 'NOC' column serves as a foreign key to the 'noc_regions' table.  The 'noc_regions' table maps the National Olympic Committee code to its corresponding country and provides additional notes about the committee.  For example, consider this row in 'noc_regions': (HKG, China, Hong Kong).  This tells us that the code HKG corresponds Hong Kong Olympic Committee in China.  </span>
<span id="cb27-54"><a href="#cb27-54"></a></span>
<span id="cb27-55"><a href="#cb27-55"></a>In the majority of the cases, the 'notes' column of the 'noc_regions' table is empty.  The case I gave in the previous example is an outlier case in which it is present.  In cases where it is present, it often provides another way besides the NOC code to distinguish between two committees from the same region.  The code chunk below display all the entries in the 'noc_regions' table that have notes associated with it.  Notice that many of the rows in the table have the same region.</span>
<span id="cb27-56"><a href="#cb27-56"></a></span>
<span id="cb27-57"><a href="#cb27-57"></a><span class="in">```{r regionAndNotes}</span></span>
<span id="cb27-58"><a href="#cb27-58"></a><span class="co"># List the countries have non-null values in 'notes' column</span></span>
<span id="cb27-59"><a href="#cb27-59"></a>noc <span class="sc">%&gt;%</span></span>
<span id="cb27-60"><a href="#cb27-60"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(notes)) <span class="sc">%&gt;%</span></span>
<span id="cb27-61"><a href="#cb27-61"></a>  <span class="fu">arrange</span>(region)</span>
<span id="cb27-62"><a href="#cb27-62"></a><span class="in">```</span></span>
<span id="cb27-63"><a href="#cb27-63"></a></span>
<span id="cb27-64"><a href="#cb27-64"></a><span class="fu">## Cleaning The Data</span></span>
<span id="cb27-65"><a href="#cb27-65"></a></span>
<span id="cb27-66"><a href="#cb27-66"></a><span class="fu">### Initial Transformations</span></span>
<span id="cb27-67"><a href="#cb27-67"></a></span>
<span id="cb27-68"><a href="#cb27-68"></a>The data was collected in csv format, which made it easy to read into a tibble.  However, the data is not yet tidy.  We will need to perform cleaning operations to make the data neater for analysis. </span>
<span id="cb27-69"><a href="#cb27-69"></a></span>
<span id="cb27-70"><a href="#cb27-70"></a>We can start by dropping the 'Games' column.  We don't need the 'Games' column because each entry in the column is a combination of the 'Year' and 'Season' columns which are already present in the data set. </span>
<span id="cb27-71"><a href="#cb27-71"></a></span>
<span id="cb27-72"><a href="#cb27-72"></a><span class="in">```{r Games}</span></span>
<span id="cb27-73"><a href="#cb27-73"></a><span class="co"># Get rid of id &amp; games column</span></span>
<span id="cb27-74"><a href="#cb27-74"></a>athletes <span class="ot">&lt;-</span> <span class="fu">select</span>(athletes, <span class="sc">-</span><span class="fu">c</span>(Games))</span>
<span id="cb27-75"><a href="#cb27-75"></a><span class="in">```</span></span>
<span id="cb27-76"><a href="#cb27-76"></a></span>
<span id="cb27-77"><a href="#cb27-77"></a>Next, we can add the region from the 'noc_region' file to the athletes tibble so that we only have one tibble to work with.  I choose to drop the 'notes' column in the noc file because most of the values are not available and the values which are available don't provide much useful information. </span>
<span id="cb27-78"><a href="#cb27-78"></a></span>
<span id="cb27-79"><a href="#cb27-79"></a><span class="in">```{r joinTables}</span></span>
<span id="cb27-80"><a href="#cb27-80"></a><span class="co"># Combine information from noc table</span></span>
<span id="cb27-81"><a href="#cb27-81"></a>athletes <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(athletes, noc) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>(notes))</span>
<span id="cb27-82"><a href="#cb27-82"></a><span class="in">```</span></span>
<span id="cb27-83"><a href="#cb27-83"></a></span>
<span id="cb27-84"><a href="#cb27-84"></a>We can clean up the 'Medal' column by replacing the values that are not available with the string "None".  Based on the context of the data set, we can assume that a NA in this column means that the athlete did not win a Medal in that event.  Therefore, replacing these values with "None" seems logical.  </span>
<span id="cb27-85"><a href="#cb27-85"></a></span>
<span id="cb27-86"><a href="#cb27-86"></a><span class="in">```{r cleanMedal}</span></span>
<span id="cb27-87"><a href="#cb27-87"></a><span class="co"># Switch NA in Medal to None</span></span>
<span id="cb27-88"><a href="#cb27-88"></a>athletes <span class="ot">&lt;-</span> athletes <span class="sc">%&gt;%</span> <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">Medal =</span> <span class="st">"None"</span>))</span>
<span id="cb27-89"><a href="#cb27-89"></a><span class="in">```</span></span>
<span id="cb27-90"><a href="#cb27-90"></a></span>
<span id="cb27-91"><a href="#cb27-91"></a><span class="fu">### Handling Missing Values</span></span>
<span id="cb27-92"><a href="#cb27-92"></a></span>
<span id="cb27-93"><a href="#cb27-93"></a>There are four columns in the data set which contain missing values: 'Region', 'Age', 'Height', and 'Weight'.  I started by handling the missing values in the 'region' column first because it is the simplist.  We can find the 'NOC' associated with unknown regions by querying the 'noc_regions' data set. </span>
<span id="cb27-94"><a href="#cb27-94"></a></span>
<span id="cb27-95"><a href="#cb27-95"></a><span class="in">```{r NOC}</span></span>
<span id="cb27-96"><a href="#cb27-96"></a><span class="co"># Display NA in region</span></span>
<span id="cb27-97"><a href="#cb27-97"></a><span class="fu">filter</span>(noc, <span class="fu">is.na</span>(region))</span>
<span id="cb27-98"><a href="#cb27-98"></a><span class="in">```</span></span>
<span id="cb27-99"><a href="#cb27-99"></a></span>
<span id="cb27-100"><a href="#cb27-100"></a>We know that any row in athletes that has an 'NOC' value of 'ROT', 'TUV', or 'UNK' will have a value in the 'Region' column that is NA.   I think it would be sensible to replace the NA values according to the table below. </span>
<span id="cb27-101"><a href="#cb27-101"></a></span>
<span id="cb27-102"><a href="#cb27-102"></a>| NOC | Region | Notes                |</span>
<span id="cb27-103"><a href="#cb27-103"></a>| --- | ------ | -------------------- |</span>
<span id="cb27-104"><a href="#cb27-104"></a>| ROT | None   | Regugee Olympic Team |</span>
<span id="cb27-105"><a href="#cb27-105"></a>| TUV | Tuvala | Tuvala               |</span>
<span id="cb27-106"><a href="#cb27-106"></a>| UNK | Unkown | Unknown              |</span>
<span id="cb27-107"><a href="#cb27-107"></a></span>
<span id="cb27-108"><a href="#cb27-108"></a>The Refugee Olympic Team does not have a region, so I think it is sensible to replace those missing values with "None".  I did a google search and learned that <span class="co">[</span><span class="ot">Tuvala</span><span class="co">](https://en.wikipedia.org/wiki/Tuvalu)</span> is a small indpenent island nation so it makes sense to replace those missing values with "Tuvala".  Lastly, I think it is fair to replace the missing values associated with the UNK NOC as "Unknown".  The code below changes the missing values according to the table above. </span>
<span id="cb27-109"><a href="#cb27-109"></a></span>
<span id="cb27-110"><a href="#cb27-110"></a><span class="in">```{r cleanRegion}</span></span>
<span id="cb27-111"><a href="#cb27-111"></a><span class="co"># Fill in missing values in Region column</span></span>
<span id="cb27-112"><a href="#cb27-112"></a>athletes <span class="ot">&lt;-</span> athletes <span class="sc">%&gt;%</span></span>
<span id="cb27-113"><a href="#cb27-113"></a>            <span class="fu">mutate</span>(<span class="at">Temp =</span> <span class="fu">case_when</span>(NOC <span class="sc">==</span> <span class="st">"ROT"</span> <span class="sc">~</span> <span class="st">"None"</span>,</span>
<span id="cb27-114"><a href="#cb27-114"></a>                                      NOC <span class="sc">==</span> <span class="st">"TUV"</span> <span class="sc">~</span> <span class="st">"Tuvala"</span>,</span>
<span id="cb27-115"><a href="#cb27-115"></a>                                      NOC <span class="sc">==</span> <span class="st">"UNK"</span> <span class="sc">~</span> <span class="st">"Unknown"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-116"><a href="#cb27-116"></a>            <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(region) <span class="sc">~</span> Temp,</span>
<span id="cb27-117"><a href="#cb27-117"></a>                                      <span class="sc">!</span><span class="fu">is.na</span>(region) <span class="sc">~</span> region)) <span class="sc">%&gt;%</span></span>
<span id="cb27-118"><a href="#cb27-118"></a>            <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(region, Temp))</span>
<span id="cb27-119"><a href="#cb27-119"></a><span class="in">```</span></span>
<span id="cb27-120"><a href="#cb27-120"></a></span>
<span id="cb27-121"><a href="#cb27-121"></a>Let's handle the missing values in the 'Age', 'Height', and 'Weight' columns next.  Suppose we find a missing value in the 'Age' column.  I think a reasonable idea would be to replace the missing value with the average age during the Olympic games that occurred in that year.  We know that 'Year' column of the data set does not contain any missing values.  Therefore, if we find a missing value in the 'Age' column, we can extract the value of the 'Year' column in that row and we know it will not be missing.  Then we can calculate the average age during that year and replace the missing value with the average value.  Using this approach, we can replace all the missing values in these columns.</span>
<span id="cb27-122"><a href="#cb27-122"></a></span>
<span id="cb27-123"><a href="#cb27-123"></a>First, let's calculate the average age, height, and weight for each year in the data set.  This is calculated and stored in the tibble using the code chunk below. </span>
<span id="cb27-124"><a href="#cb27-124"></a></span>
<span id="cb27-125"><a href="#cb27-125"></a><span class="in">```{r averageValues}</span></span>
<span id="cb27-126"><a href="#cb27-126"></a><span class="co"># Compute average age, height, and weight by years</span></span>
<span id="cb27-127"><a href="#cb27-127"></a>AverageValues <span class="ot">&lt;-</span> athletes <span class="sc">%&gt;%</span></span>
<span id="cb27-128"><a href="#cb27-128"></a>                 <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb27-129"><a href="#cb27-129"></a>                 <span class="fu">summarise</span>(<span class="at">AverageAge =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span> <span class="dv">0</span>),</span>
<span id="cb27-130"><a href="#cb27-130"></a>                           <span class="at">AverageHeight =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span> <span class="dv">0</span>),</span>
<span id="cb27-131"><a href="#cb27-131"></a>                           <span class="at">AverageWeight =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span> <span class="dv">1</span>))</span>
<span id="cb27-132"><a href="#cb27-132"></a><span class="co"># Display the results</span></span>
<span id="cb27-133"><a href="#cb27-133"></a>AverageValues</span>
<span id="cb27-134"><a href="#cb27-134"></a><span class="in">```</span></span>
<span id="cb27-135"><a href="#cb27-135"></a></span>
<span id="cb27-136"><a href="#cb27-136"></a>Now that we have computed the averages, it is time to replace the missing values.  The 'cleanColumn' function cleans all of the columns mentioned above.  </span>
<span id="cb27-137"><a href="#cb27-137"></a></span>
<span id="cb27-138"><a href="#cb27-138"></a><span class="in">```{r cleanAgeHeightWeight, eval = FALSE}</span></span>
<span id="cb27-139"><a href="#cb27-139"></a><span class="co"># Function to clean age, height, and weight</span></span>
<span id="cb27-140"><a href="#cb27-140"></a>cleanColumn <span class="ot">&lt;-</span> <span class="cf">function</span>(column, indx) {</span>
<span id="cb27-141"><a href="#cb27-141"></a>  <span class="co"># Iterate along the age column</span></span>
<span id="cb27-142"><a href="#cb27-142"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(column)) {</span>
<span id="cb27-143"><a href="#cb27-143"></a>    <span class="co"># Extract the current age</span></span>
<span id="cb27-144"><a href="#cb27-144"></a>    cVal <span class="ot">&lt;-</span> column[[i]]</span>
<span id="cb27-145"><a href="#cb27-145"></a>    <span class="co"># Check for NA value</span></span>
<span id="cb27-146"><a href="#cb27-146"></a>    <span class="cf">if</span> (<span class="fu">is.na</span>(cVal)) {</span>
<span id="cb27-147"><a href="#cb27-147"></a>      <span class="co"># Extract year from the row</span></span>
<span id="cb27-148"><a href="#cb27-148"></a>      cYear <span class="ot">&lt;-</span> <span class="fu">slice</span>(athletes, i)<span class="sc">$</span>Year[[<span class="dv">1</span>]]</span>
<span id="cb27-149"><a href="#cb27-149"></a>      <span class="co"># Replace the NA value with the average age from year</span></span>
<span id="cb27-150"><a href="#cb27-150"></a>      column[[i]] <span class="ot">&lt;-</span> <span class="fu">filter</span>(AverageValues, Year <span class="sc">==</span> cYear)[[indx]][[<span class="dv">1</span>]]</span>
<span id="cb27-151"><a href="#cb27-151"></a>    }</span>
<span id="cb27-152"><a href="#cb27-152"></a>  }</span>
<span id="cb27-153"><a href="#cb27-153"></a>  <span class="co"># Return cleaned column</span></span>
<span id="cb27-154"><a href="#cb27-154"></a>  <span class="fu">return</span>(column)</span>
<span id="cb27-155"><a href="#cb27-155"></a>}</span>
<span id="cb27-156"><a href="#cb27-156"></a><span class="co"># Set age, height, and weight to cleaned version</span></span>
<span id="cb27-157"><a href="#cb27-157"></a>athletes<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">cleanColumn</span>(athletes<span class="sc">$</span>Age, <span class="dv">2</span>)</span>
<span id="cb27-158"><a href="#cb27-158"></a>athletes<span class="sc">$</span>Height <span class="ot">&lt;-</span> <span class="fu">cleanColumn</span>(athletes<span class="sc">$</span>Height, <span class="dv">3</span>)</span>
<span id="cb27-159"><a href="#cb27-159"></a>athletes<span class="sc">$</span>Weight <span class="ot">&lt;-</span> <span class="fu">cleanColumn</span>(athletes<span class="sc">$</span>Weight, <span class="dv">4</span>)</span>
<span id="cb27-160"><a href="#cb27-160"></a><span class="in">```</span></span>
<span id="cb27-161"><a href="#cb27-161"></a></span>
<span id="cb27-162"><a href="#cb27-162"></a><span class="fu">### Cleaning Sport &amp; Event</span></span>
<span id="cb27-163"><a href="#cb27-163"></a></span>
<span id="cb27-164"><a href="#cb27-164"></a>There is another transformation I would like to perform to make the data set a bit cleaner.  Take a look at the first few values in the 'Sport' and 'Event' column.  They are presented below.</span>
<span id="cb27-165"><a href="#cb27-165"></a></span>
<span id="cb27-166"><a href="#cb27-166"></a><span class="in">```{r sportEvent}</span></span>
<span id="cb27-167"><a href="#cb27-167"></a><span class="co"># Display first few rows of Sport and Event columns</span></span>
<span id="cb27-168"><a href="#cb27-168"></a>athletes <span class="sc">%&gt;%</span> </span>
<span id="cb27-169"><a href="#cb27-169"></a>  <span class="fu">select</span>(Sport, Event) <span class="sc">%&gt;%</span></span>
<span id="cb27-170"><a href="#cb27-170"></a>  <span class="fu">head</span>()</span>
<span id="cb27-171"><a href="#cb27-171"></a><span class="in">```</span></span>
<span id="cb27-172"><a href="#cb27-172"></a></span>
<span id="cb27-173"><a href="#cb27-173"></a>Notice how the first word or set of words in the 'Event' column is the same exact string in the 'Sport' column.  The code chunk below confirms that this pattern is true throughout the entire data set.  Note, I did not evaluate this code to speed up the rendering process.  However, the output can be verified by running this qmd file. </span>
<span id="cb27-174"><a href="#cb27-174"></a></span>
<span id="cb27-175"><a href="#cb27-175"></a><span class="in">```{r testSportEvent, eval = FALSE}</span></span>
<span id="cb27-176"><a href="#cb27-176"></a>testCols <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb27-177"><a href="#cb27-177"></a>  <span class="co"># Iterate along sport column</span></span>
<span id="cb27-178"><a href="#cb27-178"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(athletes<span class="sc">$</span>Sport)) {</span>
<span id="cb27-179"><a href="#cb27-179"></a>    <span class="co"># Get the sport and event string at row i</span></span>
<span id="cb27-180"><a href="#cb27-180"></a>    <span class="co"># Split each string on space character</span></span>
<span id="cb27-181"><a href="#cb27-181"></a>    sport <span class="ot">&lt;-</span> <span class="fu">str_split</span>(athletes<span class="sc">$</span>Sport[[i]], <span class="st">" "</span>)[[<span class="dv">1</span>]]</span>
<span id="cb27-182"><a href="#cb27-182"></a>    event <span class="ot">&lt;-</span> <span class="fu">str_split</span>(athletes<span class="sc">$</span>Event[[i]], <span class="st">" "</span>)[[<span class="dv">1</span>]]</span>
<span id="cb27-183"><a href="#cb27-183"></a>    <span class="co"># Iterate over items in sport list</span></span>
<span id="cb27-184"><a href="#cb27-184"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(sport)) {</span>
<span id="cb27-185"><a href="#cb27-185"></a>      <span class="co"># Check to see if each item in sport is equivalent to corresponding item in event</span></span>
<span id="cb27-186"><a href="#cb27-186"></a>      <span class="cf">if</span> (sport[[j]] <span class="sc">!=</span> event[[j]]) {</span>
<span id="cb27-187"><a href="#cb27-187"></a>        <span class="co"># If it is not equivalent -&gt; stop and display sport and event which breaks pattern</span></span>
<span id="cb27-188"><a href="#cb27-188"></a>        <span class="fu">cat</span>(<span class="st">"BREAK</span><span class="sc">\n</span><span class="st">"</span>, sport, <span class="st">" "</span>, event, <span class="st">"</span><span class="sc">\n</span><span class="st">Pattern does not hold"</span>)</span>
<span id="cb27-189"><a href="#cb27-189"></a>        <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb27-190"><a href="#cb27-190"></a>      }</span>
<span id="cb27-191"><a href="#cb27-191"></a>    }</span>
<span id="cb27-192"><a href="#cb27-192"></a>  }</span>
<span id="cb27-193"><a href="#cb27-193"></a>  <span class="co"># If we get here, then the property holds for the entire data set</span></span>
<span id="cb27-194"><a href="#cb27-194"></a>  <span class="fu">cat</span>(<span class="st">"Pattern holds for entire data set</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb27-195"><a href="#cb27-195"></a>  <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb27-196"><a href="#cb27-196"></a>}</span>
<span id="cb27-197"><a href="#cb27-197"></a><span class="fu">testCols</span>()</span>
<span id="cb27-198"><a href="#cb27-198"></a><span class="in">```</span></span>
<span id="cb27-199"><a href="#cb27-199"></a></span>
<span id="cb27-200"><a href="#cb27-200"></a>I would like to remove the first few words that in the 'Event' column that are also present in the 'Sport' column.  This will clean up the data set even more.  Furthermore, we are not losing any information because we have confirmed that everything we are throwing away appears in the 'Sport' column.  The following chunk of code cleans the 'Event' column.</span>
<span id="cb27-201"><a href="#cb27-201"></a></span>
<span id="cb27-202"><a href="#cb27-202"></a><span class="in">```{r cleanSportEvent, eval = FALSE}</span></span>
<span id="cb27-203"><a href="#cb27-203"></a><span class="co"># Function to clean event column</span></span>
<span id="cb27-204"><a href="#cb27-204"></a>cleanEvent <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb27-205"><a href="#cb27-205"></a>  <span class="co"># Iterate along and event columns</span></span>
<span id="cb27-206"><a href="#cb27-206"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(athletes<span class="sc">$</span>Sport)) {</span>
<span id="cb27-207"><a href="#cb27-207"></a>    <span class="co"># Split sport and event string at row i on space character</span></span>
<span id="cb27-208"><a href="#cb27-208"></a>    sport <span class="ot">&lt;-</span> <span class="fu">str_split</span>(athletes<span class="sc">$</span>Sport[[i]], <span class="st">" "</span>)[[<span class="dv">1</span>]]</span>
<span id="cb27-209"><a href="#cb27-209"></a>    event <span class="ot">&lt;-</span> <span class="fu">str_split</span>(athletes<span class="sc">$</span>Event[[i]], <span class="st">" "</span>)[[<span class="dv">1</span>]]</span>
<span id="cb27-210"><a href="#cb27-210"></a>    <span class="co"># Empty string to store new event</span></span>
<span id="cb27-211"><a href="#cb27-211"></a>    newEvent <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb27-212"><a href="#cb27-212"></a></span>
<span id="cb27-213"><a href="#cb27-213"></a>    <span class="co"># Iterate along event list</span></span>
<span id="cb27-214"><a href="#cb27-214"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(event)) {</span>
<span id="cb27-215"><a href="#cb27-215"></a>      <span class="co"># Once we get past the length of sport, start piecing together newEvent</span></span>
<span id="cb27-216"><a href="#cb27-216"></a>      <span class="cf">if</span> (j <span class="sc">&gt;</span> <span class="fu">length</span>(sport)) {</span>
<span id="cb27-217"><a href="#cb27-217"></a>        newEvent <span class="ot">=</span> <span class="fu">str_c</span>(newEvent, event[[j]], <span class="st">" "</span>)</span>
<span id="cb27-218"><a href="#cb27-218"></a>      }</span>
<span id="cb27-219"><a href="#cb27-219"></a>    }</span>
<span id="cb27-220"><a href="#cb27-220"></a>    </span>
<span id="cb27-221"><a href="#cb27-221"></a>    <span class="co"># Reset newEvent string at position i</span></span>
<span id="cb27-222"><a href="#cb27-222"></a>    athletes<span class="sc">$</span>Event[[i]] <span class="ot">&lt;-</span> newEvent</span>
<span id="cb27-223"><a href="#cb27-223"></a>  }</span>
<span id="cb27-224"><a href="#cb27-224"></a>  </span>
<span id="cb27-225"><a href="#cb27-225"></a>  <span class="co"># Return cleaned column to save changes</span></span>
<span id="cb27-226"><a href="#cb27-226"></a>  <span class="fu">return</span>(athletes<span class="sc">$</span>Event)</span>
<span id="cb27-227"><a href="#cb27-227"></a>}</span>
<span id="cb27-228"><a href="#cb27-228"></a>athletes<span class="sc">$</span>Event <span class="ot">&lt;-</span> <span class="fu">cleanEvent</span>()</span>
<span id="cb27-229"><a href="#cb27-229"></a><span class="in">```</span></span>
<span id="cb27-230"><a href="#cb27-230"></a></span>
<span id="cb27-231"><a href="#cb27-231"></a><span class="fu">### Reordering &amp; Arranging</span></span>
<span id="cb27-232"><a href="#cb27-232"></a></span>
<span id="cb27-233"><a href="#cb27-233"></a>Lastly, let's finish the cleaning process by reordering the columns and sorting them to make the data set easier to look at. </span>
<span id="cb27-234"><a href="#cb27-234"></a></span>
<span id="cb27-235"><a href="#cb27-235"></a><span class="in">```{r tidyFrame}</span></span>
<span id="cb27-236"><a href="#cb27-236"></a><span class="co"># Change column order and sort by year</span></span>
<span id="cb27-237"><a href="#cb27-237"></a>athletes <span class="ot">&lt;-</span> athletes <span class="sc">%&gt;%</span> </span>
<span id="cb27-238"><a href="#cb27-238"></a>  <span class="fu">relocate</span>(Team, <span class="at">.after =</span> Name) <span class="sc">%&gt;%</span></span>
<span id="cb27-239"><a href="#cb27-239"></a>  <span class="fu">relocate</span>(NOC, <span class="at">.after =</span> Team) <span class="sc">%&gt;%</span></span>
<span id="cb27-240"><a href="#cb27-240"></a>  <span class="fu">relocate</span>(Region, <span class="at">.after =</span> NOC) <span class="sc">%&gt;%</span></span>
<span id="cb27-241"><a href="#cb27-241"></a>  <span class="fu">arrange</span>(Year)</span>
<span id="cb27-242"><a href="#cb27-242"></a><span class="in">```</span></span>
<span id="cb27-243"><a href="#cb27-243"></a></span>
<span id="cb27-244"><a href="#cb27-244"></a><span class="fu">## Saving Cleaned Data</span></span>
<span id="cb27-245"><a href="#cb27-245"></a></span>
<span id="cb27-246"><a href="#cb27-246"></a>Some of the operations that were required to clean the data set took some time to complete.  To save time later, let's save the clean data set in a new csv file so we don't have to repeat all of the cleaning operations.</span>
<span id="cb27-247"><a href="#cb27-247"></a></span>
<span id="cb27-248"><a href="#cb27-248"></a><span class="in">```{r save, eval = FALSE}</span></span>
<span id="cb27-249"><a href="#cb27-249"></a><span class="co"># Save cleaned data set</span></span>
<span id="cb27-250"><a href="#cb27-250"></a><span class="fu">write_csv</span>(athletes, <span class="st">'./Data/athletes_clean.csv'</span>)</span>
<span id="cb27-251"><a href="#cb27-251"></a><span class="in">```</span></span>
<span id="cb27-252"><a href="#cb27-252"></a></span>
<span id="cb27-253"><a href="#cb27-253"></a>Finally, let's read in the new csv file and present the cleaned data. </span>
<span id="cb27-254"><a href="#cb27-254"></a></span>
<span id="cb27-255"><a href="#cb27-255"></a><span class="in">```{r presentData}</span></span>
<span id="cb27-256"><a href="#cb27-256"></a><span class="co"># Read in saved data set and display</span></span>
<span id="cb27-257"><a href="#cb27-257"></a>athletes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'./Data/athletes_clean.csv'</span>)</span>
<span id="cb27-258"><a href="#cb27-258"></a>athletes</span>
<span id="cb27-259"><a href="#cb27-259"></a><span class="in">```</span></span>
<span id="cb27-260"><a href="#cb27-260"></a></span>
<span id="cb27-261"><a href="#cb27-261"></a><span class="fu">## Potential Research Questions</span></span>
<span id="cb27-262"><a href="#cb27-262"></a></span>
<span id="cb27-263"><a href="#cb27-263"></a>I am interested if there are relationships between success in the Olympics (whether you got a medal or not) and variables such as height, weight, age, and country.  I believe we can use this data set to see what correlates with winning medals. </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>